var app=angular.module("App",["ngCookies","ngSanitize","angular-loading-bar","ngAnimate","ui.router","ncy-angular-breadcrumb","storage.service","utilizador.service","slugifier","upload.service","ngTextTruncate","angularMoment","ui.tinymce","ngScrollbars","videosharing-embed","rmDatepicker","angular-google-analytics","ui.rCalendar","ngCropper","angular-owl-carousel-2","vcRecaptcha","ngImageCompress","ui.mask","dynamic-states","link.service","pascalprecht.translate","colorbox","ngMeta"]).run(["$rootScope","$state","$stateParams","$http","ngMeta",function(a,o,e,t,i){a.$state=o,a.$stateParams=e,t.get("version.json").then(function(o){a.appVersion=o.data}),a.tituloPagina="Início",i.init()}]).config(["$qProvider","$compileProvider","$httpProvider","$stateProvider","$urlRouterProvider","$locationProvider","$breadcrumbProvider","ScrollBarsProvider","AnalyticsProvider","vcRecaptchaServiceProvider","uiMask.ConfigProvider","$translateProvider","ngMetaProvider",function(o,a,e,t,i,n,r,s,l,c,u,d,m){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/),m.setDefaultTitle("Portal Recredit"),d.useStaticFilesLoader({prefix:"app/main/idiomas/",suffix:".json"}).registerAvailableLanguageKeys(["PT","EN"]).preferredLanguage("PT").fallbackLanguage("PT").useSanitizeValueStrategy("escapeParameters").useLocalStorage(),o.errorOnUnhandledRejections(!1),e.defaults.headers.get||(e.defaults.headers.get={}),u.maskDefinitions({A:/[a-z]/,"*":/[a-zA-Z0-9]/}),u.addDefaultPlaceholder(!1),c.setDefaults({key:"6LdwA64eAAAAAKcjDgLQgtNz9b-wfrFcMogMrjan",theme:"light",size:"normal",lang:"pt-PT"}),l.setAccount([{tracker:"G-FY7X42C25R",name:"RECREDIT"}]).logAllCalls(!0).setPageEvent("$locationChangeSuccess"),s.defaults={theme:"light",scrollInertia:0,axis:"y",scrollButtons:{scrollAmount:"auto",enable:!1},advanced:{updateOnContentResize:!0}},r.setOptions({prefixStateName:"home",includeAbstract:!0}),n.html5Mode(!1).hashPrefix("!"),t.state("home",{url:"/",templateUrl:"app/pages/home.html",controller:"homeController",ncyBreadcrumb:{label:"Home"}}).state("recredit.orgaos-sociais",{url:"/orgaos-sociais",ncyBreadcrumb:{label:"Orgãos Sociais"},views:{"@":{templateUrl:"app/pages/quem-e-quem.html",controller:"quemEquemController"}}}).state("recredit.orgaos-sociais.cdQuemEQuem",{url:"/:cdQuemEQuem/:regimeCarreira/:noQuemEQuem",ncyBreadcrumb:{label:"Orgãos Sociais"},views:{"@":{templateUrl:"app/pages/quem-e-quem-detalhes.html",controller:"quemEquemController"}}}).state("mapa-do-site",{url:"/mapa-do-site",abstract:!1,templateUrl:"app/pages/mapa-do-site.html",controller:"mapaDoSiteController",ncyBreadcrumb:{label:"Mapa do Site"}}).state("media",{url:"/media",abstract:!1,ncyBreadcrumb:{label:"RECREDIT"}}).state("media.noticias",{url:"/noticias",publicacao:{label:{singular:"Notícia",plural:"Notícias"},template:{sigla:"NOT",dominio:"TP_PUBLICACAO"}},ncyBreadcrumb:{label:"Outras Notícias"},views:{"@":{templateUrl:"app/pages/publicacoes.html",controller:"publicacoesController"}}}).state("media.artigos",{url:"/artigos",publicacao:{label:{singular:"Artigos",plural:"Artigoss"},template:{sigla:"ART",dominio:"TB_ART"}},ncyBreadcrumb:{label:"Artigos"},views:{"@":{templateUrl:"app/pages/artigos.html",controller:"artigosController"}}}).state("media.noticias.cdPublicacao",{url:"/:cdPublicacao/:slug",publicacao:{label:{singular:"Notícia",plural:"Notícias"},template:{sigla:"NOT",dominio:"TP_PUBLICACAO"}},ncyBreadcrumb:{label:"Notícia"},views:{"@":{templateUrl:"app/pages/publicacao.html",controller:"publicacoesController"}},data:{meta:{title:"Notícia"}}}).state("media.artigos.cdPublicacao",{url:"/:cdPublicacao/:slug",publicacao:{label:{singular:"Artigos",plural:"Artigoss"},template:{sigla:"ART",dominio:"TB_ART"}},ncyBreadcrumb:{label:"Artigo"},views:{"@":{templateUrl:"app/pages/artigo.html",controller:"artigosController"}}}).state("imoveis",{url:"/imoveis",ncyBreadcrumb:{label:"Imóveis"},views:{"@":{templateUrl:"app/pages/imoveis.html",controller:"imoveisController"}},data:{meta:{title:"Imóveis em destaques"}}}).state("detalhes-propriedade",{url:"/detalhes-propriedade",ncyBreadcrumb:{label:"detalhes-propriedade"},views:{"@":{templateUrl:"app/pages/detalhes-propriedade.html",controller:"imoveisController"}},data:{meta:{title:"Detalhes do imóvel"}}}).state("busca-avancada-imoveis",{url:"/busca-avancada-imoveis",ncyBreadcrumb:{label:"busca-avancada-imoveis"},views:{"@":{templateUrl:"app/pages/buscaAvancada.html",controller:"imoveisController"}},data:{meta:{title:"Resultado da pesquisa do imóvel"}}}).state("sala-de-imprensa.perguntas-frequentes",{url:"/perguntas-frequentes",sigla:"ANY",anexos:!1,ncyBreadcrumb:{label:"Direções e Gabinetes"},views:{"@":{templateUrl:"app/pages/perguntas-frequentes.html",controller:"perguntasFrequentesController"}}}).state("perguntas-frequentes.cdPerguntaFrequente",{url:"/:cdPerguntaFrequente/:slug",sigla:"ANY",anexos:!1,ncyBreadcrumb:{label:"Perguntas Frequentes"},views:{"@":{templateUrl:"app/pages/perguntas-frequentes.html",controller:"perguntasFrequentesController"}}}).state("institucional.divulgacao",{url:"/divulgacao",publicacao:{label:{singular:"Notícia",plural:"Notícias"},template:{sigla:"PUB",dominio:"TP_PUBLICACAO"}},ncyBreadcrumb:{label:"Notícias"},views:{"@":{templateUrl:"app/pages/publicacoes.html",controller:"publicacoesController"}}}).state("institucional.divulgacao.cdPublicacao",{url:"/:cdPublicacao/:slug",publicacao:{label:{singular:"Divulgação",plural:"Divulgações"},template:{sigla:"PUB",dominio:"TP_PUBLICACAO"}},ncyBreadcrumb:{label:"Divulgação"},views:{"@":{templateUrl:"app/pages/publicacao.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.boletins-informativos",{url:"/boletins-informativos",sigla:"FORM",ncyBreadcrumb:{label:"Boletins Informativos"},views:{"@":{templateUrl:"app/pages/formularios.html",controller:"formulariosController"}}}).state("sala-de-imprensa.estudos-e-publicacoes",{url:"/estudos-e-publicacoes",publicacao:{label:{singular:"Publicação",plural:"Publicações"},template:{sigla:"ART",dominio:"TB_ARTIGO"}},ncyBreadcrumb:{label:"Publicações"},views:{"@":{templateUrl:"app/pages/publicacoes.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.estudos-e-publicacoes.cdPublicacao",{url:"/:cdPublicacao/:slug",publicacao:{label:{singular:"Publicação",plural:"Publicações"},template:{sigla:"ART",dominio:"TB_ARTIGO"}},ncyBreadcrumb:{label:"Publicações"},views:{"@":{templateUrl:"app/pages/publicacao.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.estaticas",{url:"/estaticas",ncyBreadcrumb:{label:"Estatícas"},views:{"@":{templateUrl:"app/pages/estatica.html",controller:"glossarioController"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"sala-de-imprensa.estaticas"}}}}).state("sala-de-imprensa.estaticas.cdMenu",{url:"/estaticas",ncyBreadcrumb:{label:"Estatícas"},views:{"@":{templateUrl:"app/pages/estaticacd.html",controller:"glossarioController"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"sala-de-imprensa.estaticas"}}}}).state("sala-de-imprensa.glossario",{url:"/glossario",anexos:!0,ncyBreadcrumb:{label:"Glossário"},views:{"@":{templateUrl:"app/pages/glossario.html",controller:"glossarioController"}}}).state("sala-de-imprensa.comunicados",{url:"/comunicados",anexos:!0,ncyBreadcrumb:{label:"Comunicados"},views:{"@":{templateUrl:"app/pages/default-interna.html",controller:"defaultInternaController"}}}).state("sala-de-imprensa.galerias",{url:"/fotos",ncyBreadcrumb:{label:"Galerias"},views:{"@":{templateUrl:"app/pages/fotos.html",controller:"fotosController"}}}).state("sobre.cdQuemEQuem",{url:"/:cdQuemEQuem/:regimeCarreira/:noQuemEQuem",ncyBreadcrumb:{label:"Quem é Quem"},views:{"@":{templateUrl:"app/pages/quem-e-quem-detalhes.html",controller:"quemEquemController"}}}).state("sala-de-imprensa.newsletter",{url:"/newslatter",ncyBreadcrumb:{label:"Newsletter"}}).state("sala-de-imprensa.galerias.cdPublicacao",{url:"/:cdPublicacao/:slug",ncyBreadcrumb:{label:"Galeria"},views:{"@":{templateUrl:"app/pages/foto.html",controller:"fotosController"}}}).state("sala-de-imprensa.videos",{url:"/videos",ncyBreadcrumb:{label:"Vídeos"},views:{"@":{templateUrl:"app/pages/videos.html",controller:"videosController"}}}).state("sala-de-imprensa.videos.cdPublicacao",{url:"/:cdPublicacao/:slug",ncyBreadcrumb:{label:"Vídeo"},views:{"@":{templateUrl:"app/pages/video.html",controller:"videosController"}}}).state("sala-de-imprensa.eventos",{url:"/agenda",ncyBreadcrumb:{label:" "},views:{"@":{templateUrl:"app/pages/eventos.html",controller:"eventosController"}}}).state("login1",{url:"/login1",ncyBreadcrumb:{label:" "},views:{"@":{templateUrl:"app/pages/login1.html",controller:""}}}).state("sala-de-imprensa.eventos-futuros.cdPublicacao",{url:"/:cdPublicacao/:slug",ncyBreadcrumb:{label:" "},views:{"@":{templateUrl:"app/pages/evento.html",controller:"eventosController"}}}).state("contactos",{url:"/contactos",ncyBreadcrumb:{label:"Contactos"},views:{"@":{templateUrl:"app/pages/contacto.html",controller:"contactoController"}}}).state("panorama",{url:"/panorama",ncyBreadcrumb:{label:""},views:{"@":{templateUrl:"app/pages/panorama.html",controller:""}}}).state("estatisticas",{url:"/estatisticas",ncyBreadcrumb:{label:"Estatísticas"},views:{"@":{templateUrl:"app/pages/estatisticas.html",controller:"estatisticasController"}},resolve:{checkSession:["$state","UtilizadorService","StorageService",function(o,a,e){var t=e.get("utilizadorLogado");return!!t&&!!t.admin}]}}),i.otherwise("/")}]).run(["$rootScope","$timeout","UtilizadorService","$window","$http","$state","RequestService","Analytics","AlertaService","dynamicStates","amMoment","$translateLocalStorage",function(a,o,e,t,i,n,r,s,l,c,u,d){u.changeLocale("PT"===d.get("NG_TRANSLATE_LANG_KEY")?"pt":"en-ie"),i.get("app/services/offline/pt-BR.json").then(function(o){a.const=o.data.dictionary}),a.getLinkState=function(o){return o.subPaginas?n.href(MenuService.obterSubLink(o)):o.state?n.href(o.state):null},a.getState=function(o){return n.get(o)},r.request("GET","/menu/listar/"+r.portalAPI,null,null,function(o){o?200==o.retorno.codigo&&(a.menu=o.data.menuItemList,a.contactos=o.data.contactos,c.fetchRoutes(o.data.menuItemList)):l.erroRede()}),a.checarPermissao=function(o){return e.checarPermissao(o).$$state.value},a.$on("$locationChangeSuccess",function(){t.scrollTo(0,0)}),a.$watch("$state.current.ncyBreadcrumb.label",function(){try{a.tituloPagina=n.current.ncyBreadcrumb.label}catch(o){}}),$(document).on("shown.bs.modal","body",function(){o(function(){$("body").addClass("modal-open").css("padding-right",!1)},100)}),a.appVersion={},i.get("version.json").then(function(o){a.appVersion.frontend=o.data})}]);app.component("minfinDefaultHeader",{templateUrl:"app/partials/minfin-default-header.html",controller:["$translate","$timeout","$window","$scope",function(a,e,t,o){this.traducao=function(o){a.use(o),e(function(){t.location.reload()},300)},o.getStateParams=function(){var o=window.location.href.split("/");return result=o[o.length-1]}}]}),app.component("navigationBar",{templateUrl:"app/partials/navigation-bar.html",bindings:{menuarray:"="},controller:["$rootScope","$state","$scope","StorageService","LinkService","$translate","$timeout","$window",function(o,t,e,i,n,a,r,s){e.utilizador=i.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,a){e.utilizador=i.get("utilizadorLogado")}),e.type1=1,e.type2=0,e.type3=0,e.type4=0,e.click1=function(){e.type1=1,e.type2=0,e.type3=0,e.type4=0},e.click2=function(){e.type2=1,e.type3=0,e.type1=0,e.type4=0},e.click3=function(){e.type3=1,e.type2=0,e.type1=0,e.type4=0},e.click4=function(){e.type4=1,e.type3=0,e.type2=0,e.type1=0},this.traducao=function(o){a.use(o),r(function(){s.location.reload()},300)},this.linkarSubMenus=function(o){var a=t.href(o.state),e=n.target(o.url);return e?e[0]:a},e.getStateParams=function(){var o=window.location.href.split("/");return result=o[o.length-1]}}]}),app.component("carouselVertical",{templateUrl:"app/partials/carousel-vertical.html",bindings:{itens:"<"},controller:["$rootScope","$scope","StorageService",function(o,e,t){e.utilizador=t.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,a){e.utilizador=t.get("utilizadorLogado")})}]}),app.component("videoList",{templateUrl:"app/partials/video-list.html",bindings:{itens:"="},controller:["$scope",function(a){a.modalVideo={},a.openModal=function(o){a.modalVideo=o}}]}),app.component("swalAnimation",{bindings:{tipo:"@"},template:'<div class="f-modal-alert">\t<div class="f-modal-icon f-modal-error animate" ng-if="$ctrl.tipo == \'error\'">\t\t<span class="f-modal-x-mark">\t\t\t<span class="f-modal-line f-modal-left animateXLeft"></span>\t\t\t<span class="f-modal-line f-modal-right animateXRight"></span>\t\t</span>\t\t<div class="f-modal-placeholder"></div>\t\t<div class="f-modal-fix"></div>\t</div>\t<div class="f-modal-icon f-modal-warning scaleWarning" ng-if="$ctrl.tipo == \'warning\'">\t\t<span class="f-modal-body pulseWarningIns"></span>\t\t<span class="f-modal-dot pulseWarningIns"></span>\t</div>\t<div class="f-modal-icon f-modal-success animate" ng-if="$ctrl.tipo == \'success\'">\t\t<span class="f-modal-line f-modal-tip animateSuccessTip"></span>\t\t<span class="f-modal-line f-modal-long animateSuccessLong"></span>\t\t<div class="f-modal-placeholder"></div>\t\t<div class="f-modal-fix"></div>\t</div></div>'}),app.component("owlCarousel",{templateUrl:"app/partials/owl-carousel.html",bindings:{data:"<",descricao:"<",qtdItens:"<",bullet:"<",arrow:"<",singleItem:"<",numbered:"<",nome:"@"},controller:function(){this.$onChanges=function(o){this.data&&$("."+this.nome).owlCarousel({items:this.qtdItens,lazyLoad:!0,loop:!0,margin:10,dots:this.bullet,nav:this.arrow,navText:["<i class='glyphicon glyphicon-chevron-left'></i>","<i class='glyphicon glyphicon-chevron-right'></i>"],responsiveClass:!0,responsive:{0:{items:this.singleItem?"1":1},300:{items:this.singleItem?"1":2},600:{items:this.singleItem?"1":3},1e3:{items:this.qtdItens}}})}}}),app.component("linksUteis",{templateUrl:"app/partials/links-uteis-carousel.html",bindings:{data:"<",qtdItens:"<",bullet:"<",arrow:"<",numbered:"<",tipo:"@",titulo:"@",loop:"<"},controller:["$rootScope","$scope","$filter","$timeout","$window","RequestService","StorageService","AlertaService","UtilizadorService",function(o,a,e,t,i,n,r,s,l){var c=this;a.ready=function(o){o},this.$onInit=function(o){a.properties={items:c.qtdItens,lazyLoad:!0,loop:c.loop,margin:10,dots:c.bullet,nav:c.arrow,autoplay:c.bullet,autoplayTimeout:3e3,autoplayHoverPause:!0,navText:["<i class='glyphicon glyphicon-chevron-left'></i>","<i class='glyphicon glyphicon-chevron-right'></i>"],responsiveClass:!1,responsive:{0:{items:c.singleItem?"1":1},300:{items:c.singleItem?"1":2},600:{items:c.singleItem?"1":3},1e3:{items:c.qtdItens}}}}}]}),app.component("eventosList",{templateUrl:"app/partials/eventos-list.html",bindings:{data:"<",tipo:"@",qtdItens:"<",truncar:"<"},controller:function(){}}),app.component("perguntasList",{templateUrl:"app/partials/perguntas-list.html",bindings:{data:"<",qtdItens:"@"},controller:["$scope",function(o){o.getNumber=function(o){return new Array(o)}}]}),app.component("artigosList",{templateUrl:"app/partials/artigos-list.html",bindings:{data:"<",tipo:"@",qtdItens:"="},controller:["$scope",function(a){a.retornaImagemArtigo=function(o){return o?'<img src="'+o+'" class="img-responsive" style="width:100%;" />':""},this.$onChanges=function(o){a.coluna=Math.round(12/parseInt(this.qtdItens))}}]}),app.component("customFooter",{templateUrl:"app/partials/custom-footer.html",bindings:{menuarray:"<",contactos:"="},controller:["$translateLocalStorage","$scope",function(o,a){this.dataAtual={agora:new Date},this.idioma=o.get("NG_TRANSLATE_LANG_KEY"),a.anoAtual=this.dataAtual.agora,this.$onInit=function(o){},a.getStateParams=function(){var o=window.location.href.split("/");return result=o[o.length-1]}}]}),app.component("cambio",{templateUrl:"app/partials/cambio.html",bindings:{data:"="}}),app.component("breadcrumb",{templateUrl:"app/partials/breadcrumb.html",bindings:{dataItens:"="}}),app.component("submenuSidebar",{templateUrl:"app/partials/submenu-sidebar.html",controller:["$rootScope","$state","LinkService",function(a,t,i){this.$onChanges=function(){this.menuPrincipal=a.menu,this.current=t.$current;for(var o=t.$current;o.parent;)(o=o.parent).name&&(this.menuTop=o)},this.linkarSubMenus=function(o){var a=t.href(o.state),e=i.target(o.url);return e?e[0]:a},this.changeSubMenuItem=function(o){o.aberto=!o.aberto},this.checkSubMenuParent=function(o){o.aberto=!1,0<=this.current.name.indexOf(o.state)&&(o.aberto=!0)}}]}),app.component("defaultInternaEditar",{templateUrl:"app/partials/default-interna-editar.html",bindings:{pagina:"<",menuAtual:"<",anexos:"="},controller:["$rootScope","$scope","$timeout","$q","UtilizadorService","RequestService","AlertaService","StorageService",function(i,r,e,o,a,n,s,t){r.utilizador=t.get("utilizadorLogado"),i.$on("broadcastUtilizadorReceiver",function(o,a){r.utilizador=t.get("utilizadorLogado")}),this.$onChanges=function(o){r.pagina=angular.copy(this.pagina),r.menuAtual=this.menuAtual,r.extensoesPermitidasImagens=["jpg","jpeg","png"],r.tamanhoFicheiroImagem=1,r.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:300,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",image_dimensions:!1,image_description:!1,nowrap:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){e(function(){"Inserir/editar imagem"==$(".mce-title").html()&&($(".mce-combobox input").attr("readonly","readonly").addClass("disabled"),$("input:last").focus())},100)})})},file_picker_callback:function(t,o,a){var i=angular.element("#editorImageUpload");e(function(){angular.element(i).click()},200),i.on("change",function(o){var a=o.target.files[0];a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),a.size>1048576*r.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&(i.val(""),t(e.result,{title:a.name}))},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}};try{r.tinymceModel=this.pagina.html}catch(o){}},r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx"],r.tamanhoFicheiro=15,r.defaultInternaEditar=function(o){if(o.$valid&&o.$submitted){var a={portal:n.portalAPI,data:{cdMenu:r.menuAtual.cdMenu,html:r.tinymceModel||"",anexoPortalList:r.pagina.anexoPortalList}};r.pagina.html=r.tinymceModel,n.request("POST","/menu/salvarConteudoHtml",a,!0,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}},r.ficheiroAnexoNovo=function(){r.pagina.anexoPortalList||(r.pagina.anexoPortalList=[{anexoPortalItemList:[]}]);r.pagina.anexoPortalList.push({novo:!0,cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]})},r.ficheiroAnexoExcluir=function(o,e,a,t){e.novo?r.pagina.anexoPortalList.splice(t,1):s.confirmar("Confirma Excluir Ficheiro ?",function(o){if(o){var a={portal:n.portalAPI,data:{cdAnexoPortal:e.cdAnexoPortal}};n.request("POST","/menu/removerAnexo",a,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),r.pagina.anexoPortalList.splice(t,1),i.$broadcast("broadcastHomeReceiver")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},r.preUpload=function(a,o,e,t){if(angular.isDefined(t)&&t.target.files.length){var i=t.target.files[0];if(i.extensao=i.name.split("."),0<i.size){var n=new FileReader;n.readAsDataURL(i),n.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(i.extensao[i.extensao.length-1].toLowerCase())<0&&(n.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),i.size>1048576*r.tamanhoFicheiro&&(n.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&(a.nome=i.name,a.base64Anexo=n.result.substr(n.result.indexOf(",")+1).replace(/ /g,""),a.extensao=i.extensao[i.extensao.length-1],a.mimeType=i.type)},n.onloadstart=function(){s.showProgressAlert()},n.onloadend=function(){s.closeProgressAlert()},n.onabort=function(){s.closeProgressAlert()}}else s.showMensagemRetorno(400,"O ficheiro está vazio!")}}}]}),app.component("artigosCrud",{templateUrl:"app/partials/artigos-crud.html",bindings:{itens:"<",artigo:"<"},controller:["$rootScope","$scope","$filter","$timeout","RequestService","StorageService","AlertaService","UtilizadorService","Cropper","Utils",function(t,n,o,r,i,e,s,a,l,c){n.utilizador=e.get("utilizadorLogado"),n.administrador=!1,n.gestor=!1,n.publicador=!1,n.redator=!1,n.revisor=!1,n.editor=!1,n.utilizador&&(n.administrador=c.validaPermissao("administrador",n.utilizador.grupos),n.gestor=c.validaPermissao("gestor",n.utilizador.grupos),n.publicador=c.validaPermissao("publicador",n.utilizador.grupos),n.redator=c.validaPermissao("redator",n.utilizador.grupos),n.revisor=c.validaPermissao("revisor",n.utilizador.grupos),n.editor=c.validaPermissao("editor",n.utilizador.grupos)),n.validaEditar=function(o){var a=!1;return"CRIA"==o&&(n.editor||n.redator||n.gestor||n.administrador)?a=!0:"RREV"==o&&(n.editor||n.redator||n.gestor||n.administrador)?a=!0:n.administrador&&(a=!0),a},n.validaVisualizar=function(o){var a=!1;return"AREV"==o&&(n.editor||n.redator||n.revisor||n.gestor||n.administrador)?a=!0:"RPUB"==o&&(n.revisor||n.gestor||n.administrador)?a=!0:"REV"==o&&(n.publicador||n.gestor||n.administrador)?a=!0:"PUB"==o&&(n.publicador||n.editor||n.redator||n.revisor||n.gestor||n.administrador)?a=!0:"CRIA"==o&&(n.revisor||n.publicador||n.gestor||n.administrador)?a=!0:"RREV"==o&&(n.revisor||n.publicador||n.gestor||n.administrador)?a=!0:"REV"==o&&(n.revisor||n.publicador||n.gestor||n.administrador)&&(a=!0),a},t.$on("broadcastUtilizadorReceiver",function(o,a){n.utilizador=e.get("utilizadorLogado"),n.utilizador&&(n.administrador=c.validaPermissao("administrador",n.utilizador.grupos),n.gestor=c.validaPermissao("gestor",n.utilizador.grupos),n.publicador=c.validaPermissao("publicador",n.utilizador.grupos),n.redator=c.validaPermissao("redator",n.utilizador.grupos),n.revisor=c.validaPermissao("revisor",n.utilizador.grupos),n.editor=c.validaPermissao("editor",n.utilizador.grupos))}),n.tipo="N";this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerirArtigos",function(){n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirArtigosNovo",function(){n.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirArtigosNovo",function(){n.exibirForm=!0})},n.extensoesPermitidasImagens=["jpg","jpeg","png"],n.tamanhoFicheiroImagem=1,n.editorImageUpload={},n.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:300,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",image_dimensions:!1,image_description:!1,nowrap:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){r(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},100)})})},file_picker_callback:function(t,o,a){var i=angular.element("#editorImageUpload");r(function(){angular.element(i).click()},200),i.on("change",function(o){var a=o.target.files[0];a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};n.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),a.size>1048576*n.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&(i.val(""),t(e.result,{title:a.name}))},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}},n.salvarNoticia=function(a){a.$valid&&a.$submitted&&(n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo&&(n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.substr(n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.indexOf(",")+1).replace(/ /g,"")),n.dataJson.portal=i.portalAPI,n.dataJson.data.dtInicio=moment(n.dataJson.data.dtInicio,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),n.dataJson.data.dtFim=moment(n.dataJson.data.dtFim,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),i.request("POST","/noticia/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),r(function(){n.dataJson={data:o.data},n.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")},1e3),t.$broadcast("broadcastHomeReceiver")}),a.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))},n.excluirAnexo=function(){n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},n.excluir=function(e,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:i.portalAPI,data:{cdPublicacao:e.cdPublicacao}};i.request("DELETE","/noticia/remover",a,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},n.editar=function(o){i.request("GET","/noticia/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.dataJson={data:o.data},n.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.noticiaVisualizada=null,n.visualizar=function(o){n.noticiaVisualizada=null,i.request("GET","/noticia/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.noticiaVisualizada=o.data,n.noticiaVisualizada.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.noticiaVisualizada.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.noticiaSelecionada=null,n.motivoStatusSelecionado=null,n.selecionaMotivoNoticia=function(o,a){n.noticiaSelecionada=angular.copy(o),n.noticiaSelecionada.observacao=null,n.motivoStatusSelecionado=a,n.formObservacaoArtigo.$setPristine(),c.mantemModal("#modalGerirArtigos",!1),r(function(){c.mantemModal("#modalGerirArtigosObservacao",!0)},600)},n.limparMotivo=function(){n.noticiaSelecionada=null,n.motivoStatusSelecionado=null},n.salvarMotivo=function(o){o.$valid&&o.$submitted&&n.alterarStatusNoticia(n.noticiaSelecionada,n.motivoStatusSelecionado)},n.alterarStatusNoticia=function(a,e){s.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(n.dataJson={data:angular.copy(a)},n.dataJson.data.flStatusPublicacao.sigla=e,n.dataJson.data.flStatusPublicacao.descricao=e,n.dataJson.data.flStatusPublicacao.detalhe=null,n.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",n.noticiaSelecionada||(n.dataJson.data.observacao=null),n.dataJson.portal=i.portalAPI,i.request("POST","/noticia/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),r(function(){n.dataJson={data:o.data},n.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY"),n.noticiaSelecionada&&(n.noticiaSelecionada=null,n.motivoStatusSelecionado=null,c.mantemModal("#modalGerirArtigosObservacao",!1),r(function(){c.mantemModal("#modalGerirArtigos",!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))})},n.setObj=function(){n.dataJson={data:{cdPublicacao:null,descricao:null,dtFim:null,dtInicio:null,autor:null,flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:null,dsPortal:i.portalAPI,flDestaque:"N",dtCriacao:null,observacao:null,idAnexo:null,idImagem:null,filePath:null,urlImagemContent:null}}},n.ficheiroAnexoNovo=function(){n.dataJson.data.anexoPortalList=[{anexoPortalItemList:[]}];n.dataJson.data.anexoPortalList=[],n.dataJson.data.anexoPortalList.push({novo:!0,cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]})},n.paginaAtual=0,n.paginacaoQtdRegistros=5,n.paginacaoArray=[5,10,15,20],n.q="",n.exibirDestaques="N",n.paginarRegistos=function(){i.request("GET","/noticia/listarTodos/"+i.portalAPI+"/"+n.exibirDestaques+"/"+(n.paginaAtual+1)+"/"+n.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.itensPaginados=o):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()},n.carregarRegistrosDestaques=function(o){n.exibirDestaques=o.exibirDestaques,n.paginarRegistos()}}]}),app.component("noticiasCrud",{templateUrl:"app/partials/noticias-crud.html",bindings:{itens:"<",artigo:"<"},controller:["$rootScope","$scope","$filter","$timeout","RequestService","StorageService","AlertaService","UtilizadorService","Cropper","Utils",function(t,n,o,r,i,e,s,a,l,c){n.utilizador=e.get("utilizadorLogado"),n.administrador=!1,n.gestor=!1,n.publicador=!1,n.redator=!1,n.revisor=!1,n.editor=!1,n.utilizador&&(n.administrador=c.validaPermissao("administrador",n.utilizador.grupos),n.gestor=c.validaPermissao("gestor",n.utilizador.grupos),n.publicador=c.validaPermissao("publicador",n.utilizador.grupos),n.redator=c.validaPermissao("redator",n.utilizador.grupos),n.revisor=c.validaPermissao("revisor",n.utilizador.grupos),n.editor=c.validaPermissao("editor",n.utilizador.grupos)),n.validaEditar=function(o){var a=!1;return"CRIA"==o&&(n.editor||n.redator||n.gestor||n.administrador)?a=!0:"RREV"==o&&(n.editor||n.redator||n.gestor||n.administrador)?a=!0:n.administrador&&(a=!0),a},n.validaVisualizar=function(o){var a=!1;return"AREV"==o&&(n.editor||n.redator||n.revisor||n.gestor||n.administrador)?a=!0:"RPUB"==o&&(n.revisor||n.gestor||n.administrador)?a=!0:"REV"==o&&(n.publicador||n.gestor||n.administrador)?a=!0:"PUB"==o&&(n.publicador||n.editor||n.redator||n.revisor||n.gestor||n.administrador)?a=!0:"CRIA"==o&&(n.revisor||n.publicador||n.gestor||n.administrador)?a=!0:"RREV"==o&&(n.revisor||n.publicador||n.gestor||n.administrador)?a=!0:"REV"==o&&(n.revisor||n.publicador||n.gestor||n.administrador)&&(a=!0),a},t.$on("broadcastUtilizadorReceiver",function(o,a){n.utilizador=e.get("utilizadorLogado"),n.utilizador&&(n.administrador=c.validaPermissao("administrador",n.utilizador.grupos),n.gestor=c.validaPermissao("gestor",n.utilizador.grupos),n.publicador=c.validaPermissao("publicador",n.utilizador.grupos),n.redator=c.validaPermissao("redator",n.utilizador.grupos),n.revisor=c.validaPermissao("revisor",n.utilizador.grupos),n.editor=c.validaPermissao("editor",n.utilizador.grupos))}),n.tipo="N";this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerirNoticias",function(){n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirNoticiasNovo",function(){n.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirNoticiasNovo",function(){n.exibirForm=!0})},n.extensoesPermitidasImagens=["jpg","jpeg","png"],n.tamanhoFicheiroImagem=1,n.editorImageUpload={},n.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:300,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",image_dimensions:!1,image_description:!1,nowrap:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){r(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},100)})})},file_picker_callback:function(t,o,a){var i=angular.element("#editorImageUpload");r(function(){angular.element(i).click()},200),i.on("change",function(o){var a=o.target.files[0];a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};n.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),a.size>1048576*n.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&(i.val(""),t(e.result,{title:a.name}))},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}},n.salvarNoticia=function(a){a.$valid&&a.$submitted&&(n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo&&(n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.substr(n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.indexOf(",")+1).replace(/ /g,"")),n.dataJson.portal=i.portalAPI,n.dataJson.data.dtInicio=moment(n.dataJson.data.dtInicio,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),n.dataJson.data.dtFim=moment(n.dataJson.data.dtFim,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),i.request("POST","/noticia/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),r(function(){n.dataJson={data:o.data},n.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")},1e3),t.$broadcast("broadcastHomeReceiver")}),a.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))},n.excluirAnexo=function(){n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},n.excluir=function(e,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:i.portalAPI,data:{cdPublicacao:e.cdPublicacao}};i.request("DELETE","/noticia/remover",a,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},n.editar=function(o){i.request("GET","/noticia/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.dataJson={data:o.data},n.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.noticiaVisualizada=null,n.visualizar=function(o){n.noticiaVisualizada=null,i.request("GET","/noticia/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.noticiaVisualizada=o.data,n.noticiaVisualizada.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.noticiaVisualizada.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.noticiaSelecionada=null,n.motivoStatusSelecionado=null,n.selecionaMotivoNoticia=function(o,a){n.noticiaSelecionada=angular.copy(o),n.noticiaSelecionada.observacao=null,n.motivoStatusSelecionado=a,n.formObservacaoNoticia.$setPristine(),c.mantemModal("#modalGerirNoticias",!1),r(function(){c.mantemModal("#modalGerirNoticiasObservacao",!0)},600)},n.limparMotivo=function(){n.noticiaSelecionada=null,n.motivoStatusSelecionado=null},n.salvarMotivo=function(o){o.$valid&&o.$submitted&&n.alterarStatusNoticia(n.noticiaSelecionada,n.motivoStatusSelecionado)},n.alterarStatusNoticia=function(a,e){s.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(n.dataJson={data:angular.copy(a)},n.dataJson.data.flStatusPublicacao.sigla=e,n.dataJson.data.flStatusPublicacao.descricao=e,n.dataJson.data.flStatusPublicacao.detalhe=null,n.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",n.noticiaSelecionada||(n.dataJson.data.observacao=null),n.dataJson.portal=i.portalAPI,i.request("POST","/noticia/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),r(function(){n.dataJson={data:o.data},n.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),n.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY"),n.noticiaSelecionada&&(n.noticiaSelecionada=null,n.motivoStatusSelecionado=null,c.mantemModal("#modalGerirNoticiasObservacao",!1),r(function(){c.mantemModal("#modalGerirNoticias",!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))})},n.setObj=function(){n.dataJson={data:{cdPublicacao:null,descricao:null,dtFim:null,dtInicio:null,autor:null,flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:null,dsPortal:i.portalAPI,flDestaque:"S",dtCriacao:null,observacao:null,idAnexo:null,idImagem:null,filePath:null,urlImagemContent:null}}},n.ficheiroAnexoNovo=function(){n.dataJson.data.anexoPortalList=[{anexoPortalItemList:[]}];n.dataJson.data.anexoPortalList=[],n.dataJson.data.anexoPortalList.push({novo:!0,cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]})},n.paginaAtual=0,n.paginacaoQtdRegistros=5,n.paginacaoArray=[5,10,15,20],n.q="",n.exibirDestaques="S",n.paginarRegistos=function(){i.request("GET","/noticia/listarTodos/"+i.portalAPI+"/"+n.exibirDestaques+"/"+(n.paginaAtual+1)+"/"+n.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.itensPaginados=o):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()},n.carregarRegistrosDestaques=function(o){n.exibirDestaques=o.exibirDestaques,n.paginarRegistos()}}]}),app.component("videosCrud",{templateUrl:"app/partials/videos-crud.html",bindings:{itens:"<",video:"<"},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(t,i,o,n,r,e){i.utilizador=e.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,a){i.utilizador=e.get("utilizadorLogado")}),this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirVideos",function(){i.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirVideosNovo",function(){i.exibirForm=!1}),$(document).on("shown.bs.modal","#modalGerirVideosNovo",function(){i.exibirForm=!0})},i.novoVideo=function(a){a.$valid&&a.$submitted&&n.request("POST","/video/salvar",i.dataJson,!0,function(o){o?200==o.retorno.codigo?r.closeProgressAlert(function(){r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")}),a.$setPristine(),i.dataJson.data.cdPublicacao||a.$$element[0].reset(),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},i.setObj=function(o){i.dataJson={portal:n.portalAPI,data:{}},i.dataJson.data=o||{cdPublicacao:null,descricao:null,dtFim:null,dtInicio:null,autor:null,flStatusPublicacao:{sigla:"PUB",descricao:"PUB",detalhe:"Publicado",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:null,dsPortal:n.portalAPI,flDestaque:"N",dtCriacao:null,observacao:null}},i.dataJson={},i.paginaAtual=0,i.paginacaoQtdRegistros=5,i.paginacaoArray=[5,10,15,20],i.q="",i.paginarRegistos=function(){n.request("GET","/video/listar/"+n.portalAPI+"/"+(i.paginaAtual+1)+"/"+i.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),i.itensPaginados=o):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},i.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(i.itensPaginados.quantidadeTotalItens/i.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},i.setarPaginaAtual=function(o){i.paginaAtual=o,i.paginarRegistos()},i.setarRegistosPorPagina=function(o){i.paginacaoQtdRegistros=o.paginacaoQtdRegistros,i.paginarRegistos()},i.carregarRegistrosDestaques=function(o){i.exibirDestaques=o.exibirDestaques,i.paginarRegistos()},i.excluir=function(e,o){r.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:n.portalAPI,data:{cdPublicacao:e.cdPublicacao}};n.request("DELETE","/video/remover",a,!0,function(o){o?200==o.retorno.codigo?(i.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}})}}]}),app.component("galeriasCrud",{templateUrl:"app/partials/galerias-crud.html",bindings:{template:"@",label:"@"},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(i,n,r,s,l,e){n.utilizador=e.get("utilizadorLogado"),i.$on("broadcastUtilizadorReceiver",function(o,a){n.utilizador=e.get("utilizadorLogado")}),this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirGaleria",function(){n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirGaleriasNovo",function(){n.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirGaleriasNovo",function(){n.exibirForm=!0})},n.extensoesPermitidasImagens=["jpg","jpeg","png"],n.tamanhoFicheiroImagem=1,n.novoFormulario=function(a){a.$valid&&a.$submitted&&s.request("POST","/noticia/galeria/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),r(function(){n.setObj(o.data)},1e3),i.$broadcast("broadcastHomeReceiver")}),a.$setPristine()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.preUpload=function(o){angular.isDefined(o)&&o.target.files.length&&angular.forEach(o.target.files,function(e){e.extensao=e.name.split(".");var o=new FileReader;o.readAsDataURL(e),o.onload=function(){var o={permitir:!0,tamanho:!0};if(n.extensoesPermitidasImagens.indexOf(e.extensao[e.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),e.size>1048576*n.tamanhoFicheiroImagem&&(a.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var o={cdAnexoPortal:null,anexoPortalItemList:[{nome:e.name,base64Anexo:a.result.substr(a.result.indexOf(",")+1).replace(/ /g,""),extensao:e.extensao[e.extensao.length-1],mimeType:e.type,url:null,videoUrl:null}]};n.dataJson.data.anexoPortalList.push(o)}}},o.onloadstart=function(){l.showProgressAlert()},o.onloadend=function(){l.closeProgressAlert()},o.onabort=function(){l.closeProgressAlert()}})},n.excluirAnexo=function(e,o,t){l.confirmar("Excluir este Registo ?",function(o){var a={portal:s.portalConfig.portalAPI,data:{cdAnexoPortal:e.cdAnexoPortal}};s.request("POST","/menu/removerAnexo",a,!0,function(o){r(function(){n.dataJson.data.anexoPortalList.splice(t,1),l.closeProgressAlert(),i.$broadcast("broadcastHomeReceiver")},100)})})},n.excluir=function(e,o){l.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:s.portalConfig.portalAPI,data:{cdPublicacao:e.cdPublicacao}};s.request("DELETE","/formulario/remover",a,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(),i.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.setObj=function(o){n.dataJson={portal:s.portalConfig.portalAPI,data:{}},o?(n.dataJson.data=o,n.dataJson.data.anexoPortalList.length||(n.dataJson.data.anexoPortalList=[])):n.dataJson={portal:s.portalConfig.portalAPI,data:{cdPublicacao:null,descricao:null,descricaoGaleria:null,dtFim:null,dtInicio:null,flStatusPublicacao:{sigla:"PUB",detalhe:"Publicada",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,templatePublicacao:null,dsPortal:s.portalConfig.portalAPI,flDestaque:"N",autor:null,dtCriacao:null,observacao:null,idAnexo:null,idImagem:null,filePath:null,urlImagemContent:null,anexoPortalList:[]}}},n.dataJson={},n.paginaAtual=0,n.paginacaoQtdRegistros=5,n.q="",n.paginarRegistos=function(){var o={portal:s.portalConfig.portalAPI,data:{flDestaque:"N"}};s.request("POST","/noticia/galeria/listar/",o,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),n.itensPaginados=o):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()}}]}),app.component("formulariosCrud",{templateUrl:"app/partials/formularios-crud.html",bindings:{template:"@",label:"@",imgCrop:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(t,r,e,i,s,n){var a=this;r.utilizador=n.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,a){r.utilizador=n.get("utilizadorLogado")}),this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerir"+a.template,function(){r.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+a.template+"Novo",function(){r.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+a.template+"Novo",function(){r.exibirForm=!0})},r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx","jpg","png","zip","rar"],r.tamanhoFicheiro=10,r.extensoesImagensPermitidas=["jpg","jpeg","png"],r.tamanhoImagemFicheiro=1,r.novoFormulario=function(a){a.$valid&&a.$submitted&&i.request("POST","/formulario/salvar",r.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){e(function(){r.setObj(o.data)},1e3)}),t.$broadcast("broadcastHomeReceiver"),a.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},r.preUpload=function(o,a,e,t){if(angular.isDefined(t)&&angular.isUndefined(t.isTrigger)&&t.target.files.length){var i=t.target.files[0];i.extensao=i.name.split(".");var n=new FileReader;n.readAsDataURL(i),n.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(i.extensao[i.extensao.length-1].toLowerCase())<0&&(n.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),i.size>1048576*r.tamanhoFicheiro&&(n.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&(r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].nome=i.name,r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=n.result.substr(n.result.indexOf(",")+1).replace(/ /g,""),r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].extensao=i.extensao[i.extensao.length-1],r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].mimeType=i.type)},n.onloadstart=function(){s.showProgressAlert()},n.onloadend=function(){s.closeProgressAlert()},n.onabort=function(){s.closeProgressAlert()}}},r.ficheiroAnexoExcluir=function(e,o,a,t){o.novo?r.ficheiroAnexoNovo():s.confirmar("Confirma Excluir Ficheiro ?",function(o){if(o){var a={portal:RequestSer.portalAPI,data:{cdAnexoPortalItem:e.cdAnexoPortalItem}};i.request("POST","/menu/removerAnexoItem",a,!1,function(o){o?200==o.retorno.codigo?r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0]={cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}:923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},r.ficheiroAnexoNovo=function(){r.dataJson.data.anexoPortalList=[{anexoPortalItemList:[]}];r.dataJson.data.anexoPortalList.push({novo:!0,cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null},{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]})},r.excluir=function(e,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:i.portalAPI,data:{cdPublicacao:e.cdPublicacao}};i.request("DELETE","/formulario/remover",a,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},r.setObj=function(o){if(r.dataJson={portal:i.portalAPI,data:{}},o)if(r.dataJson.data=o,r.dataJson.data.anexoPortalList.length)try{var a=[];angular.forEach(r.dataJson.data.anexoPortalList[0].anexoPortalItemList,function(o){0<=o.nome.indexOf("_CAPA_")?a[1]=o:a[0]=o}),r.dataJson.data.anexoPortalList[0].anexoPortalItemList=a}catch(o){console.log(o)}else r.ficheiroAnexoNovo();else r.dataJson={portal:i.portalAPI,data:{cdPublicacao:null,descricao:"descricao",dtFim:null,dtInicio:null,flStatusPublicacao:{sigla:"PUB",descricao:"PUB",detalhe:"Publicado",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null},{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:this.$ctrl.template,descricao:this.$ctrl.template,detalhe:"Formulário",dominio:"TP_FORMULARIO"},publicacaoList:null,anexoPortalList:null},dsPortal:i.portalAPI,flDestaque:null,observacao:null,autor:null,dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100")}}},r.dataJson={},r.paginaAtual=0,r.paginacaoQtdRegistros=5,r.paginacaoArray=[5,10,15,20],r.q="",r.paginarRegistos=function(){var o={portal:i.portalAPI,data:{paginaAtual:r.paginaAtual+1,itensPorPagina:r.paginacaoQtdRegistros,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:a.template,descricao:a.template,detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};i.request("POST","/formulario/listar/",o,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),r.itensPaginados=o):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},r.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(r.itensPaginados.quantidadeTotalItens/r.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},r.setarPaginaAtual=function(o){r.paginaAtual=o,r.paginarRegistos()},r.setarRegistosPorPagina=function(o){r.paginacaoQtdRegistros=o.paginacaoQtdRegistros,r.paginarRegistos()}}]}),app.component("eventosCrud",{templateUrl:"app/partials/eventos-crud.html",bindings:{itens:"<",artigo:"<"},controller:["$rootScope","$scope","$filter","$timeout","RequestService","StorageService","AlertaService","UtilizadorService",function(t,i,o,n,r,e,s,a){i.utilizador=e.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,a){i.utilizador=e.get("utilizadorLogado")});this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirEventos",function(){i.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirEventosNovo",function(){i.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirEventosNovo",function(){i.exibirForm=!0})},i.extensoesPermitidasImagens=["jpg","png","gif","bmp"],i.tamanhoFicheiroImagem=1,i.editorImageUpload={},i.tinymceOptions={paste_as_text:!0,menubar:!1,statusbar:!1,plugins:"link image media table lists imagetools paste textcolor",height:200,toolbar:"alignleft aligncenter alignright alignjustify | formatselect forecolor | copy paste cleanup | bold italic underline |  bullist numlist | link unlink | table | undo redo",automatic_uploads:!0,file_picker_types:"image",image_title:!1,image_description:!1,imagetools_toolbar:"editimage imageoptions",content_css:"app/main/css/lato.css",setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){n(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},300)})})},file_picker_callback:function(t,o,a){var e=angular.element("#editorImageUpload");n(function(){angular.element(e).click()},200),e.on("change",function(o){var a=o.target.files[0];a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};i.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),a.size>1048576*i.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&t(e.result,{title:a.name})},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}},i.salvarEvento=function(a){a.$valid&&a.$submitted&&(i.dataJson.data.dtInicial=moment(i.dataJson.data.dtInicial,"DD-MM-YYYY HH:mm").format("DD-MM-YYYYTHH:mm:ss.000+0100"),i.dataJson.data.dtFinal=moment(i.dataJson.data.dtFinal,"DD-MM-YYYY HH:mm").format("DD-MM-YYYYTHH:mm:ss.000+0100"),r.request("POST","/evento/salvar",i.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){t.$broadcast("broadcastHomeReceiver"),i.paginarRegistos(),n(function(){i.setObj(o.data)},1e3)}),a.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))},i.excluirAnexo=function(){i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},i.excluir=function(e,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalAPI,data:{cdAgendaEvento:e.cdAgendaEvento}};r.request("DELETE","/evento/remover",a,!0,function(o){o?200==o.retorno.codigo?(i.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},i.dataJson={},i.setObj=function(o){i.dataJson={portal:r.portalAPI,data:{}},o?(i.dataJson.data=o,i.dataJson.data.dtInicial=moment(i.dataJson.data.dtInicial,"DD-MM-YYYY HH:mm").format("DD/MM/YYYY HH:mm"),i.dataJson.data.dtFinal=moment(i.dataJson.data.dtFinal,"DD-MM-YYYY HH:mm").format("DD/MM/YYYY HH:mm")):i.dataJson={portal:r.portalAPI,data:{cdAgendaEvento:null,dsPortal:r.portalAPI,templatePublicacao:null,tituloAgendaEvento:null,localAgendaEvento:null,dsAgendaEvento:null,dtFinal:null,dtInicial:null,flAtivo:"S",anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],flStatusPublicacao:{sigla:"PUB",descricao:"PUB",detalhe:"Publicado",dominio:"FL_STATUS_PUBLICACAO"},cgRefCodes:{sigla:"ACOE",descricao:"ACOE",detalhe:"Sala de Imprensa",dominio:"TP_AGENDA_EVENTO"},observacao:null,dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),detalhe:null}}},i.toggleActivo=function(a){i.toggle(a);var o={portal:r.portalAPI,data:a};r.request("POST","/evento/salvar",o,!1,function(o){o?200==o.retorno.codigo?t.$broadcast("broadcastHomeReceiver"):(923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),i.toggle(a)):(s.erroRede(),i.toggle(a))})},i.toggle=function(o){return"S"==o.flAtivo?o.flAtivo="N":"N"==o.flAtivo&&(o.flAtivo="S"),o},i.paginaAtual=0,i.paginacaoQtdRegistros=5,i.paginacaoArray=[5,10,15,20],i.q="",i.exibirDestaques="S",i.paginarRegistos=function(){r.request("GET","/evento/listar/"+r.portalAPI+"/T/"+(i.paginaAtual+1)+"/"+i.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),i.itensPaginados=o):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(i.itensPaginados.quantidadeTotalItens/i.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},i.setarPaginaAtual=function(o){i.paginaAtual=o,i.paginarRegistos()},i.setarRegistosPorPagina=function(o){i.paginacaoQtdRegistros=o.paginacaoQtdRegistros,i.paginarRegistos()},i.carregarRegistrosDestaques=function(o){i.exibirDestaques=o.exibirDestaques,i.paginarRegistos()}}]}),app.component("linksUteisCrud",{templateUrl:"app/partials/links-uteis-crud.html",bindings:{tipo:"@",dimensoes:"@",titulo:"@",url:"=",activo:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService","Utils",function(t,n,r,i,s,e,l){var c=this,u=this;n.utilizador=e.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,a){n.utilizador=e.get("utilizadorLogado")}),n.dataJson={},n.paginaAtual=1,n.paginacaoQtdRegistros=5,n.paginacaoArray=[5,10,15,20],n.q="",n.linksUteiSelecionado,n.motivoStatusSelecionado,this.$onInit=function(o){u.initUtilizador(!1)},this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerir"+c.tipo,function(){n.paginaAtual=1,n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+c.tipo+"Novo",function(){n.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+c.tipo+"Novo",function(){n.exibirForm=!0})},u.initUtilizador=function(o){u.utilizador=e.get("utilizadorLogado"),u.administrador=!1,u.gestor=!1,u.publicador=!1,u.redator=!1,u.revisor=!1,u.editor=!1,u.utilizador&&(u.administrador=l.validaPermissao("administrador",u.utilizador.grupos),u.gestor=l.validaPermissao("gestor",u.utilizador.grupos),u.publicador=l.validaPermissao("publicador",u.utilizador.grupos),u.redator=l.validaPermissao("redator",u.utilizador.grupos),u.revisor=l.validaPermissao("revisor",u.utilizador.grupos),u.editor=l.validaPermissao("editor",u.utilizador.grupos),o&&u.init(null,u.utilizador.gestor))},u.validaEditar=function(o){var a=!1;return"CRIA"==o&&(u.editor||u.redator||u.gestor||u.administrador)?a=!0:"RREV"==o&&(u.editor||u.redator||u.gestor||u.administrador)?a=!0:u.administrador&&(a=!0),a},n.extensoesPermitidas=["jpg","jpeg","png","gif"],n.tamanhoFicheiro=1,n.tinymceOptionsUpload={paste_as_text:!0,menubar:!1,statusbar:!1,plugins:"link image media table lists paste code",height:200,toolbar:"image",automatic_uploads:!0,file_picker_types:"image",fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 20pt 21pt 22pt 23pt 24pt",image_title:!1,image_description:!1,image_dimensions:!1,nowrap:!1,readonly:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){r(function(){"Inserir/editar imagem"==$(".mce-title").html()&&($(".mce-combobox input").attr("readonly","readonly").addClass("disabled"),$("input:last").focus())},100)})})},file_picker_callback:function(t,o,a){var i=angular.element("#editorImagemLink_"+c.tipo);r(function(){angular.element(i).click()},200),i.on("change",function(o){n.ficheiroSelecionado=o.target.files[0],n.ficheiroSelecionado.extensao=n.ficheiroSelecionado.name.split(".");var e=new FileReader;e.readAsDataURL(n.ficheiroSelecionado),e.onload=function(){var o={permitir:!0,tamanho:!0};if(n.extensoesPermitidas.indexOf(n.ficheiroSelecionado.extensao[n.ficheiroSelecionado.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.showMensagemRetorno(400,"Tipo do ficheiro inválido")),n.ficheiroSelecionado.size>n.tamanhoMaximoPermitido&&(e.onloadend=!1,o.tamanho=!1,Alertas.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho){var a=e.result;n.editorImageUpload=a,i.val(""),t(a,{title:n.ficheiroSelecionado.name})}},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}},n.novoLinkUtil=function(a){if(a.$valid&&a.$submitted){if(n.editorImageUpload){var e=n.editorImageUpload.substr(n.editorImageUpload.indexOf(",")+1).replace(/ /g,"");try{n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].nome=n.ficheiroSelecionado.name,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].mimeType=n.ficheiroSelecionado.type,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].extensao=n.ficheiroSelecionado.extensao[n.ficheiroSelecionado.extensao.length-1],n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=e}catch(o){n.dataJson.data.anexoPortalList=[{anexoPortalList:[{nome:n.ficheiroSelecionado.name,mimeType:n.ficheiroSelecionado.type,extensao:n.ficheiroSelecionado.extensao[n.ficheiroSelecionado.extensao.length-1],base64:e}]}]}}var o=angular.copy(n.dataJson);"IMGALT"!=c.tipo||n.dataJson.data.url||(o.data.url="semurl"),i.request("POST","/linksUteis/salvar",o,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos()}),a.$setPristine(),n.dataJson.data.cdLinksUteis||a.$$element[0].reset(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}},n.toggleActivo=function(a){n.toggle(a);var o={portal:i.portalConfig.portalAPI,data:a};i.request("POST","/linksUteis/salvar",o,!1,function(o){o?200==o.retorno.codigo?t.$broadcast("broadcastHomeReceiver"):(923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),n.toggle(a)):(s.erroRede(),n.toggle(a))})},n.toggle=function(o){return"S"==o.flAtivo?o.flAtivo="N":"N"==o.flAtivo&&(o.flAtivo="S"),o},n.excluir=function(e,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:i.portalConfig.portalAPI,data:{cdLinksUteis:e.cdLinksUteis}};i.request("DELETE","/linksUteis/remover",a,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},n.excluirAnexo=function(){n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},n.setObj=function(o){n.dataJson={portal:i.portalConfig.portalAPI,data:{}},o?("semurl"==o.url&&(o.url=null),n.dataJson.data=o):n.dataJson.data={cdLinksUteis:null,dsPortal:i.portalConfig.portalAPI,flAtivo:"S",dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),titulo:null,url:null,flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},observacao:null,tpLinksUteis:this.$ctrl.tipo,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}]}},u.alterarStatusLinksUteis=function(a,e){s.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(u.dataJson={data:angular.copy(a)},u.dataJson.data.flStatusPublicacao.sigla=e,u.dataJson.data.flStatusPublicacao.descricao=e,u.dataJson.data.flStatusPublicacao.detalhe=null,u.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",u.linksUteiSelecionado,u.dataJson.portal=i.portalConfig.portalAPI,i.request("POST","/linksUteis/atualizar-situacao",u.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),r(function(){u.dataJson={data:o.data},u.linksUteiSelecionado&&(u.linksUteiSelecionado=null,u.motivoStatusSelecionado=null,l.mantemModal("#modalGerir"+$filter("slugify")(u.label.plural),!1),r(function(){l.mantemModal("#modalGerir"+$filter("slugify")(u.label.plural),!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))})},u.selecionaMotivolinksUteis=function(o,a,e){e.$setPristine(),u.linksUteisSelecionada=angular.copy(o),u.motivoStatusSelecionado=angular.copy(a),l.mantemModal("#modalGerirslugifyObservacao"+u.tipo,!1),r(function(){l.mantemModal("#modalGerirslugifyObservacao"+u.tipo,!0)},600)},u.limparMotivo=function(){u.linksUteisSelecionada=null,u.motivoStatusSelecionado=null},u.salvarMotivo=function(o){o.$valid&&o.$submitted&&u.alterarStatusLinksUteis(u.linksUteisSelecionada,u.motivoStatusSelecionado)},n.paginarRegistos=function(){i.request("GET","/linksUteis/listar/"+i.portalConfig.portalAPI+"/"+c.tipo+"/T/"+n.paginaAtual+"/"+n.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n.itensPaginados=o.data,n.quantidadeTotalItens=0<parseInt(o.quantidadeTotalItens)?o.quantidadeTotalItens:n.itensPaginados.length):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()},n.carregarRegistrosDestaques=function(o){n.exibirDestaques=o.exibirDestaques,n.paginarRegistos()}}]}),app.component("perguntasCrud",{templateUrl:"app/partials/perguntas-crud.html",bindings:{itens:"<",artigo:"<",sigla:"@",label:"@"},controller:["$rootScope","$scope","$filter","$timeout","RequestService","StorageService","AlertaService","UtilizadorService",function(t,i,o,n,r,e,s,a){i.utilizador=e.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,a){i.utilizador=e.get("utilizadorLogado")});var l=this;this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirPerguntas"+l.sigla,function(){i.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirPerguntas"+l.sigla+"Novo",function(){i.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirPerguntas"+l.sigla+"Novo",function(){i.exibirForm=!0})},i.extensoesPermitidasImagens=["jpg","jpeg","png"],i.tamanhoFicheiroImagem=1,i.editorImageUpload={},i.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists imagetools paste textcolor code",height:300,toolbar:"alignleft aligncenter alignright alignjustify | outdent indent | formatselect forecolor | copy paste cleanup | bold italic underline | bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",image_title:!1,image_description:!1,imagetools_toolbar:"editimage imageoptions",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){n(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},300)})})},setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){n(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},300)})})},file_browser_callback:function(o,a,e,t){},file_picker_callback:function(t,o,a){var e=angular.element("#editorImageUpload");n(function(){angular.element(e).click()},200),e.on("change",function(o){var a=o.target.files[0];a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};i.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Tipo do ficheiro inválido")})),a.size>1048576*i.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.closeProgressAlert(function(){s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")})),o.permitir&&o.tamanho&&t(e.result,{title:a.name})},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}},i.salvarPergunta=function(o){o.$valid&&o.$submitted&&r.request("POST","/perguntasFrequentes/salvar",i.dataJson,!0,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.excluirAnexo=function(){i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},i.excluir=function(e,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalAPI,data:{cdPerguntaFrequente:e.cdPerguntaFrequente}};r.request("DELETE","/perguntasFrequentes/remover",a,!0,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},i.dataJson={},i.setObj=function(o){i.dataJson={portal:r.portalAPI,data:{}},o?i.dataJson.data=o:i.dataJson={portal:r.portalAPI,data:{cdPerguntaFrequente:null,dsPortal:r.portalAPI,dsPerguntaFrequente:null,dsResposta:null,flAtivo:{sigla:"S",descricao:"S",detalhe:"SIM",dominio:"SIM_NAO"},tpPergunta:{sigla:this.$ctrl.sigla,descricao:this.$ctrl.sigla,detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}}},i.paginaAtual=0,i.paginacaoQtdRegistros=5,i.paginacaoArray=[5,10,15,20],i.q="",i.exibirDestaques="S",i.paginarRegistos=function(){var o={portal:r.portalAPI,data:{tpPergunta:{sigla:this.$ctrl.sigla,descricao:this.$ctrl.sigla,detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}};r.request("POST","/perguntasFrequentes/listar",o,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),i.itensPaginados=o):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(i.itensPaginados.quantidadeTotalItens/i.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}catch(o){}},i.setarPaginaAtual=function(o){i.paginaAtual=o,i.paginarRegistos()},i.setarRegistosPorPagina=function(o){i.paginacaoQtdRegistros=o.paginacaoQtdRegistros,i.paginarRegistos()},i.carregarRegistrosDestaques=function(o){i.exibirDestaques=o.exibirDestaques,i.paginarRegistos()}}]}),app.component("videoPlayer",{templateUrl:"app/partials/video-player.html",bindings:{video:"<",height:"@"},controller:["$scope",function(o){}]}),app.component("produtoDestaque",{templateUrl:"app/partials/produto-destaque.html",bindings:{data:"<"}}),app.component("formulariosSessaoCrud",{templateUrl:"app/partials/formularios-sessao-crud.html",bindings:{template:"=",label:"@",imgCrop:"=",cdpagina:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService","Utils",function(t,r,i,n,s,e,l){var c=this;r.utilizador=e.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,a){r.utilizador=e.get("utilizadorLogado")}),this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerir"+c.template,function(){r.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+c.template+"Novo",function(){r.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+c.template+"Novo",function(){r.exibirForm=!0})},r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx","jpg","png","zip","rar"],r.tamanhoFicheiro=10,r.extensoesImagensPermitidas=["jpg","jpeg","png"],r.tamanhoImagemFicheiro=1,r.preUpload=function(o,a,e,t){if(angular.isDefined(t)&&angular.isUndefined(t.isTrigger)&&t.target.files.length){var i=t.target.files[0];i.extensao=i.name.split(".");var n=new FileReader;n.readAsDataURL(i),n.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(i.extensao[i.extensao.length-1].toLowerCase())<0&&(n.onloadend=!1,o.permitir=!1,s.showMensagemRetorno(400,"Tipo do ficheiro inválido")),i.size>1048576*r.tamanhoFicheiro&&(n.onloadend=!1,o.tamanho=!1,s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(r.sessao.anexoPortalList[0].anexoPortalItemList[a].nome=i.name,r.sessao.anexoPortalList[0].anexoPortalItemList[a].nomeFicheiro=angular.copy(i.name),r.sessao.anexoPortalList[0].anexoPortalItemList[a].base64Anexo=n.result.substr(n.result.indexOf(",")+1).replace(/ /g,""),r.sessao.anexoPortalList[0].anexoPortalItemList[a].extensao=i.extensao[i.extensao.length-1],r.sessao.anexoPortalList[0].anexoPortalItemList[a].mimeType=i.type)},n.onloadstart=function(){s.showProgressAlert()},n.onloadend=function(){s.closeProgressAlert()},n.onabort=function(){s.closeProgressAlert()}}},r.dataAgora=moment().format("YYYY-MM-DD"),r.initSessao={cdPublicacao:null,titulo:null,descricao:null,dtinicial:null,nuOrdem:null,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,cdPublicacao:null,cdQuemEQuem:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,url:null,videoUrl:null,ficheiroUrl:null,base64Anexo:null,mimeType:null,extensao:null,contentUrlARemover:"N",contentId:null,nuOrdem:1}]}]},r.sessao=angular.copy(r.initSessao),r.novaSessaoInit=function(){r.sessao=angular.copy(r.initSessao)},r.editarFormularioSessao=function(o){r.sessao=angular.copy(o)},r.addFicheiroInput=function(){var o={cdAnexoPortalItem:null,nome:null,url:null,videoUrl:null,ficheiroUrl:null,base64Anexo:null,mimeType:null,extensao:null,contentUrlARemover:"N",contentId:null,excluir:!1,nuOrdem:parseInt(r.sessao.anexoPortalList[0].anexoPortalItemList.slice(-1)[0].nuOrdem)+1};r.sessao.anexoPortalList[0].anexoPortalItemList.push(o)},r.verificarFicheiroObrigatorio=function(o){var e=0;return 0<o.length&&angular.forEach(o,function(o,a){o.nome||"S"==o.contentUrlARemover||e++}),!(0<e)},r.excluirFormularioSessao=function(e){s.confirmar(t.const.CONFIRMA_EXCLUIR_SESSAO,function(o){if(o){var a={portal:n.portalConfig.portalAPI,data:{cdPublicacao:e.cdPublicacao}};n.request("DELETE","/formularioSecao/remover",a,!1,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i(function(){r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")},500)}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},r.nomeFicheiro=function(o){return(!o.url||o.nomeFicheiro)&&(!o.url||o.nome)?o.nomeFicheiro?o.nomeFicheiro:o.nome?o.nome:"Seleccionar Ficheiro...":(a=o.url.split("/"))[a.length-1];var a},r.manterFomularioSessao=function(a){if(a.$valid&&a.$submitted&&r.verificarFicheiroObrigatorio(r.sessao.anexoPortalList[0].anexoPortalItemList)){r.sessao.cdPublicacao?angular.forEach(r.sessoes,function(o,a){o.cdPublicacao==r.sessao.cdPublicacao&&(r.sessoes[a]=r.sessao)}):r.sessoes.push(r.sessao);var o={portal:n.portalConfig.portalAPI,data:{cdMenu:c.cdpagina,secoes:null}};o.data.secoes=r.sessoes,n.request("POST","/formularioSecao/salvar",o,!0,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(200,t.const.SESSAO_SALVA_COM_SUCESSO,function(){i(function(){var o="#modalGerir"+c.template+"Novo";l.mantemModal(o,!1),i(function(){l.mantemModal("#modalGerir"+c.template,!0),r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver"),a.$setPristine()},500)},500)}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}},r.ficheiroAnexoExcluir=function(a,e){s.confirmar("Confirma Excluir Ficheiro ?",function(o){o&&i(function(){a.cdAnexoPortalItem?r.sessao.anexoPortalList[0].anexoPortalItemList[e].contentUrlARemover="S":r.sessao.anexoPortalList[0].anexoPortalItemList.splice(e,1)},100)})},r.dataJson={},r.submitListarDocumentos=function(o){o.$valid&&(r.paginaAtual=1,r.paginarRegistos(!0))},r.paginaAtual=1,r.quantidadeTotalItens=0,r.paginacaoQtdRegistros=10,r.paginacaoArray=[10,20,50,100],r.q="",r.paginarRegistos=function(o){var a={portal:n.portalConfig.portalAPI,data:{cdMenu:c.cdpagina,titulo:null,paginaAtual:r.paginaAtual,qtdPaginas:r.paginacaoQtdRegistros,ordenacao:"nuOrdem DESC"}};n.request("POST","/formularioSecao/listarPaginado",a,o,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),r.sessoes=o.data.secoes?o.data.secoes:[],r.quantidadeTotalItens=o.quantidadeTotalItens):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},r.initEditarOrdem=function(o,a,e){o.$setPristine(),a.editando=!a.editando,a.editando&&i(function(){angular.element("#inputEditarOrdem_"+e).focus()},100)},r.editarOrdem=function(o,a){if(o.$valid){var e={portal:n.portalConfig.portalAPI,data:{cdMenu:c.cdpagina,secoes:[a]}};n.request("POST","/formularioSecao/salvar",e,!1,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}}}]}),app.component("formulariosSessaoView",{templateUrl:"app/partials/formularios-sessao-view.html",controller:["$rootScope","$scope","$timeout","$state","$window","RequestService","AlertaService","StorageService",function(o,e,t,a,i,n,r,s){o.$on("broadcastHomeReceiver",function(o,a){t(function(){e.init()},1e3)}),e.init=function(){e.dataJson={portal:n.portalConfig.portalAPI,data:{cdMenu:a.current.cdMenu,titulo:null,paginaAtual:1,qtdPaginas:10,ordenacao:"nuOrdem"}},e.quantidadeTotalItens=0,e.paginarRegistos()},e.paginarRegistos=function(){e.quantidadeTotalItens=0,e.sessoes=[],n.request("POST","/formularioSecao/listarPaginado",e.dataJson,!1,function(o){o?200==o.retorno.codigo?(e.sessoes=o.data.secoes,e.quantidadeTotalItens=o.quantidadeTotalItens,i.scrollTo(0,0)):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}}]}),app.component("quemEQuemCrud",{templateUrl:"app/partials/quem-e-quem-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","RequestService","StorageService","AlertaService",function(e,n,r,a,s){var i=this;e.$on("broadcastUtilizadorReceiver",function(o,a){i.initUtilizador(!1)}),this.$onInit=function(o){i.initUtilizador(),i.extensoesPermitidasImagens=["jpg","jpeg","png"],i.tamanhoFicheiroImagem=1,i.editorImageUpload={},i.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:200,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",nowrap:!1},i.exibirFormAreaColocacao=!1},i.initUtilizador=function(o){i.utilizador=a.get("utilizadorLogado"),o&&i.paginarRegistos(!1)},i.init=function(o){i.registos=[],o&&i.paginarRegistos(!0)},i.paginarRegistos=function(a){a=a||!1,r.request("GET","/quemEQuem/listar/"+r.portalConfig.portalAPI,null,a,function(o){o?(s.closeProgressAlert(),200==o.retorno.codigo&&(a&&s.closeProgressAlert(),i.registos=o.data)):s.erroRede()})},i.salvarQuemEQuem=function(o,a){o.$valid&&r.request("POST","/quemEQuem/salvar",i.dataJson,a,function(o){o?200==o.retorno.codigo?a?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.registo(null,o.data),i.paginarRegistos(!1),e.$broadcast("broadcastHomeReceiver")}):i.paginarRegistos(!1):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.registo=function(o,a){o&&o.$setPristine(),i.dataJson={portal:r.portalConfig.portalAPI},a?i.dataJson.data=angular.copy(a):(i.dataJson.data={cdQuemEQuem:null,dsPortal:r.portalConfig.portalAPI,regimeCarreira:null,cdAreaColocacao:null,areaColocacaoItem:null,endereco:".",filiacao:".",nacionalidade:null,naturalidade:null,noQuemEQuem:null,quemEQuemItemList:[],anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,cdPublicacao:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,url:null,base64Anexo:null,mimeType:null,extensao:null,contentUrlARemover:null}]}]},i.adicionarFormacao()),r.request("GET","/quemEQuem/listar/area-colocacao/"+r.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(i.areaColocacaoList=o.data,a&&(i.dataJson.data.cdAreaColocacao=i.dataJson.data.areaColocacaoItem.areaColocacaoDTO.cdAreaColocacao,i.atualizarSelectPosicao(!1))):s.erroRede()}),i.listarRegimeCarreira(function(o){o&&(i.regimeDeCarreiraList=o.data)})},i.listarRegimeCarreira=function(a){r.request("GET","/quemEQuem/listar/regime-carreira/"+r.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&a(o):s.erroRede()})},i.atualizarSelectPosicao=function(a){i.dataJson.data.cdAreaColocacao&&r.request("GET","/quemEQuem/listar/area-colocacao-item/"+r.portalConfig.portalAPI+"/"+i.dataJson.data.cdAreaColocacao,null,a,function(o){o?(a&&s.closeProgressAlert(),200==o.retorno.codigo&&(i.areaColocacaoListItem=o.data)):s.erroRede()})},i.adicionarFormacao=function(){i.dataJson.data.quemEQuemItemList.push({cdQuemEQuemItem:null,dsQuemEQuemItem:null,noQuemEQuemItem:null})},i.removerFormacao=function(a){s.confirmar("Excluir este Registo ?",function(o){o&&n(function(){i.dataJson.data.quemEQuemItemList.splice(a,1)},200)})},i.remover=function(e){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalConfig.portalAPI,data:{cdQuemEQuem:e.cdQuemEQuem}};r.request("DELETE","/quemEQuem/remover",a,!0,function(o){o?200==o.retorno.codigo?i.paginarRegistos(!1):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},i.initEditarLabelAreaColocacao=function(o,a){o.$setPristine(),a.area.editando=!a.area.editando},i.editarLabel=function(o,a){if(o.$valid){var e={portal:r.portalConfig.portalAPI,data:{cdAreaColocacao:a.area.cdAreaColocacao,dsAreaColocacao:a.area.dsAreaColocacao,nuOrdem:a.area.nuOrdem}};r.request("POST","/quemEQuem/salvar/area-colocacao",e,!0,function(o){o?200==o.retorno.codigo?(i.paginarRegistos(!1),a.editando=!1):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}},i.initEditarOrdem=function(o,a,e,t){o.$setPristine(),a.editando=!a.editando,a.editando&&n(function(){angular.element("#inputEditarOrdem_"+e+"_"+t).focus()},200)},i.editarOrdem=function(o,a){o.$valid&&(i.dataJson={portal:r.portalConfig.portalAPI,data:a},i.salvarQuemEQuem(o,!1))},i.initAreaColocacao=function(o){o.$setPristine(),i.exibirFormAreaColocacao=!i.exibirFormAreaColocacao,i.novaAreaColocacao={portal:r.portalConfig.portalAPI,data:{cdAreaColocacao:null,dsAreaColocacao:null,nuOrdem:null}}},i.adicionarArea=function(o){o.$valid&&r.request("POST","/quemEQuem/salvar/area-colocacao",i.novaAreaColocacao,!0,function(o){o?200==o.retorno.codigo?(i.paginarRegistos(!0),i.exibirFormAreaColocacao=!i.exibirFormAreaColocacao):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.excluirAreaColocacao=function(e){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalConfig.portalAPI,data:{cdAreaColocacao:e.area.cdAreaColocacao}};r.request("DELETE","/quemEQuem/remover/area-colocacao",a,!0,function(o){o?200==o.retorno.codigo?i.paginarRegistos(!1):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},i.initGerirPosicoes=function(a){a.exibirGerirPosicao=!a.exibirGerirPosicao,a.exibirGerirPosicao&&r.request("GET","/quemEQuem/listar/area-colocacao-item/"+r.portalConfig.portalAPI+"/"+a.area.cdAreaColocacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),a.listarAreaPosicoes=o.data,o.data.length||(a.adicionandoPosicao=!0)):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.removerPosicao=function(e,t,i){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalConfig.portalAPI,data:{cdAreaColocacaoItem:e.cdAreaColocacaoItem}};r.request("DELETE","/quemEQuem/remover/area-colocacao-item",a,!0,function(o){o?200==o.retorno.codigo?n(function(){t.listarAreaPosicoes.splice(i,1),t.listarAreaPosicoes.length||(t.exibirGerirPosicao=!1,t.area.temFilho=!1),s.closeProgressAlert()},200):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},i.initEditarPosicao=function(o,a,e,t){o.$setPristine(),i.editarPosicao={portal:r.portalConfig.portalAPI,data:{cdAreaColocacaoItem:a?a.cdAreaColocacaoItem:null,dsAreaColocacaoItem:a?a.dsAreaColocacaoItem:null,areaColocacaoDTO:{cdAreaColocacao:e.area.cdAreaColocacao,dsAreaColocacao:e.area.dsAreaColocacao,nuOrdem:e.area.nuOrdem}}},angular.forEach(e.listarAreaPosicoes,function(o){a&&a.cdAreaColocacaoItem==o.cdAreaColocacaoItem?(o.editando=!a.editando,e.adicionandoPosicao=!1,o.editando&&n(function(){angular.element("#inputEditarPosicaoLabel_"+o.cdAreaColocacaoItem).focus()},200)):o.editando=!1}),angular.isDefined(t)&&(e.adicionandoPosicao=t)},i.formSubmitPosicaoDescricao=function(a,e){if(a.$valid){var o={portal:r.portalConfig.portalAPI,data:{cdAreaColocacaoItem:i.editarPosicao.data.cdAreaColocacaoItem?i.editarPosicao.data.cdAreaColocacaoItem:null,dsAreaColocacaoItem:i.editarPosicao.data.dsAreaColocacaoItem,areaColocacaoDTO:{cdAreaColocacao:e.area.cdAreaColocacao,dsAreaColocacao:e.area.dsAreaColocacao,nuOrdem:e.area.nuOrdem}}};r.request("POST","/quemEQuem/salvar/area-colocacao-item",o,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),e.exibirGerirPosicao=!1,e.area.temFilho=!0,i.initGerirPosicoes(e),e.adicionandoPosicao&&i.initEditarPosicao(a,null,e,!0)):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}},i.initCargoCarreira=function(){i.listarRegimeCarreira(function(o){o&&(i.listarCargoCarreira=o.data)})},i.initEditarCargoCarreira=function(o,a){o.$setPristine(),i.cargoCarreira={portal:r.portalConfig.portalAPI,data:{cdRegimeCarreira:a?a.cdRegimeCarreira:null,cargo:a?a.cargo:null,dsPortal:r.portalConfig.portalAPI,flQeq:"S",nivel:{sigla:"CEN",descricao:"CEN",detalhe:"Nivel Central",dominio:"QV_NIVEL"},nuVagas:0,posto:{sigla:"CAR",descricao:"CAR",detalhe:"Titulares de Cargos de Direcção e Chefia",dominio:"QV_POSTO"},regime:{sigla:"GER",descricao:"GER",detalhe:"Utilizador Geral",dominio:"TP_PERFIL"},subposto:null}},angular.forEach(i.listarCargoCarreira,function(o){a?(o.cdRegimeCarreira==a.cdRegimeCarreira?a.editando=!a.editando:o.editando=!1,i.exibirFormCargo=!1):o.editando=!1}),a?n(function(){angular.element("#inputEditarCargo_"+a.cdRegimeCarreira).focus()},200):i.exibirFormCargo=!i.exibirFormCargo},i.editarCargoCarreira=function(a,e){a.$valid&&r.request("POST","/quemEQuem/salvar/regime-carreira",i.cargoCarreira,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),e?e.editando=!1:(i.initEditarCargoCarreira(a),i.exibirFormCargo=!1),i.initCargoCarreira()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.removerCargoCarreira=function(e,t){s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalConfig.portalAPI,data:{cdRegimeCarreira:e.cdRegimeCarreira}};r.request("DELETE","/quemEQuem/remover/regime-carreira",a,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),n(function(){i.listarCargoCarreira.splice(t,1)},200)):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})}}]}),app.component("pesquisaView",{templateUrl:"app/partials/pesquisa.html",controller:["$timeout","$state","RequestService","AlertaService","Slug",function(a,e,t,i,n){var r=this;this.$onInit=function(o){r.init(),$(document).on("show.bs.modal","#modalPesquisar",function(){a(function(){$(".input-pesquisa").focus()},300)})},r.init=function(o){o&&o.$setPristine(),r.filterPesquisa={pesquisarTexto:null,paginacaoQtdRegistros:5,resultados:[]},r.paginaAtual=1},r.retornaLinkOrigem=function(o){var a={href:null,descricao:o.descricao?o.descricao:null};switch(o.flOrigem){case"PUBLICACAO":switch(o.noTemplate){case"TP_PUBLICACAO":a.href=e.href("sala-de-imprensa.noticias.cdPublicacao",{cdPublicacao:o.codigo,slug:n.slugify(o.titulo)},{absolute:!0});break;case"TP_ANEXO_PUBLICACAO":a.href=e.href("home",{cdPublicacao:o.codigo,slug:n.slugify(o.titulo)},{absolute:!0})}break;case"LINKS_UTEIS":a.href=o.descricao;break;case"AGENDA_EVENTO":a.href=e.href("sala-de-imprensa.eventos.evento",{cdPublicacao:o.codigo,slug:n.slugify(o.titulo)},{absolute:!0});break;case"MENU":a.href=e.href(o.state,{},{absolute:!0});try{a.descricao=e.get(o.state).ncyBreadcrumb.label}catch(o){a.descricao=a.href}break;case"PERGUNTA_FREQUENTE":a.href=e.href("perguntas-frequentes",{},{absolute:!0});break;case"QUEM_E_QUEM":a.href=e.href("ugd.quem-e-quem",{},{absolute:!0})}return a},r.submitPesquisarConteudo=function(o){o.$valid&&(r.paginaAtual=1,r.pesquisarConteudo())},r.pesquisarConteudo=function(){var o={portal:t.portalConfig.portalAPI,data:{texto:r.filterPesquisa.pesquisarTexto,paginaAtual:r.paginaAtual,qtdPaginas:r.filterPesquisa.paginacaoQtdRegistros}};t.request("POST","/pesquisar",o,!0,function(o){o?200==o.retorno.codigo?(i.closeProgressAlert(),r.filterPesquisa.resultados=o,r.pristineRequest=!1):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},r.fecharModal=function(o){$(".modal.in").modal("hide")},r.numeroDePaginas=function(){if(angular.isDefined(r.filterPesquisa.resultados)&&angular.isDefined(r.filterPesquisa.resultados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(r.filterPesquisa.resultados.quantidadeTotalItens/r.filterPesquisa.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}},r.setarPaginaAtual=function(o){r.paginaAtual=o,r.paginarRegistos(!0)},r.setarRegistosPorPagina=function(o){r.filterPesquisa.paginacaoQtdRegistros=o.paginacaoQtdRegistros,r.paginarRegistos(!0)}}]}),app.component("menuCrud",{transclude:!0,retrict:"E",templateUrl:"app/partials/menu-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$filter","$timeout","RequestService","StorageService","AlertaService","dynamicStates","UploadService",function(e,i,n,r,o,s,t,l){var c=this;e.$on("broadcastUtilizadorReceiver",function(o,a){c.initUtilizador(!0)}),this.$onInit=function(o){c.initUtilizador(),c.extensoesPermitidasImagens="jpg,jpeg,png,gif,svg",c.tamanhoFicheiroImagem=1},c.initUtilizador=function(){c.utilizador=o.get("utilizadorLogado")},c.init=function(o){o&&r.request("GET","/menu/listar/"+r.portalConfig.portalAPI,null,!0,function(o){o?(s.closeProgressAlert(),200==o.retorno.codigo&&(c.menuPrincipal=o.data.menuItemList)):s.erroRede()})},c.novoItem=function(o,a){var e=a?c.menuPrincipal[c.menuPrincipal.length-1].nuOrdem+1:o.subPaginas?o.subPaginas.length+1:1,t={displayName:"Novo Menu "+e,url:null,state:null,cdMenu:null,contentID:null,nuOrdem:e,dsMenu:null,flAtivo:"N",subPaginas:null};t.state=a?i("slugify")(t.displayName):o.state+"."+i("slugify")(t.displayName),t.url="/"+i("slugify")(t.displayName),a?o.push(t):(o.subPaginas||(o.subPaginas=[]),o.subPaginas.push(t))},c.removerItem=function(e,t,i){e.cdMenu?s.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:r.portalConfig.portalAPI,data:{cdMenu:e.cdMenu}};r.request("POST","/menu/removerMenu",a,!0,function(o){o?200==o.retorno.codigo?n(function(){s.closeProgressAlert();try{t.$parent.$parent.$parent.menuItem.subPaginas.splice(i,1)}catch(o){c.menuPrincipal.splice(i,1)}},200):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}}):n(function(){try{t.$parent.$parent.$parent.menuItem.subPaginas.splice(i,1)}catch(o){c.menuPrincipal.splice(i,1)}},200)},c.salvarMenu=function(o){if(o.$valid){var a={portal:r.portalConfig.portalAPI,data:{menu:c.menuPrincipal}};r.request("POST","/menu/salvar",a,!0,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){c.atualizarRotas(function(){e.$broadcast("broadcastHomeReceiver")})}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}},c.atualizarRotas=function(a){r.request("GET","/menu/listar/"+r.portalConfig.portalAPI,null,null,function(o){o?200==o.retorno.codigo&&(e.menu=o.data.menuItemList,e.contactos=o.data.contactos,c.menuPrincipal=o.data.menuItemList,t.fetchRoutes(o.data.menuItemList),s.closeProgressAlert(),a&&a()):s.erroRede()})},c.preUpload=function(o,a){l.preUpload(o,c.extensoesPermitidasImagens,c.tamanhoFicheiroImagem,a)},c.extensoesPermitidasMap=function(o){if(o)return l.extensoesPermitidasMap(o.split(","))},c.resetarAnexo=function(o,a){o.ficheiro=null,a.$setPristine(),a.$$attr.id&&angular.element("#"+a.$$attr.id).val(null)},c.removerUrl=function(a){s.confirmar("Excluir este Registo ?",function(o){o&&n(function(){a.logoContentID=null},100)})}}]}),app.component("publicacoesCrud",{templateUrl:"app/partials/publicacoes-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$filter","RequestService","StorageService","AlertaService","UtilizadorService","Utils",function(t,n,r,i,a,s,o,l){var c=this;t.$on("broadcastUtilizadorReceiver",function(o,a){c.initUtilizador(!0)}),this.$onInit=function(o){c.initUtilizador(!1),c.extensoesPermitidasImagens=["jpg","jpeg","png"],c.tamanhoFicheiroImagem=1,c.editorImageUpload={},c.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:300,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",image_dimensions:!1,image_description:!1,nowrap:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){n(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},100)})})},file_picker_callback:function(t,o,a){var i=angular.element("#editorImageUpload-"+r("slugify")(c.label.plural));n(function(){angular.element(i).click()},200),i.on("change",function(o){var a=o.target.files[0];a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};c.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.showMensagemRetorno(400,"Tipo do ficheiro inválido")),a.size>1048576*c.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(i.val(""),t(e.result,{title:a.name}))},e.onloadstart=function(){s.showProgressAlert()},e.onloadend=function(){s.closeProgressAlert()},e.onabort=function(){s.closeProgressAlert()}})}}},c.initUtilizador=function(o){c.utilizador=a.get("utilizadorLogado"),c.administrador=!1,c.gestor=!1,c.publicador=!1,c.redator=!1,c.revisor=!1,c.editor=!1,c.utilizador&&(c.administrador=l.validaPermissao("administrador",c.utilizador.grupos),c.gestor=l.validaPermissao("gestor",c.utilizador.grupos),c.publicador=l.validaPermissao("publicador",c.utilizador.grupos),c.redator=l.validaPermissao("redator",c.utilizador.grupos),c.revisor=l.validaPermissao("revisor",c.utilizador.grupos),c.editor=l.validaPermissao("editor",c.utilizador.grupos),o&&c.init(null,c.utilizador.gestor))},c.init=function(o,a){o&&o.$setPristine(),c.publicacaoPesquisar={portal:i.portalConfig.portalAPI,flDestaque:null,tipo:{dominio:c.template.dominio,sigla:c.template.sigla},status:null,statusTipos:{AREV:"Aguardando Revisão",CRIA:"Criada",PUB:"Publicada",REV:"Revisado",RPUB:"Reprovada Publicador",RREV:"Reprovada Revisor"},titulo:null,todos:!0,paginaAtual:1,qtdPaginas:5,paginacaoArray:[5,10,15,20],quantidadeTotalItens:0},c.itensPaginados=null,a&&c.pesquisarPublicacao(!1)},c.validaEditar=function(o){var a=!1;return"CRIA"==o&&(c.editor||c.redator||c.gestor||c.administrador)?a=!0:"RREV"==o&&(c.editor||c.redator||c.gestor||c.administrador)?a=!0:c.administrador&&(a=!0),a},c.validaVisualizar=function(o){var a=!1;return"AREV"==o&&(c.editor||c.redator||c.revisor||c.gestor||c.administrador)?a=!0:"RPUB"==o&&(c.revisor||c.gestor||c.administrador)?a=!0:"REV"==o&&(c.publicador||c.gestor||c.administrador)?a=!0:"PUB"==o&&(c.publicador||c.editor||c.redator||c.revisor||c.gestor||c.administrador)?a=!0:"CRIA"==o&&(c.revisor||c.publicador||c.gestor||c.administrador)?a=!0:"RREV"==o&&(c.revisor||c.publicador||c.gestor||c.administrador)?a=!0:"REV"==o&&(c.revisor||c.publicador||c.gestor||c.administrador)&&(a=!0),a},c.formPublicacaoPesquisarSubmit=function(o){o.$valid&&(c.publicacaoPesquisar.paginaAtual=1,n(function(){c.pesquisarPublicacao()}))},c.pesquisarPublicacao=function(){c.publicacaoPesquisar.quantidadeTotalItens=0,i.request("POST","/publicacao/listar/",c.publicacaoPesquisar,!1,function(o){o?200==o.retorno.codigo?(c.itensPaginados=o,c.publicacaoPesquisar.quantidadeTotalItens=c.itensPaginados.quantidadeTotalItens,s.closeProgressAlert()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},c.setObj=function(o){o&&o.$setPristine(),c.dataJson={portal:i.portalConfig.portalAPI,data:{cdPublicacao:null,descricao:null,dtFim:null,dtInicio:null,flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:{cdTemplatePublicacao:null,dsTemplate:null,flAtivo:null,noTemplate:null,token:null,cgRefCodes:{sigla:c.template.sigla,descricao:null,detalhe:null,dominio:c.template.dominio},publicacaoList:null,anexoPortalList:null},dsPortal:i.portalConfig.portalAPI,flDestaque:null,autor:null,dtCriacao:null,observacao:null,idAnexo:null,idImagem:null,filePath:null,urlImagemContent:null}}},c.salvarNoticia=function(o){o.$valid&&o.$submitted&&(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo&&(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.substr(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.indexOf(",")+1).replace(/ /g,"")),c.dataJson.data.dtInicio=moment(c.dataJson.data.dtInicio,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),c.dataJson.data.dtFim=moment(c.dataJson.data.dtFim,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),c.dataJson.portal=i.portalConfig.portalAPI,i.request("POST","/publicacao/salvar",c.dataJson,!0,function(o){o?200==o.retorno.codigo?s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){c.pesquisarPublicacao(),n(function(){c.dataJson={data:o.data},c.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),c.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")},1e3),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))},c.excluirAnexo=function(){c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},c.editar=function(o,a){a&&a.$setPristine(),i.request("GET","/noticia/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),c.dataJson={data:o.data},c.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),c.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},c.excluir=function(a,o){s.confirmar("Excluir este Registo ?",function(o){o&&i.request("DELETE","/publicacao/remover/"+a.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(c.pesquisarPublicacao(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})})},c.visualizar=function(o){c.noticiaVisualizada=null,i.request("GET","/publicacao/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),c.noticiaVisualizada=o.data,c.noticiaVisualizada.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),c.noticiaVisualizada.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},c.selecionaMotivoNoticia=function(o,a,e){c.noticiaSelecionada=angular.copy(o),e.$setPristine(),c.noticiaSelecionada.observacao=null,c.motivoStatusSelecionado=a,l.mantemModal("#modalGerir"+r("slugify")(c.label.plural),!1),n(function(){l.mantemModal("#modalGerir"+r("slugify")(c.label.plural)+"Observacao",!0)},600)},c.limparMotivo=function(){c.noticiaSelecionada=null,c.motivoStatusSelecionado=null},c.salvarMotivo=function(o){o.$valid&&o.$submitted&&c.alterarStatusNoticia(c.noticiaSelecionada,c.motivoStatusSelecionado)},c.alterarStatusNoticia=function(a,e){s.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(c.dataJson={data:angular.copy(a)},c.dataJson.data.flStatusPublicacao.sigla=e,c.dataJson.data.flStatusPublicacao.descricao=e,c.dataJson.data.flStatusPublicacao.detalhe=null,c.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",c.noticiaSelecionada||(c.dataJson.data.observacao=null),c.dataJson.portal=i.portalConfig.portalAPI,i.request("POST","/publicacao/atualizar-situacao",c.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){c.pesquisarPublicacao(),n(function(){c.dataJson={data:o.data},c.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),c.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY"),c.noticiaSelecionada&&(c.noticiaSelecionada=null,c.motivoStatusSelecionado=null,l.mantemModal("#modalGerir"+r("slugify")(c.label.plural)+"Observacao",!1),n(function(){l.mantemModal("#modalGerir"+r("slugify")(c.label.plural),!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}))})}}]}),app.component("paginacao",{templateUrl:"app/partials/paginacao.html",bindings:{itensPorPagina:"=",paginaAtual:"=",itens:"=",totalRegistros:"<",funcao:"&"},controller:["$timeout",function(o){var n=this;this.$onInit=function(o){n.PAGINACAO_gap=5},this.$onChanges=function(o){o.totalRegistros.currentValue&&(n.totalRegistros=o.totalRegistros.currentValue,n.PAGINACAO_groupToPages())},n.PAGINACAO_groupToPages=function(){n.PAGINACAO_pagedItems=[];for(var o=0;o<n.totalRegistros;o++)o%n.itensPorPagina==0?n.PAGINACAO_pagedItems[Math.floor(o/n.itensPorPagina)]=[n.itens[o]]:n.PAGINACAO_pagedItems[Math.floor(o/n.itensPorPagina)].push(n.itens[o])},n.PAGINACAO_range=function(o,a,e){var t=[];o<e&&(a=(e=o)<=n.PAGINACAO_gap?1:o-n.PAGINACAO_gap);for(var i=a;i<=e;i++)t.push(i);return t},n.PAGINACAO_prevPage=function(){2<n.paginaAtual&&(n.paginaAtual--,n.chamarFuncao())},n.PAGINACAO_nextPage=function(){n.paginaAtual<n.PAGINACAO_pagedItems.length&&(n.paginaAtual++,n.chamarFuncao())},n.PAGINACAO_firstPage=function(){n.paginaAtual=1,n.chamarFuncao()},n.PAGINACAO_lastPage=function(){n.paginaAtual=n.PAGINACAO_pagedItems.length,n.chamarFuncao()},n.PAGINACAO_setPage=function(o){n.paginaAtual=o,n.chamarFuncao()},n.chamarFuncao=function(){o(function(){n.funcao()})},n.retornaDivisao=function(o,a){if(angular.isDefined(o)&&angular.isDefined(a))return Math.ceil(o/a)}}]}),function(o,a,e,t,i,n){(t=o.gapi||(o.gapi={})).analytics={q:[],ready:function(o){this.q.push(o)}},i=a.createElement("script"),n=a.getElementsByTagName("script")[0],i.src="https://apis.google.com/js/platform.js",n.parentNode.insertBefore(i,n),i.onload=function(){t.load("analytics")}}(window,document),app.component("analytics",{templateUrl:"app/partials/analytics.html",bindings:{uidportal:"<",trackerid:"<"},controller:["$rootScope","$scope","RequestService","$window","$timeout","UtilizadorService","AlertaService",function(o,s,a,e,t,i,n){var r=this;s.uidportal=null,s.tokenAcessoAnalytics=null,s.filter={dtInicial:null,dtFinal:null},s.getTokenAnalytics=function(){a.request("GET","/analytics/token",null,!1,function(o){o?200==o.retorno.codigo?o.data&&(n.closeProgressAlert(),s.tokenAcessoAnalytics=o.data,t(function(){s.callGoogleAnalytics()},1e3)):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},s.getReportAnalytics=function(o){o.$valid&&o.$submitted&&s.callGoogleAnalytics()},s.callGoogleAnalytics=function(){gapi.analytics.ready(function(){var o=moment(s.filter.dtInicial,"DD/MM/YYYY").format("YYYY-MM-DD"),a=moment(s.filter.dtFinal,"DD/MM/YYYY").format("YYYY-MM-DD"),e=s.uidportal,t=s.tokenAcessoAnalytics;function i(o){return("0"+o).slice(-2)}gapi.analytics.auth.authorize({serverAuth:{access_token:t}}),gapi.analytics.auth.on("error",function(o){$("#infolabelC").css("display","block")}),gapi.analytics.auth.on("success",function(o){$("#infolabelC").css("display","none"),$(".painelAnalytics").css("opacity","1"),gapi.analytics.auth.authorize({serverAuth:{access_token:o.access_token}})}),gapi.analytics.auth.isAuthorized()?$("#painelAnalytics").css("opacity","1"):$(".painelAnalytics").css("opacity","0.4"),new gapi.analytics.report.Data({query:{ids:e,dimensions:"ga:country",metrics:"ga:sessions","start-date":o,"end-date":a,output:"dataTable"}}).on("success",function(o){$("#info_1").html(o.totalsForAllResults["ga:sessions"])}).execute(),new gapi.analytics.report.Data({query:{ids:e,metrics:"ga:users",dimensions:"ga:country","start-date":o,"end-date":a,output:"dataTable"}}).on("success",function(o){$("#info_2").html(o.totalsForAllResults["ga:users"])}).execute(),new gapi.analytics.report.Data({query:{ids:e,metrics:"ga:avgSessionDuration",dimensions:"ga:country","start-date":o,"end-date":a,output:"dataTable"}}).on("success",function(o){var a=function(o){var a=Math.floor(o/60);o%=60;var e=Math.floor(a/60);return a%=60,i(e)+":"+i(a)+":"+i(o)}(Math.floor(o.totalsForAllResults["ga:avgSessionDuration"]));$("#info_3").html(a)}).execute(),new gapi.analytics.report.Data({query:{ids:e,metrics:"ga:newUsers",dimensions:"ga:country","start-date":o,"end-date":a,output:"dataTable"}}).on("success",function(o){$("#info_4").html(o.totalsForAllResults["ga:newUsers"])}).execute(),$("#title_grafico_1").html("Quantidade de visualização de páginas:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:e,dimensions:"ga:date",metrics:"ga:pageviews","start-date":o,"end-date":a},chart:{type:"LINE",container:"grafico_1",options:{width:"auto"}}}).execute();$("#title_grafico_2").html("Acessos por páginas:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:e,dimensions:"ga:country",metrics:"ga:sessions,ga:users","start-date":o,"end-date":a},chart:{type:"GEO",container:"grafico_2",options:{width:"100%"}}}).execute();$("#title_grafico_7").html("Dispositivos móveis:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:e,dimensions:"ga:mobileDeviceBranding",metrics:"ga:sessions","start-date":o,"end-date":a,sort:"-ga:sessions","max-results":"5"},chart:{type:"PIE",container:"grafico_7",options:{width:"100%"}}}).execute();$("#title_grafico_8").html("Acessos por páginas:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:e,dimensions:"ga:country",metrics:"ga:sessions,ga:users","start-date":o,"end-date":a,sort:"-ga:sessions","max-results":"8"},chart:{type:"TABLE",container:"grafico_8",options:{width:"100%"}}}).execute();$("#title_grafico_3_4").html("Quantidade de acessos por navegador:");var n=new gapi.analytics.googleCharts.DataChart({query:{ids:e,dimensions:"ga:browser",metrics:"ga:sessions",sort:"-ga:sessions","max-results":"6"},chart:{type:"PIE",container:"grafico_3",options:{width:"100%"}}}),r=new gapi.analytics.googleCharts.DataChart({query:{ids:e,dimensions:"ga:date",metrics:"ga:sessions","start-date":o,"end-date":a,filters:"ga:browser==Internet Explorer"},chart:{type:"LINE",container:"grafico_4",options:{title:"Internet Explorer",width:"100%"}}});$("#title_grafico_5").html("Visualizações de página:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews","start-date":o,"end-date":a,sort:"-ga:pageviews","max-results":"8"},chart:{type:"TABLE",container:"grafico_5",options:{width:"100%"}}}).execute();$("#title_grafico_6").html("Média de páginas visitadas em cada sessão:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:e,dimensions:"ga:date",metrics:"ga:pageviewsPerSession","start-date":o,"end-date":a},chart:{type:"COLUMN",container:"grafico_6",options:{width:"100%"}}}).execute();n.execute(),n.on("success",function(o){var i=o.chart,n=o.dataTable;google.visualization.events.addListener(i,"select",function(o){if(i.getSelection().length){var a=i.getSelection()[0].row,e=n.getValue(a,0),t={query:{filters:"ga:browser=="+e},chart:{options:{title:e}}};r.set(t).execute()}}),r.execute()})})},this.$onInit=function(o){s.getTokenAnalytics(),s.filter.dtInicial=moment().subtract(1,"months").format("DD/MM/YYYY"),s.filter.dtFinal=moment().format("DD/MM/YYYY"),s.uidportal=r.uidportal}}]}),app.component("glossarioCrud",{templateUrl:"app/partials/glossario-crud.html",bindings:{label:"<"},controller:["$rootScope","$timeout","RequestService","StorageService","AlertaService",function(t,o,i,a,n){var r=this;t.$on("broadcastUtilizadorReceiver",function(o,a){r.initUtilizador(!1)}),this.$onInit=function(o){r.initUtilizador(),r.extensoesPermitidasImagens=["jpg","jpeg","png"],r.tamanhoFicheiroImagem=1,r.editorImageUpload={},r.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:200,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",nowrap:!1},r.exibirFormAreaColocacao=!1},r.initUtilizador=function(o){r.utilizador=a.get("utilizadorLogado"),o&&r.paginarRegistos(!1)},r.init=function(o){r.registos=[],r.filter=null,o&&r.paginarRegistos(!0)},r.paginarRegistos=function(a){a=a||!1,i.request("GET","/glossario/listar/"+i.portalConfig.portalAPI,null,a,function(o){o?(n.closeProgressAlert(),200==o.retorno.codigo&&(a&&n.closeProgressAlert(),r.registos=o.data,r.indices=angular.copy(r.registos),r.filter&&r.indices[r.filter]||(r.filter=Object.keys(r.registos)[0]))):n.erroRede()})},r.salvarGlossario=function(o,a){o.$valid&&i.request("POST","/glossario/salvar",r.dataJson,a,function(o){o?200==o.retorno.codigo?a?n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){r.registo(null,o.data),r.paginarRegistos(!1),t.$broadcast("broadcastHomeReceiver")}):r.paginarRegistos(!1):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},r.registo=function(o,a){o&&o.$setPristine(),r.dataJson={portal:i.portalConfig.portalAPI},r.dataJson.data=a?angular.copy(a):{cdGlossario:null,tituloGlossario:null,dsGlossario:null}},r.remover=function(e){n.confirmar("Excluir este Registo ?",function(o){if(o){var a={portal:i.portalConfig.portalAPI,data:{cdGlossario:e.cdGlossario}};i.request("DELETE","/glossario/remover",a,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})}})}}]}),app.component("saude",{templateUrl:"app/partials/saude.html"}),app.component("saude1",{templateUrl:"app/partials/(2).html"}),app.component("educacao",{templateUrl:"app/partials/agricultura.html"}),app.component("gerirUtilizadores",{templateUrl:"app/partials/gerir-utilizadores.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$scope","RequestService","StorageService","AlertaService","UtilizadorService","Utils",function(o,a,t,e,i,n,r,s){var l=this;t.pr={closed:!1},o.$on("broadcastUtilizadorReceiver",function(o,a){l.initUtilizador(!0)}),this.$onInit=function(o){l.initUtilizador(!1)},l.initUtilizador=function(o){l.utilizador=i.get("utilizadorLogado"),l.administrador=!1,l.gestor=!1,l.publicador=!1,l.redator=!1,l.revisor=!1,l.editor=!1,l.utilizador&&(l.administrador=s.validaPermissao("administrador",l.utilizador.grupos),l.gestor=s.validaPermissao("gestor",l.utilizador.grupos),l.publicador=s.validaPermissao("publicador",l.utilizador.grupos),l.redator=s.validaPermissao("redator",l.utilizador.grupos),l.revisor=s.validaPermissao("revisor",l.utilizador.grupos),l.editor=s.validaPermissao("editor",l.utilizador.grupos),o&&l.init(null,l.utilizador.gestor))},l.init=function(o,a){o&&o.$setPristine(),l.publicacaoPesquisar={portal:e.portalConfig.portalAPI,data:{noGapUtilizador:null,paginaAtual:1,qtdPaginas:10,flAtivo:null,paginacaoArray:[5,10,15,20],quantidadeTotalItens:0}},l.itensPaginados=null,a&&l.pesquisarUtilizadores(!1),l.pefisList=[],e.request("GET","/gestao-utilizador/perfis?portal="+e.portalConfig.portalAPI,!1,!0,function(o){o?200==o.retorno.codigo?t.perfis=o.data:n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},t.GetValue=function(){t.perfisList=[];for(var o=0;o<t.perfis.length;o++)if(t.perfis[o].Selected){var a=t.perfis[o].noGapPerfil;t.perfisList.push(a)}return t.perfisList},t.GetValueUnchecked=function(e){t.perfisCadastrado.forEach(function(o){if(e==o){var a=t.perfisCadastrado.indexOf(o);t.perfisCadastrado.splice(a,1)}else t.GetValue()})},l.formPublicacaoPesquisarSubmit=function(o){o.$valid&&(l.publicacaoPesquisar.paginaAtual=1,a(function(){l.pesquisarUtilizadores()}))},l.alterarStatusUser=function(o){"S"==o.flAtivo?e.request("GET","/gestao-utilizador/inativar/"+e.portalConfig.portalAPI+"/"+o.userName,null,!0,function(o){o?200==o.retorno.codigo?(n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),l.pesquisarUtilizadores()):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()}):e.request("GET","/gestao-utilizador/ativar/"+e.portalConfig.portalAPI+"/"+o.userName,null,!0,function(o){o?200==o.retorno.codigo?(n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),l.pesquisarUtilizadores()):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},l.pesquisarUtilizadores=function(){l.publicacaoPesquisar.quantidadeTotalItens=0,e.request("POST","/gestao-utilizador/utilizadores",l.publicacaoPesquisar,!1,function(o){o?200==o.retorno.codigo?(l.itensPaginados=o,l.publicacaoPesquisar.quantidadeTotalItens=l.itensPaginados.quantidadeTotalItens,n.closeProgressAlert()):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},l.setObj=function(o){o&&o.$setPristine(),l.dataJson={portal:e.portalConfig.portalAPI,data:{email:null,noGapUtilizador:null,perfis:null}},e.request("GET","/gestao-utilizador/perfis?portal="+e.portalConfig.portalAPI,!1,!0,function(o){o?200==o.retorno.codigo?(n.closeProgressAlert(),t.perfis=o.data):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},l.dataJson={portal:e.portalConfig.portalAPI,data:{email:null,noGapUtilizador:null,perfis:null}},l.salvarUtilizador=function(o){t.GetValue().forEach(function(o){t.perfisCadastrado.push(o)}),l.dataJson.data.perfis=t.GetValue(),o.$valid&&o.$submitted&&(l.dataJson.data.cdGapUtilizador?(t.GetValue().forEach(function(o){t.perfisCadastrado.push(o)}),l.dataJsonUpdateUser={portal:e.portalConfig.portalAPI,data:{cdGapUtilizador:l.dataJson.data.cdGapUtilizador,noGapUtilizador:l.dataJson.data.noGapUtilizador,perfis:t.perfisCadastrado}},e.request("POST","/gestao-utilizador/atualizar",l.dataJsonUpdateUser,!0,function(o){o?200==o.retorno.codigo?n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){}):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})):e.request("POST","/gestao-utilizador/novo",l.dataJson,!0,function(o){o?200==o.retorno.codigo?n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){}):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()}))},t.perfisCadastrado=[],l.editar=function(a,o){o&&o.$setPristine(),e.request("GET","/gestao-utilizador/utilizadores?cdGapUtilizador="+a.cdGapUtilizador,null,!0,function(o){o?200==o.retorno.codigo?(n.closeProgressAlert(),l.dataJson={data:o.data},a.perfis=l.dataJson.data.perfis,a.perfis.forEach(function(o){t.perfisCadastrado.push(o)})):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},l.dataJsonUser={portal:e.portalConfig.portalAPI,data:{userName:null}},l.redefinirSenha=function(o){n.confirmar("Deseja Redefinir palavra-passe deste Utilizador ?",function(o){o&&e.request("POST","/gestao-utilizador/resetasenha",l.dataJsonUser,!0,function(o){o?200==o.retorno.codigo?n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})})}}]}),app.controller("homeController",["$rootScope","$scope","$location","$timeout","$state","RequestService","AlertaService","ngMeta",function(o,r,a,e,t,s,l,i){o.$on("broadcastHomeReceiver",function(o,a){"home"==t.current.name&&e(function(){r.init()},1e3)}),r.type1=1,r.type2=0,r.type3=0,r.dadosM="Saurimo",i.setTag("image",window.location.origin+"/app/main/img/recredit/logoRecredit.png"),i.setTag("description","Temos como objecto social principal a aquisição, reestruturação e revitalização de activos, nomeadamente, os creditícios, ou seja, recuperar os créditos concedidos e, acessoriamente, a gestão com vista à sua alienação, de participações financeiras e de patrimónios."),i.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),r.init=function(){var o={portal:s.portalConfig.portalAPI,flDestaque:"S",tipo:{dominio:"TP_PUBLICACAO",sigla:"NOT"},status:"PUB",titulo:null,todos:!0,paginaAtual:1,qtdPaginas:16};s.request("POST","/publicacao/listarPublico",o,null,function(o){o&&200==o.retorno.codigo&&(r.noticiasRecentes=o.data)});var a={portal:s.portalConfig.portalAPI,flDestaque:"S",tipo:{dominio:"TP_PUBLICACAO",sigla:"PUB"},status:"PUB",titulo:null,todos:!0,paginaAtual:1,qtdPaginas:16},e={portal:s.portalConfig.portalAPI,flDestaque:"N",tipo:{dominio:"TP_PUBLICACAO",sigla:"PUB"},status:"PUB",titulo:null,todos:!0,paginaAtual:1,qtdPaginas:16};s.request("POST","/publicacao/listarPublico",a,null,function(o){o&&200==o.retorno.codigo&&(r.noticiasDivulgacao=o.data)}),s.request("POST","/publicacao/listarPublico",e,null,function(o){o&&200==o.retorno.codigo&&(r.noticiasDivulgacaoN=o.data)}),r.click1=function(){r.type1=1,r.type2=0,r.type3=0},r.click2=function(){r.type2=1,r.type3=0,r.type1=0},r.click3=function(){r.type3=1,r.type2=0,r.type1=0};s.request("POST","/formulario/listar",{portal:"SETIC",data:{paginaAtual:1,itensPorPagina:5,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:"FORM",descricao:"FORM",detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}},null,function(o){o?200==o.retorno.codigo&&(r.boletins=o.data,angular.forEach(r.boletins,function(o,a){angular.forEach(o.anexoPortalList,function(o,a){var e=[];angular.forEach(o.anexoPortalItemList,function(o,a){0<=o.nome.indexOf("_CAPA_")?e[1]=o:e[0]=o}),o.anexoPortalItemList=e})})):l.erroRede()}),s.request("GET","/noticia/listar/"+s.portalConfig.portalAPI+"/N/1/6",null,null,function(o){o&&200==o.retorno.codigo&&(r.artigos=o.data)}),s.request("GET","/linksUteis/listar/"+s.portalAPI+"/LK/S/1/100",null,null,function(o){o&&200==o.retorno.codigo&&(r.linksUteis=o.data.filter(function(o){if(o.flStatusPublicacao)return"PUB"===o.flStatusPublicacao.sigla?o:null}))}),s.request("GET","/linksUteis/listar/"+s.portalAPI+"/BAN/S/1/100",null,null,function(o){o&&200==o.retorno.codigo&&(r.ratingCredito=o.data)}),s.request("GET","/linksUteis/listar/"+s.portalAPI+"/IMGALT/S/1/100",null,null,function(o){o&&200==o.retorno.codigo&&(r.portalARCLinks=o.data)}),s.request("GET","/evento/listar/"+s.portalAPI+"/S/1/4",null,null,function(o){o&&200==o.retorno.codigo&&(r.proximosEventos=o.data)});var t={portal:s.portalAPI,data:{tpPergunta:{sigla:"ANY",descricao:"ANY",detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}};s.request("POST","/perguntasFrequentes/listar",t,null,function(o){o&&200==o.retorno.codigo&&(r.perguntasFrequentes=o.data)});var i={portal:s.portalAPI,data:{paginaAtual:1,itensPorPagina:6,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:"GUIA",descricao:"GUIA",detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};r.guias=[],s.request("POST","/formulario/listar",i,null,function(o){o?200==o.retorno.codigo&&(r.guias=o.data,angular.forEach(r.guias,function(o,a){angular.forEach(o.anexoPortalList,function(o,a){var e=[];angular.forEach(o.anexoPortalItemList,function(o,a){0<=o.nome.indexOf("_CAPA_")?e[1]=o:e[0]=o}),o.anexoPortalItemList=e})})):l.erroRede()});var n={portal:s.portalConfig.portalAPI,data:{flDestaque:"N"}};s.request("POST","/noticia/galeria/listar/",n,!1,function(o){o?200==o.retorno.codigo?(r.itensPaginados=o.data,l.closeProgressAlert()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}}]),app.controller("imoveisController",["$rootScope","$scope","$location","$timeout","$state","$stateParams","RequestService",function(o,g,p,e,t,a,f){o.$on("broadcastHomeReceiver",function(o,a){"imoveis"==t.current.name&&e(function(){g.init()},1e3)}),g.dadosForm={tipologias:null,tipoEmpreendimento:null,provincia:null,municipio:null,statusProp:null},g.dadosFormBusAva={statusProp:null,tipoEmpreendimento:null,tipologia:null,provincia:null,municipio:null,vlMinimo:null,vlMaximo:null,casaDeBanho:null,cozinha:null,dispensa:null,espacoGormete:null,garagem:null,lavanderia:null,quartoSuite:null,quarto:null,sala:null,salaJantar:null,varanda:null,zonaServico:null},g.formIdImovel={id:null},g.init=function(){g.dadosForm=angular.copy(g.dadosForm),g.formBusAva=angular.copy(g.dadosFormBusAva),g.mensagem="IMÓVEIS EM DESTAQUE",g.msgImov="",g.statusProp=[{id:"VIMOV",nome:"Comprar"},{id:"AIMOV",nome:"Arrendar"}],g.currentPage=0,g.controlo=1,g.pageSize=9,g.totalPages=0,"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.carregarImoveis=function(){f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni="+g.currentPage+"&pagTam="+g.pageSize,function(o){o&&200==o.status&&(g.imoveis=o.data,g.totalPages=Math.trunc(g.imoveis.numLines/g.pageSize)+(g.imoveis.numLines%g.pageSize==0?0:1))})}:g.carregarImoveis=function(){f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni="+g.currentPage+"&pagTam="+g.pageSize,function(o){o&&200==o.status&&(g.imoveis=o.data,g.totalPages=Math.trunc(g.imoveis.numLines/g.pageSize)+(g.imoveis.numLines%g.pageSize==0?0:1))})},g.navigateFirstPage=function(){g.controlo=1,g.currentPage=0,g.carregarImoveis()},g.navigatePreviousPage=function(){g.currentPage-=9,g.controlo--,g.carregarImoveis()},g.navigateNextPage=function(){g.currentPage+=9,g.controlo++,g.carregarImoveis()},g.navigateLastPage=function(){g.currentPage=g.pageSize*(g.totalPages-1),g.controlo=g.totalPages,g.carregarImoveis()},g.lstTipologias(),g.detalheDoImovel(localStorage.getItem("imv")),g.voltarListarImoveis(),g.lstEspacos(),g.lstImoveisBuscaAvan()},g.lstImoveisBuscaAvan=function(){localStorage.getItem("buscaAvancada")&&(g.recuperarDados=localStorage.getItem("buscaAvancada"),g.busca=JSON.parse(g.recuperarDados),g.mensagemBs="s",localStorage.removeItem("buscaAvancada"))},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.lstEspacos=function(){f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/lstEspacos?nuDocumento=5417453501",function(o){o&&200==o.status&&(g.casaDeBanho=[],g.quarto=[],g.garagem=[],g.quartoSuite=[],g.zonaServico=[],g.varanda=[],g.listarEspacos=o.data.lines,g.dadosEspacos=g.listarEspacos.map(function(o){return{nome:o.noEspaco,idImovEspaco:o.idImovEspaco}}),g.casBan=g.dadosEspacos.filter(function(o){return filtrar="Casa de banho"==o.nome}),g.casaDeBanho.push({opcao:[{opt:"1",dados:g.casBan},{opt:"2",dados:g.casBan},{opt:"3",dados:g.casBan},{opt:"4",dados:g.casBan}]}),g.qua=g.dadosEspacos.filter(function(o){return filtrar="Quarto"==o.nome}),g.quarto.push({opcao:[{opt:"1",dados:g.qua},{opt:"2",dados:g.qua},{opt:"3",dados:g.qua},{opt:"4",dados:g.qua},{opt:"5",dados:g.qua}]}),g.gar=g.dadosEspacos.filter(function(o){return filtrar="Garagem"==o.nome}),g.garagem.push({opcao:[{opt:"1",dados:g.gar},{opt:"2",dados:g.gar},{opt:"3",dados:g.gar},{opt:"4",dados:g.gar},{opt:"5",dados:g.gar}]}),g.quaSui=g.dadosEspacos.filter(function(o){return filtrar="Quarto suíte"==o.nome}),g.quartoSuite.push({opcao:[{opt:"1",dados:g.quaSui},{opt:"2",dados:g.quaSui},{opt:"3",dados:g.quaSui},{opt:"4",dados:g.quaSui},{opt:"5",dados:g.quaSui}]}),g.vara=g.dadosEspacos.filter(function(o){return filtrar="Varanda"==o.nome}),g.varanda.push({opcao:[{opt:"1",estado:"Sim",dados:g.vara},{opt:"0",estado:"Não",dados:g.vara}]}),g.zonSer=g.dadosEspacos.filter(function(o){return filtrar="Zona de serviço"==o.nome}),g.zonaServico.push({opcao:[{opt:"1",estado:"Sim",dados:g.zonSer},{opt:"0",estado:"Não",dados:g.zonSer}]}))})}:g.lstEspacos=function(){f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/lstEspacos?nuDocumento=5417453501",function(o){o&&200==o.status&&(g.casaDeBanho=[],g.quarto=[],g.garagem=[],g.quartoSuite=[],g.zonaServico=[],g.varanda=[],g.listarEspacos=o.data.lines,g.dadosEspacos=g.listarEspacos.map(function(o){return{nome:o.noEspaco,idImovEspaco:o.idImovEspaco}}),g.casBan=g.dadosEspacos.filter(function(o){return filtrar="Casa de banho"==o.nome}),g.casaDeBanho.push({opcao:[{opt:"1",dados:g.casBan},{opt:"2",dados:g.casBan},{opt:"3",dados:g.casBan},{opt:"4",dados:g.casBan}]}),g.qua=g.dadosEspacos.filter(function(o){return filtrar="Quarto"==o.nome}),g.quarto.push({opcao:[{opt:"1",dados:g.qua},{opt:"2",dados:g.qua},{opt:"3",dados:g.qua},{opt:"4",dados:g.qua},{opt:"5",dados:g.qua}]}),g.gar=g.dadosEspacos.filter(function(o){return filtrar="Garagem"==o.nome}),g.garagem.push({opcao:[{opt:"1",dados:g.gar},{opt:"2",dados:g.gar},{opt:"3",dados:g.gar},{opt:"4",dados:g.gar},{opt:"5",dados:g.gar}]}),g.quaSui=g.dadosEspacos.filter(function(o){return filtrar="Quarto suíte"==o.nome}),g.quartoSuite.push({opcao:[{opt:"1",dados:g.quaSui},{opt:"2",dados:g.quaSui},{opt:"3",dados:g.quaSui},{opt:"4",dados:g.quaSui},{opt:"5",dados:g.quaSui}]}),g.vara=g.dadosEspacos.filter(function(o){return filtrar="Varanda"==o.nome}),g.varanda.push({opcao:[{opt:"1",estado:"Sim",dados:g.vara},{opt:"0",estado:"Não",dados:g.vara}]}),g.zonSer=g.dadosEspacos.filter(function(o){return filtrar="Zona de serviço"==o.nome}),g.zonaServico.push({opcao:[{opt:"1",estado:"Sim",dados:g.zonSer},{opt:"0",estado:"Não",dados:g.zonSer}]}))})},g.comparar=function(o,a){return o.tpImovTipologia.codigo<a.tpImovTipologia.codigo?-1:o.tpImovTipologia.codigo>a.tpImovTipologia.codigo?1:0},g.ordenarTipoEmp=function(o,a){return o.tpImovEmpreendimento.descricao<a.tpImovEmpreendimento.descricao?-1:o.tpImovEmpreendimento.descricao>a.tpImovEmpreendimento.descricao?1:0},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.lstTipologias=function(){f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/lstTpEmpreendimentos?nuDocumento=5417453501",function(o){o&&200==o.status&&(g.lstTpEmpreendimento=o.data.lines,g.lstTpEmpreendimento.sort(g.ordenarTipoEmp),g.lstTpEmpreendimentos=g.lstTpEmpreendimento.filter(function(o){return"Condomínio"!=o.tpImovEmpreendimento.descricao}))}),f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/lstTipologias?nuDocumento=5417453501&flSimplificado=S",function(o){o&&200==o.status&&(g.listarTipologias=o.data.lines,g.listarTipologias.sort(g.comparar))}),f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/getLstLocalidade?idPais=1",function(o){o&&200==o.status&&(g.lstProvincias=o.data.lines)}),f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/getMinMaxTipologia?nuDocumento=5417453501",function(o){o&&200==o.status&&(g.vlMin=o.data.vlMinTipologia,g.vlMax=o.data.vlMaxTipologia,g.formBusAva.vlMinimo=g.vlMin,g.formBusAva.vlMaximo=g.vlMin)})}:g.lstTipologias=function(){f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/lstTpEmpreendimentos?nuDocumento=5417453501",function(o){o&&200==o.status&&(g.lstTpEmpreendimento=o.data.lines,g.lstTpEmpreendimento.sort(g.ordenarTipoEmp),g.lstTpEmpreendimentos=g.lstTpEmpreendimento.filter(function(o){return"Condomínio"!=o.tpImovEmpreendimento.descricao}))}),f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/lstTipologias?nuDocumento=5417453501&flSimplificado=S",function(o){o&&200==o.status&&(g.listarTipologias=o.data.lines,g.listarTipologias.sort(g.comparar))}),f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/getLstLocalidade?idPais=1",function(o){o&&200==o.status&&(g.lstProvincias=o.data.lines)}),f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/getMinMaxTipologia?nuDocumento=5417453501",function(o){o&&200==o.status&&(g.vlMin=o.data.vlMinTipologia,g.vlMax=o.data.vlMaxTipologia,g.formBusAva.vlMinimo=g.vlMin,g.formBusAva.vlMaximo=g.vlMin)})},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.idProvincia=function(){f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/getLstLocalidade?idLocalidadePai="+g.dadosForm.provincia.codigo,function(o){200==o.status&&o.data.lines&&(g.municipios=o.data.lines,g.disabledMun=1)})}:g.idProvincia=function(){f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/getLstLocalidade?idLocalidadePai="+g.dadosForm.provincia.codigo,function(o){200==o.status&&o.data.lines&&(g.municipios=o.data.lines,g.disabledMun=1)})},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.idProvinciaPag=function(){f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/getLstLocalidade?idLocalidadePai="+g.formBusAva.provincia.codigo,function(o){200==o.status&&o.data.lines&&(g.lstmunicipios=o.data.lines,g.disabledMuni=1)})}:g.idProvinciaPag=function(){f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/getLstLocalidade?idLocalidadePai="+g.formBusAva.provincia.codigo,function(o){200==o.status&&o.data.lines&&(g.lstmunicipios=o.data.lines,g.disabledMuni=1)})},g.voltarListarImoveis=function(){g.mensagem="IMÓVEIS EM DESTAQUE",g.carregarImoveis()},g.pesquisarImovelId=function(o){g.detalheDoImovel(o.id)},g.limitText=255,g.descricaoImovel=0,g.mostrarMais=function(){g.limitText=g.descricaoImovel.length},g.mostrarMenos=function(){g.limitText=255},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.detalheDoImovel=function(o){localStorage.setItem("imv",o),f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/getImovelByPk?nuDocumento=5417453501&idImovImovel="+localStorage.getItem("imv"),function(o){o&&(o.data.message?o.data.message&&(g.mensagemDoImovel="NÃO FOI ENCONTRADO NENHUM IMÓVEL",g.formIdImovel={}):(g.detalheImovel=o.data,g.descricaoImovel=o.data.planoPgto.lines[0].dsObservacao,g.pegarTipologia=g.detalheImovel.tipologia.tpImovTipologia.codigo,f.requestApiImoveis("GET","https://www32.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni=0&pagTam=9&tpImovTipologia="+g.pegarTipologia,function(o){o&&(g.listarPropSemelhante=o.data,g.mensagemDoImovel="")}),g.formIdImovel={}))})}:g.detalheDoImovel=function(o){localStorage.setItem("imv",o),f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/getImovelByPk?nuDocumento=5417453501&idImovImovel="+localStorage.getItem("imv"),function(o){o&&(o.data.message?o.data.message&&(g.mensagemDoImovel="NÃO FOI ENCONTRADO NENHUM IMÓVEL",g.formIdImovel={}):(g.detalheImovel=o.data,g.pegarTipologia=g.detalheImovel.tipologia.tpImovTipologia.codigo,f.requestApiImoveis("GET","https://www2.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni=0&pagTam=9&tpImovTipologia="+g.pegarTipologia,function(o){o&&(g.listarPropSemelhante=o.data,g.mensagemDoImovel="")}),g.formIdImovel={}))})},g.tipoImovel=function(o){g.disabled=o.tpImovEmpreendimento.descricao},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.buscaAvancada=function(o){if(o.$submitted&&o.$valid){var a="https://www32.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni=0&pagTam=50";if(null!=g.formBusAva.tipoEmpreendimento)a+="&tpImovEmpreendimento="+g.formBusAva.tipoEmpreendimento.tpImovEmpreendimento.codigo;if(null!=g.formBusAva.tipologia)a+="&tpImovTipologia="+g.formBusAva.tipologia.tpImovTipologia.codigo;if(null!=g.formBusAva.provincia)a+="&idProvincia="+g.formBusAva.provincia.codigo;if(null!=g.formBusAva.municipio)a+="&idMunicipio="+g.formBusAva.municipio.codigo;if(null!=g.formBusAva.statusProp)a+="&sgTpContrato="+g.formBusAva.statusProp.id;if(g.formBusAva.vlMinimo)a+="&vlMinimo="+g.formBusAva.vlMinimo+"&vlMaximo="+g.vlMax;var e=[];if(g.formBusAva.zonaServico){var t=g.formBusAva.zonaServico.opt,i=g.formBusAva.zonaServico.dados[0].idImovEspaco;e.push({idImovEspaco:i,nuQtdUnidade:t})}if(g.formBusAva.casaDeBanho){var n=g.formBusAva.casaDeBanho.opt,r=g.formBusAva.casaDeBanho.dados[0].idImovEspaco;e.push({idImovEspaco:r,nuQtdUnidade:n})}if(g.formBusAva.quarto){var s=g.formBusAva.quarto.opt,l=g.formBusAva.quarto.dados[0].idImovEspaco;e.push({idImovEspaco:l,nuQtdUnidade:s})}if(g.formBusAva.quartoSuite){s=g.formBusAva.quartoSuite.opt,l=g.formBusAva.quartoSuite.dados[0].idImovEspaco;e.push({idImovEspaco:l,nuQtdUnidade:s})}if(g.formBusAva.garagem){var c=g.formBusAva.garagem.opt,u=g.formBusAva.garagem.dados[0].idImovEspaco;e.push({idImovEspaco:u,nuQtdUnidade:c})}if(g.formBusAva.varanda){var d=g.formBusAva.varanda.opt,m=g.formBusAva.varanda.dados[0].idImovEspaco;e.push({idImovEspaco:m,nuQtdUnidade:d})}0<e.length&&(a+="&espacos="+JSON.stringify(e)),f.requestApiImoveis("GET",a,function(o){200==o.status&&o.data.lines?(localStorage.setItem("buscaAvancada",JSON.stringify(o.data)),p.path("/busca-avancada-imoveis")):200==o.status&&o.data.message&&(g.msgImov="NÃO FOI ENCONTRADO NENHUM IMÓVEL",g.formBusAva={},g.formBusAva.vlMinimo=0,g.disabled="")})}}:g.buscaAvancada=function(o){if(o.$submitted&&o.$valid){var a="https://www2.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni=0&pagTam=50";if(null!=g.formBusAva.tipoEmpreendimento)a+="&tpImovEmpreendimento="+g.formBusAva.tipoEmpreendimento.tpImovEmpreendimento.codigo;if(null!=g.formBusAva.tipologia)a+="&tpImovTipologia="+g.formBusAva.tipologia.tpImovTipologia.codigo;if(null!=g.formBusAva.provincia)a+="&idProvincia="+g.formBusAva.provincia.codigo;if(null!=g.formBusAva.municipio)a+="&idMunicipio="+g.formBusAva.municipio.codigo;if(null!=g.formBusAva.statusProp)a+="&sgTpContrato="+g.formBusAva.statusProp.id;if(g.formBusAva.vlMinimo)a+="&vlMinimo="+g.formBusAva.vlMinimo+"&vlMaximo="+g.vlMax;var e=[];if(g.formBusAva.zonaServico){var t=g.formBusAva.zonaServico.opt,i=g.formBusAva.zonaServico.dados[0].idImovEspaco;e.push({idImovEspaco:i,nuQtdUnidade:t})}if(g.formBusAva.casaDeBanho){var n=g.formBusAva.casaDeBanho.opt,r=g.formBusAva.casaDeBanho.dados[0].idImovEspaco;e.push({idImovEspaco:r,nuQtdUnidade:n})}if(g.formBusAva.quarto){var s=g.formBusAva.quarto.opt,l=g.formBusAva.quarto.dados[0].idImovEspaco;e.push({idImovEspaco:l,nuQtdUnidade:s})}if(g.formBusAva.quartoSuite){s=g.formBusAva.quartoSuite.opt,l=g.formBusAva.quartoSuite.dados[0].idImovEspaco;e.push({idImovEspaco:l,nuQtdUnidade:s})}if(g.formBusAva.garagem){var c=g.formBusAva.garagem.opt,u=g.formBusAva.garagem.dados[0].idImovEspaco;e.push({idImovEspaco:u,nuQtdUnidade:c})}if(g.formBusAva.varanda){var d=g.formBusAva.varanda.opt,m=g.formBusAva.varanda.dados[0].idImovEspaco;e.push({idImovEspaco:m,nuQtdUnidade:d})}0<e.length&&(a+="&espacos="+JSON.stringify(e)),f.requestApiImoveis("GET",a,function(o){200==o.status&&o.data.lines?(localStorage.setItem("buscaAvancada",JSON.stringify(o.data)),p.path("/busca-avancada-imoveis")):200==o.status&&o.data.message&&(g.msgImov="NÃO FOI ENCONTRADO NENHUM IMÓVEL",g.formBusAva={},g.formBusAva.vlMinimo=0,g.disabled="")})}},"dev.recredit.ao"==f.portalConfig.location||"hml.recredit.ao"==f.portalConfig.location?g.pesquisarImovel=function(o){var a="https://www32.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni=0&pagTam=50";null!=o.tipoEmpreendimento.$modelValue&&(a+="&tpImovEmpreendimento="+o.tipoEmpreendimento.$modelValue.tpImovEmpreendimento.codigo);null!=o.tipologias.$modelValue&&(a+="&tpImovTipologia="+o.tipologias.$modelValue.tpImovTipologia.codigo);null!=o.provincia.$modelValue&&(a+="&idProvincia="+o.provincia.$modelValue.codigo);null!=o.municipio.$modelValue&&(a+="&idMunicipio="+o.municipio.$modelValue.codigo);null!=o.statusProp.$modelValue&&(a+="&sgTpContrato="+o.statusProp.$modelValue.id);f.requestApiImoveis("GET",a,function(o){200==o.status&&o.data.lines?(g.imoveis=o.data,g.mensagem="FORAM ENCONTRADOS EM DESTAQUE",g.dadosForm={},g.disabled=""):200==o.status&&o.data.message&&(g.mensagem="NÃO FOI ENCONTRADO NENHUM IMÓVEL",g.imoveis=[],g.dadosForm={},g.disabled="")})}:g.pesquisarImovel=function(o){var a="https://www2.siaf.co.ao/gestao-imob-pub/lstImovel?nuDocumento=5417453501&pagIni=0&pagTam=50";null!=o.tipoEmpreendimento.$modelValue&&(a+="&tpImovEmpreendimento="+o.tipoEmpreendimento.$modelValue.tpImovEmpreendimento.codigo);null!=o.tipologias.$modelValue&&(a+="&tpImovTipologia="+o.tipologias.$modelValue.tpImovTipologia.codigo);null!=o.provincia.$modelValue&&(a+="&idProvincia="+o.provincia.$modelValue.codigo);null!=o.municipio.$modelValue&&(a+="&idMunicipio="+o.municipio.$modelValue.codigo);null!=o.statusProp.$modelValue&&(a+="&sgTpContrato="+o.statusProp.$modelValue.id);f.requestApiImoveis("GET",a,function(o){200==o.status&&o.data.lines?(g.imoveis=o.data,g.mensagem="FORAM ENCONTRADOS EM DESTAQUE",g.dadosForm={},g.disabled=""):200==o.status&&o.data.message&&(g.mensagem="NÃO FOI ENCONTRADO NENHUM IMÓVEL",g.imoveis=[],g.dadosForm={},g.disabled="")})}}]),app.controller("artigosController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,e,t,a,i,n,r){o.$on("broadcastHomeReceiver",function(o,a){"institucional.noticias"!=t.current.name&&"institucional.artigos"!=t.current.name||i(function(){e.init()},1e3),"institucional.noticias.cdPublicacao"!=t.current.name&&"institucional.artigos.cdPublicacao"!=t.current.name||i(function(){e.noticiaCdPublicacao()},1e3)}),this.$onInit=function(){e.pagina={},e.menuAtual=t.current;var o=new RegExp(/[.]/g);e.statePaths=o.test(e.menuAtual.name)},e.init=function(){e.pagina.anexoPortalList=[],e.paginaAtual=1,e.paginacaoQtdRegistros=9,e.paginarRegistos(),e.menuAtual.cdMenu&&n.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(e.pagina=o.data)):r.erroRede()})},e.noticiaCdPublicacao=function(){a.cdPublicacao&&(n.request("GET","/publicacao/buscar/"+a.cdPublicacao,null,!1,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),e.noticia=o.data,t.current.ncyBreadcrumb.label=e.noticia.titulo):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()}),n.request("GET","/noticia/listar/"+n.portalConfig.portalAPI+"/N/1/6",null,null,function(o){o&&200==o.retorno.codigo&&(e.itensPaginados=o.data)}))},e.paginarRegistos=function(o){o=!!o,n.request("GET","/noticia/listar/"+n.portalConfig.portalAPI+"/N/1/6",null,null,function(o){o&&200==o.retorno.codigo&&(e.itensPaginados=o)})}}]),app.controller("defaultInternaController",["$rootScope","$scope","$location","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService","ngMeta",function(o,e,a,t,i,n,r,s,l,c){e.utilizador=l.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,a){n(function(){e.init()},1e3)}),e.produtosDestaqueItens=[],e.pagina={},e.menuAtual=t.current;var u=new RegExp(/[.]/g);e.statePaths=u.test(e.menuAtual.name),e.init=function(){switch(e.setResponse=function(o){e.gRecaptchaResponse=!!o},e.menuAtual.cdMenu&&r.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!0,function(o){o?(s.closeProgressAlert(),200==o.retorno.codigo&&(e.pagina=o.data,c.setTag("description",o.data.html))):s.erroRede()}),e.url=a.url(),"/oportunidades/oportunidades-de-negocio"==e.url&&(e.paginaOpt="sim"),e.url){case"/recredit/quem-somos":return c.setTag("image",window.location.origin+"/app/main/img/recredit/banner_luanda_recredit.jpg"),c.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),e.imgBanner="banner_luanda_recredit.jpg";case"/recredit/missao-visao-valores-corporativos":return c.setTag("image",window.location.origin+"/app/main/img/recredit/banner_missao.png"),c.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),e.imgBanner="banner_missao.png";case"/recredit/mensagem-do-pca":return c.setTag("image",window.location.origin+"/app/main/img/recredit/banner_pca.png"),c.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),e.imgBanner="banner_pca.png";case"/recredit/organigrama":return c.setTag("image",window.location.origin+"/app/main/img/recredit/banner_organigrama.jpg"),c.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),e.imgBanner="banner_organigrama.jpg";case"/recredit/responsabilidade-corporativa-e-social":return c.setTag("image",window.location.origin+"/app/main/img/recredit/banner_responsabilidade.jpg"),c.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),e.imgBanner="banner_responsabilidade.jpg";case"/recredit/recredit-em-numeros/relatorioecontas":case"/recredit/recredit-em-numeros/demonstracoesfinanceiras":return c.setTag("image",window.location.origin+"/app/main/img/recredit/banner_emnumeros.jpg"),c.setTag("url","https://www.recredit.ao/PortalRecredit/#!/"),e.imgBanner="banner_emnumeros.jpg";default:return e.imgBanner="not found"}}}]),app.controller("UtilizadorController",["$rootScope","$scope","$state","$timeout","RequestService","AlertaService","StorageService","UtilizadorService","$translate","$translateLocalStorage",function(o,e,a,t,i,n,r,s,l,c){e.utilizador=r.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,a){e.utilizador=r.get("utilizadorLogado")}),e.newUtilizador=!1,e.registo=function(o){e.newUtilizador=!e.newUtilizador,console.log(e.newUtilizador)},e.login=function(o){if(o.$valid&&o.$submitted){var a={portal:i.portalConfig.portalAPI,data:{login:o.$$element[0].formLoginUtilizador.value,"palavra-passe":o.$$element[0].formLoginPalavraPasse.value}};s.login(o,a,function(o){o?200==o.retorno.codigo?(n.closeProgressAlert(function(){$("#modalLogin").modal("toggle"),e.setLogin(o),s.setLogin(rest)}),o.data.trocarPalavraPasse?n.closeProgressAlert(function(){$("#modalAlterarPalavraPasse").modal("toggle")}):(n.closeProgressAlert(function(){e.setLogin(o)}),e.setLogin(o))):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})}},e.loginModal=function(o){if(o.$valid&&o.$submitted){var a={portal:i.portalConfig.portalAPI,data:{login:o.$$element[0].formLoginUtilizador.value,"palavra-passe":o.$$element[0].formLoginPalavraPasse.value}};s.login(o,a,function(o){o?200==o.retorno.codigo?n.closeProgressAlert(function(){$("#modalLogin").modal("toggle"),e.setLogin(o),s.setLogin(rest)}):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})}},e.setLogin=function(o){s.setCookies(o)},e.logout=function(){n.confirmar("Confirma Sair ?",function(o){o&&s.logout(function(o){o?200==o.retorno.codigo?e.utilizador=null:n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})})},e.recuperarPalavraPasse=function(a){if(a.$valid&&a.$submitted){var o={portal:i.portalConfig.portalAPI,data:{login:a.$$element[0].formRecuperarPalavraPasseUtilizador.value}};i.request("POST","/acesso/recuperarPalavraPasse",o,!0,function(o){o?200==o.retorno.codigo?(n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),a.$$element[0].reset(),angular.element(".close").trigger("click")):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})}},e.alterarPalavraPasse=function(a){if(a.$valid&&a.$submitted){var o={portal:i.portalConfig.portalAPI,data:{palavraPasseAtual:a.$$element[0].palavraPasseAtual.value,palavraPasseNova:a.$$element[0].palavraPasseNova.value,confirmarPalavraPasseNova:a.$$element[0].confirmarPalavraPasseNova.value}};i.request("POST","/acesso/alterarPalavraPasse",o,!0,function(o){o?200==o.retorno.codigo?(n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),a.$$element[0].reset(),angular.element(".close").trigger("click")):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})}},e.fecharPopOver=function(){angular.element("#exibirPopOverLogin").trigger("click")},e.focarInput=function(){t(function(){angular.element(".popover.in").find("input").first().focus()},500)},e.init=function(){e.idiomas=l.getAvailableLanguageKeys(),e.idiomaAtual=c.get("NG_TRANSLATE_LANG_KEY")},e.labelIdioma=function(o){if(o){var a=o;switch(o.toUpperCase()){case"PT":a="AO"}return a}}}]),app.controller("perguntasFrequentesController",["$rootScope","$scope","$state","$stateParams","$location","$anchorScroll","$timeout","RequestService","AlertaService",function(o,e,a,t,i,n,r,s,l){o.$on("broadcastHomeReceiver",function(o,a){r(function(){e.init()},1e3)}),e.pagina={},e.init=function(){e.menuAtual=a.current,e.cdPerguntaFrequente=t.cdPerguntaFrequente,e.sigla=a.current.sigla,e.anexos=a.current.anexos,e.label=a.current.ncyBreadcrumb.label;var o={portal:s.portalAPI,data:{tpPergunta:{sigla:e.sigla,descricao:e.sigla,detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}};s.request("POST","/perguntasFrequentes/listar",o,null,function(o){200==o.retorno.codigo?(e.perguntasFrequentes=o.data,e.cdPerguntaFrequente&&r(function(){i.hash("pergunta-"+e.cdPerguntaFrequente),n()},200)):l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem)}),"ANY"!=e.sigla&&e.menuAtual.cdMenu&&s.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?(l.closeProgressAlert(),200==o.retorno.codigo&&(e.pagina=o.data)):l.erroRede()})}}]),app.controller("noticiasController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,t,e,a,i,n,r){o.$on("broadcastHomeReceiver",function(o,a){"sala-de-imprensa.noticias"==e.current.name&&i(function(){t.init()},1e3),"sala-de-imprensa.noticias.cdPublicacao"==e.current.name&&i(function(){t.noticiaCdPublicacao()},1e3),"sala-de-imprensa.artigos"==e.current.name&&i(function(){t.init()},1e3),"sala-de-imprensa.artigos.cdPublicacao"==e.current.name&&i(function(){t.noticiaCdPublicacao()},1e3)}),t.formataData=function(o){return o=moment(o,"DD-MM-YYYY'T'HH:mm:ssZ").format("DD/MM/YYYY")},t.noticiaTipo=e.current.noticia,t.pagina={},t.init=function(){t.menuAtual=e.current,n.request("GET","/noticia/listar/"+n.portalAPI+"/"+t.noticiaTipo+"/1/2",null,!1,function(o){o?200==o.retorno.codigo?(t.noticiasDestaques=o.data,r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()}),t.menuAtual.cdMenu&&n.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!1,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):r.erroRede()}),t.paginarRegistos()},t.noticiaCdPublicacao=function(){t.cdPublicacao=a.cdPublicacao,t.cdPublicacao&&n.request("GET","/noticia/buscar/"+t.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),t.noticia=o.data):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},t.paginaAtual=1,t.paginacaoQtdRegistros=8,t.paginacaoArray=[8,16,32],t.paginarRegistos=function(o){o=!!o,n.request("GET","/noticia/listar/"+n.portalAPI+"/"+t.noticiaTipo+"/"+t.paginaAtual+"/"+t.paginacaoQtdRegistros,null,o,function(o){o?200==o.retorno.codigo?(t.itensPaginados=o,r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o){t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)}}]),app.controller("videosController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,t,e,a,i,n,r){o.$on("broadcastHomeReceiver",function(o,a){"videos"==e.current.name&&i(function(){t.init()},1e3)}),t.paginaAtual=1,t.paginacaoQtdRegistros=8,t.paginacaoArray=[8,16,32],t.pagina={},t.init=function(){t.pagina.anexoPortalList=[],t.menuAtual=e.current,t.menuAtual&&n.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!0,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):r.erroRede()}),t.paginarRegistos()},t.pagina={},t.videoCdPublicacao=function(){t.cdPublicacao=a.cdPublicacao,n.request("GET","/video/buscar/"+t.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),t.video=o.data,e.current.ncyBreadcrumb={label:t.video.titulo}):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},t.paginarRegistos=function(o){o=!!o,n.request("GET","/video/listar/"+n.portalConfig.portalAPI+"/"+t.paginaAtual+"/"+t.paginacaoQtdRegistros,null,o,function(o){o?200==o.retorno.codigo?(t.itensPaginados=o,r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o){t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)}}]),app.controller("fotosController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,e,t,a,i,n,r){o.$on("broadcastHomeReceiver",function(o,a){"sala-de-imprensa.galerias"==t.current.name&&i(function(){e.init()},1e3),"sala-de-imprensa.galerias.cdPublicacao"==t.current.name&&i(function(){e.fotosCdPublicacao()},1e3)}),this.$onInit=function(){e.menuAtual=t.current},e.init=function(){e.pagina={},e.pagina.anexoPortalList=[];var o={portal:n.portalConfig.portalAPI,data:{flDestaque:"N"}};n.request("POST","/noticia/galeria/listar/",o,!1,function(o){o?200==o.retorno.codigo?(e.itensPaginados=o.data,r.closeProgressAlert()):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()}),e.menuAtual.cdMenu&&n.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(e.pagina=o.data)):r.erroRede()})},e.fotosCdPublicacao=function(){var o={portal:n.portalConfig.portalAPI,data:{cdGaleria:a.cdPublicacao,flDestaque:null}};n.request("POST","/noticia/galeria/listar/",o,!1,function(o){o?200==o.retorno.codigo?(t.current.ncyBreadcrumb={label:o.data[0].descricaoGaleria},r.closeProgressAlert(),e.galeria=o.data[0]):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()}),e.colorbox={maxWidth:"90%",maxHeight:"90%"}}}]),app.controller("servicosController",["$rootScope","$scope","$state","$stateParams","RequestService","AlertaService",function(o,a,e,t,i,n){a.menuAtual=e.current,a.urlBase=function(){return i.urlLessApi},a.consultarNif=function(o){o.$submitted&&o.$valid&&i.request("GET","/nif/consultar/"+a.nif,null,!0,function(o){o?200==o.retorno.codigo?o.data?(a.consultaResultado=o.data[0],n.closeProgressAlert()):n.showMensagemRetorno(400,"NIF não encontrado"):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},a.consultarDar=function(o){o.$submitted&&o.$valid&&i.request("GET","/dar/consultar/"+a.dar,null,!0,function(o){o?200==o.retorno.codigo?o.data?(a.consultaResultado=o.data,n.closeProgressAlert()):n.showMensagemRetorno(923,"DAR não encontrado"):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},a.novaConsulta=function(){a.consultaResultado=null}}]),app.controller("eventosController",["$rootScope","$scope","$state","$stateParams","RequestService","AlertaService","$timeout",function(o,t,e,a,i,n,r){o.$on("broadcastHomeReceiver",function(o,a){"sala-de-imprensa.eventos-futuros"==e.current.name&&r(function(){t.init()},1e3)}),t.paginaAtual=1,t.paginacaoQtdRegistros=8,t.paginacaoArray=[8,16,32],t.pagina={},t.init=function(){t.menuAtual=e.current,t.pagina.anexoPortalList=[],i.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!1,function(o){o?(n.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):n.erroRede()}),t.paginarRegistos()},t.eventoCdPublicacao=function(){t.cdPublicacao=a.cdPublicacao,i.request("GET","/evento/buscar/"+t.cdPublicacao,null,!1,function(o){o?200==o.retorno.codigo?(n.closeProgressAlert(),t.evento=o.data):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},t.paginarRegistos=function(o){o=!!o,i.request("GET","/evento/listar/"+i.portalConfig.portalAPI+"/S/"+t.paginaAtual+"/"+t.paginacaoQtdRegistros,null,o,function(o){o?200==o.retorno.codigo?(t.itensPaginados=o,n.closeProgressAlert()):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o,a){a&&(t.paginaAtual=1),t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)}}]),app.controller("calendarizacaoController",["$scope","RequestService","AlertaService",function(n,r,s){n.init=function(o,a,e){var t=moment().range(o,a),i=moment(o).add(parseInt(t.diff("d")/2),"days");r.request("GET","/calendarioFiscal/listar/periodo/"+r.portalAPI+"/"+i.format("M")+"/"+i.format("Y"),null,null,function(o){o?200==o.retorno.codigo?(n.eventos=o.data,e&&e(o.data)):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}}]),app.controller("contactoController",["$rootScope","$scope","RequestService","AlertaService","vcRecaptchaService","Alertas","$timeout","$location",function(a,e,t,i,o,n,r,s){e.dataJsonOriginal={portal:t.portalAPI,data:{nome:null,email:null,entidade:null,area:null,telemovel:null,assunto:null,descricao:null,mensagem:null}},e.dataJsonProposta=angular.copy(e.dataJsonOriginal),e.gRecaptchaResponse=!1,e.init=function(){e.dataJson=angular.copy(e.dataJsonOriginal),t.request("GET","/contacto/email/listarAssuntos/"+t.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(e.listarAssuntos=o.data):i.erroRede()})},e.contactoEnviar=function(o){o.$submitted&&o.$valid&&e.gRecaptchaResponse&&t.request("POST","/contacto/email/enviar",e.dataJson,!0,function(o){o?200==o.retorno.codigo?n.aviso("success",a.const.TITLE_SUCESSO,o.retorno.mensagem,function(){}):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},e.listarAssuntos=null,e.InitContacto=function(){t.request("GET","/contacto/email/listarAssuntos/"+t.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(e.listarAssuntos=o.data):i.erroRede()})},e.InitContacto(),e.contactoImovel=function(o){o.$submitted&&o.$valid&&e.gRecaptchaResponse&&(e.dataJson.portal=t.portalAPI,e.dataJson.data.assunto={cdAssuntoContato:null,dsAssuntoContato:"Interesse em imóvel",tpAssuntoContato:{sigla:"PRECREDIMO",descricao:null,detalhe:"Interesse em imóvel",dominio:"TP_ASSUNTO_CONTATO"},emailAssuntoContato:e.listarAssuntos[0].emailAssuntoContato},e.dataJson.data.mensagem="O utilizador "+e.dataJson.data.nome+" possui interesse no imóvel com o código "+localStorage.getItem("imv"),t.request("POST","/contacto/email/enviar",e.dataJson,!0,function(o){o?200==o.retorno.codigo?n.aviso("success",a.const.TITLE_SUCESSO,o.retorno.mensagem,function(){r(function(){s.path("/imoveis")},400)}):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()}))},e.enviarProposta=function(o){o.$submitted&&o.$valid&&e.gRecaptchaResponse&&(console.log(o),e.dataJsonProposta.portal=t.portalAPI,e.dataJsonProposta.data.assunto={cdAssuntoContato:null,dsAssuntoContato:"Proposta de Negociação",tpAssuntoContato:{sigla:"PRECREDNEG",descricao:null,detalhe:"Proposta de Negociação",dominio:"TP_ASSUNTO_CONTATO"},emailAssuntoContato:e.listarAssuntos[1].emailAssuntoContato},e.dataJsonProposta.data.mensagem="O utilizador "+e.dataJsonProposta.data.nome+" trabalhador(a) da empresa ou entidade de nome "+e.dataJsonProposta.data.entidade+", cuja área de atuação ou tipo de negócio é "+e.dataJsonProposta.data.area+", possui interesse em  uma proposta de negócio. <br/><br/><br/> Mensagem: "+e.dataJsonProposta.data.descricao,t.request("POST","/contacto/email/enviar",e.dataJsonProposta,!0,function(o){o?200==o.retorno.codigo?(n.aviso("success",a.const.TITLE_SUCESSO,o.retorno.mensagem,function(){}),e.dataJsonProposta={}):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()}))},e.setResponse=function(o){e.gRecaptchaResponse=!!o}}]),app.controller("formulariosController",["$rootScope","$scope","$state","$timeout","RequestService","AlertaService",function(o,t,a,e,i,n){o.$on("broadcastHomeReceiver",function(o,a){e(function(){t.init()},1e3)}),t.pagina={},t.init=function(){t.menuAtual=a.current,t.label=a.current.ncyBreadcrumb.label,t.sigla=a.current.sigla;var o={portal:i.portalConfig.portalAPI,data:{paginaAtual:1,itensPorPagina:1e3,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:t.sigla,descricao:t.sigla,detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};i.request("POST","/formulario/listar",o,null,function(o){o?200==o.retorno.codigo&&(t.formularios=o.data):n.erroRede()}),i.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!1,function(o){o?(n.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):n.erroRede()})},t.paginaAtual=1,t.paginacaoQtdRegistros=10,t.paginacaoArray=[10,16,32],t.paginarRegistos=function(o){o=!!o;var a={portal:"SETIC",data:{paginaAtual:t.paginaAtual,itensPorPagina:t.paginacaoQtdRegistros,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:"FORM",descricao:"FORM",detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};i.request("POST","/formulario/listar",a,null,function(o){o?200==o.retorno.codigo?(t.itensPaginados=o,angular.forEach(o.data,function(o){angular.forEach(o.anexoPortalList,function(o){var a=[];angular.forEach(o.anexoPortalItemList,function(o){0<=o.nome.indexOf("_CAPA_")?a[1]=o:a[0]=o}),o.anexoPortalItemList=a})}),n.closeProgressAlert()):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),a=[],e=0;e<o.length;e++)a.push(e);return a}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o){t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)}}]),app.controller("menuController",["$rootScope","$scope","$window","$timeout","$state","RequestService","AlertaService","Alertas","Utils","$ws","$location","$cookies","Auth",function(o,a,e,t,i,n,r,s,l,c,u,d,m){a.caminhoCompleto=u.path(),a.stateName=i.current.name,a.logoutInvestidor=function(){s.confirm(o.const.CONFIRMA_ENCERRAR_SESSAO,o.const.SIM_ENCERRAR_SESSAO,null,function(o){o&&m.logoutInvestidor()})},a.investidor=null,a.getInvestidor=function(){a.investidor=m.getUtilizador()}}]),app.controller("loginInvestidorController",["$rootScope","$scope","$window","$timeout","$state","RequestService","AlertaService","Alertas","Utils","$ws","$location","$cookies","Auth",function(e,t,i,n,o,a,r,s,l,c,u,d,m){t.exibirLogin=!0,t.exibirMensagemEmail=!1,t.investidor={nif:null,nome:null,email:null,confirmacaoEmail:null,senha:null,confirmacaosenha:null,senhalogin:null},t.valida_nif=!1,t.valida_nome=!1,t.valida_email=!1,t.valida_confirmacaoEmail=!1,t.valida_senha=!1,t.valida_confirmacaosenha=!1,t.valida_senhalogin=!1,t.captchaError=!1,t.msg_email="Informe o e-mail.",t.loginCheck=function(o){if(t.investidor.nif)if(t.investidor.senhalogin||o){var a={nif:t.investidor.nif,senha:o?t.investidor.senha:t.investidor.senhalogin};s.wait(),m.login(a,function(a){200==a.data.retorno.cod?m.setInvestidorSession(function(o){o?(t.user=a.data.data,t.user.nif?(t.carrinhoTitulos=i.localStorage.getItem("carrinhoTitulos")?JSON.parse(i.localStorage.getItem("carrinhoTitulos")):[],i.localStorage.removeItem(t.investidor.nif),i.localStorage.setItem(t.investidor.nif,JSON.stringify(t.carrinhoTitulos)),n(function(){s.closeWait(),e.$broadcast("userInvestidorReceiver",null),u.url("/backoffice/simulador")},400)):s.statusRetornoErroCallback("Utilizador Inválido!",function(){n(function(){e.$broadcast("userInvestidorReceiver",null),u.url("/")},400)})):s.statusRetornoErro(e.const.ERRO_COMPLETAR_OPERACAO)}):(e.$broadcast("userInvestidorReceiver",null),s.statusRetornoErro(a.data.retorno.message))},function(o){e.$broadcast("userInvestidorReceiver",null),s.networkError()})}else t.valida_senhalogin=!0;else t.valida_nif=!0},t.enterListener=function(o){13===o.which&&t.loginCheck()},t.recuperar={email:null},t.valida_recuperar_email=!1,t.validateEmailRecuperar=function(){var o=t.recuperar.email;if(""!=o){if(l.validEmailReg(o))return!1;t.recuperar.email="",t.valida_recuperar_email=!0}},t.recuperarSenha=function(){if(t.recuperar.email)if(l.validEmailReg(t.recuperar.email)){var o={email:t.recuperar.email};s.wait(),c.post("/rest/perfil/recuperarSenha",o).then(function(o){200==o.data.retorno.cod?s.aviso("success",e.const.TITLE_SUCESSO,e.const.PALAVRA_PASSE_RECUPERADA,function(){n(function(){t.recuperar.email="",t.valida_recuperar_email=!1,l.mantemModal("#modalRecuperarSenha",!1)},400)}):s.statusRetornoErro(o.data.retorno.message)},function(o){s.networkError()})}else t.valida_recuperar_email=!0;else t.valida_recuperar_email=!0}}]),app.controller("programacaoController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService","$ws","Alertas","Utils",function(l,c,o,a,s,e,t,i,u,d,m){c.utilizador=i.get("utilizadorLogado"),c.administrador=!1,c.gestor=!1,c.publicador=!1,c.redator=!1,c.revisor=!1,c.editor=!1,c.utilizador&&(c.administrador=m.validaPermissao("administrador",c.utilizador.grupos),c.gestor=m.validaPermissao("gestor",c.utilizador.grupos),c.publicador=m.validaPermissao("publicador",c.utilizador.grupos),c.redator=m.validaPermissao("redator",c.utilizador.grupos),c.revisor=m.validaPermissao("revisor",c.utilizador.grupos),c.editor=m.validaPermissao("editor",c.utilizador.grupos)),l.$on("broadcastUtilizadorReceiver",function(o,a){c.utilizador=i.get("utilizadorLogado"),c.utilizador&&(c.administrador=m.validaPermissao("administrador",c.utilizador.grupos),c.gestor=m.validaPermissao("gestor",c.utilizador.grupos),c.publicador=m.validaPermissao("publicador",c.utilizador.grupos),c.redator=m.validaPermissao("redator",c.utilizador.grupos),c.revisor=m.validaPermissao("revisor",c.utilizador.grupos),c.editor=m.validaPermissao("editor",c.utilizador.grupos))}),c.setComponents=function(){$(".moedamask").mask("00.000.000.000,00",{reverse:!0})},c.dataEmissao=moment().format("DD/MM/YYYY HH:mm:ss"),c.programacoes=[],c.filter={tipoPesquisaDatas:"M",ano:null,mes:null,situacao:null,data:{dtInicial:null,dtFinal:null},titulo:null,maturidade:null},c.reset=function(o){o&&(o.$setPristine(),o.$setUntouched()),c.resetFilterValues()},c.resetFilterValues=function(){c.filter.ano=null,c.filter.mes=null,c.filter.situacao=null,c.filter.data.dtInicial=null,c.filter.data.dtFinal=null,c.filter.titulo=null,c.filter.maturidade=null,c.maturidades=[],c.mesesValidos=[],c.programacoes=[]},c.filtrarProgramacao=function(o){if(o.$valid&&o.$submitted){c.programacoes=[];var a="",e="",t="";t="M"==c.filter.tipoPesquisaDatas?(a=c.filter.ano&&c.filter.mes?moment(c.filter.ano+"-"+c.filter.mes+"-01","YYYY-MM-DD").format("YYYY-MM-DD"):"%20",e=c.filter.ano&&c.filter.mes?moment(moment(c.filter.ano+"-"+c.filter.mes,"YYYY-MM").endOf("month")).format("YYYY-MM-DD"):"%20",l.const.AVISO_INFORME_O_MES_E_O_ANO):(a=c.filter.data.dtInicial?m.formataData(c.filter.data.dtInicial):"%20",e=c.filter.data.dtFinal?m.formataData(c.filter.data.dtFinal):"%20",l.const.AVISO_INFORME_O_PERIODO);var i=c.filter.titulo?c.filter.titulo.tipo:"%20",n=c.filter.maturidade?c.filter.maturidade.codigoTitulo:"%20",r=c.utilizador?"%20":"APR",s="/servicos/leilao/programacao/"+a+"/"+e+"/"+n+"/"+i+"/"+(c.filter.situacao?c.filter.situacao:r);"%20"==a&&"%20"==e?d.aviso("warning",l.const.TITLE_AVISO,t,function(){return!1}):(d.wait(),u.getStringData(s).then(function(o){d.closeWait(),200==o.data.retorno.codigo?o.data.data&&angular.forEach(o.data.data,function(o,a){"EXC"!=o.situacao&&c.programacoes.push(o)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()}))}},c.imprimirProgramacao=function(){c.dataEmissao=moment().format("DD/MM/YYYY HH:mm:ss"),window.print()},c.tipostitulos=[],c.obterTipoTitulos=function(){c.tipostitulos=[],d.wait(),u.getStringData("/servicos/leilao/obtertipostitulos").then(function(o){d.closeWait(),200==o.data.retorno.codigo?c.tipostitulos=o.data.data:d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})},c.maturidades=[],c.obterMaturidades=function(o){o?(c.maturidades=[],d.wait(),u.getStringData("/servicos/leilao/obtermaturidades/"+o.tipo).then(function(o){d.closeWait(),200==o.data.retorno.codigo?c.maturidades=o.data.data:d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})):d.aviso("warning",l.const.TITLE_AVISO,l.const.AVISO_TITULO_INFORMADO_E_INVALIDO,function(){return!1})},c.anosValidos=[],c.obterAnos=function(){for(var o=parseInt(moment().format("Y")),a=2014;a<=o;a++)c.anosValidos.push(a)},c.mesesValidos=[],c.obterMeses=function(o){var a=parseInt(moment().format("MM")),e=parseInt(moment().format("Y"));if(c.mesesValidos=[],o==e)for(var t=1;t<=a;t++)c.mesesValidos.push(t);else for(t=1;t<=12;t++)c.mesesValidos.push(t)},c.obterNomeMes=function(o){return o?moment("01/"+o+"/2018","DD/MM/YYYY").format("MMMM"):""},c.programacao={codigoProgramacao:null,situacao:null,data:{dtInicial:null,dtFinal:null},instrumentos:[]},c.instrumento={titulo:null,maturidade:null,valorFinanceiro:null},c.limparProgramacao=function(){c.formManterProgramacao.$setPristine(),c.formManterProgramacao.$setUntouched(),c.programacao.codigoProgramacao=null,c.programacao.situacao=null,c.programacao.data.dtInicial=null,c.programacao.data.dtFinal=null,c.programacao.instrumentos=[]},c.adicionarInstrumento=function(){0==parseFloat(m.getFloatMoney(c.instrumento.valorFinanceiro))||0==parseFloat(m.getFloatMoney(c.instrumento.valorFinanceiro))?d.aviso("warning",l.const.TITLE_AVISO,l.const.O_VALOR_DO_INSTRUMENTO_NAO_PODE_SER_IGUAL_A_ZERO,function(){return!1}):c.verificaMaturidadeExiste(c.instrumento)?d.aviso("warning",l.const.TITLE_AVISO,l.const.INSTRUMENTO_JA_INFORMADO_PARA_PROGRAMACAO_SEMANAL,function(){return!1}):(c.programacao.instrumentos.push(angular.copy(c.instrumento)),c.instrumento.titulo=null,c.instrumento.maturidade=null,c.instrumento.valorFinanceiro=null,c.maturidades=[])},c.verificaMaturidadeExiste=function(e){var t=!1;return angular.forEach(c.programacao.instrumentos,function(o,a){o.maturidade.descricao==e.maturidade.descricao&&o.titulo.tipo==e.titulo.tipo&&(t=!0)}),t},c.removerInstrumento=function(e){if(e.titulo.codigo)e.titulo.situacao="EXC",e.titulo.temAlteracao=!0;else if(0<c.programacao.instrumentos.length){var t=[];angular.forEach(c.programacao.instrumentos,function(o,a){o!=e&&t.push(o)}),c.programacao.instrumentos=t}},c.manterProgramacao=function(o){if(o.$valid&&o.$submitted){var t=[];0<c.programacao.instrumentos.length&&angular.forEach(c.programacao.instrumentos,function(o,a){var e={codigo:o.titulo.codigo,tipo:o.titulo.tipo,descricao:o.titulo.descricao,maturidade:{descricao:o.maturidade.descricao,codigoTitulo:o.maturidade.codigoTitulo},valorFinanceiro:o.valorFinanceiro,situacao:o.titulo.codigo?o.titulo.situacao:"ABE",subTotal:o.titulo.subTotal,listaResultados:o.titulo.listaResultados,temAlteracao:o.titulo.temAlteracao};t.push(e)});var i={codigoProgramacao:c.programacao.codigoProgramacao,dataInicio:m.formataData(c.programacao.data.dtInicial),dataFim:m.formataData(c.programacao.data.dtInicial),situacao:c.programacao.codigoProgramacao?c.programacao.situacao:"ABE",listaTitulos:0<t.length?t:[],totalTitulos:null};d.wait(),u.post("/servicos/leilao/programacao",i).then(function(o){if(d.closeWait(),200==o.data.retorno.codigo){var a=o.data.data,e=null==i.codigoProgramacao?l.const.PROGRAMACAO_SALVA_CONTINUE:l.const.PROGRAMACAO_SALVA_COM_SUCESSO;d.aviso("success",l.const.TITLE_SUCESSO,e,function(){s(function(){c.limparProgramacao(),null==i.codigoProgramacao?(c.programacao.codigoProgramacao=a.codigoProgramacao,c.programacao.data.dtInicial=m.formataDataNormal(a.dataInicio),c.programacao.data.dtFinal=m.formataDataNormal(a.dataFim),c.programacao.situacao=a.situacao,c.programacao.instrumentos=[],a.listaTitulos&&0<a.listaTitulos.length&&angular.forEach(a.listaTitulos,function(o,a){var e={titulo:o,maturidade:o.maturidade,valorFinanceiro:o.valorFinanceiro};c.programacao.instrumentos.push(e)})):(m.mantemModal("#modalGerirProgramacao",!1),c.filtrarProgramacao(c.filtrarProgramacaoForm))},500)})}else d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}},c.editarProgramacao=function(o){c.limparProgramacao(),s(function(){c.programacao.codigoProgramacao=o.codigoProgramacao,c.programacao.data.dtInicial=m.formataDataNormal(o.dataInicio),c.programacao.data.dtFinal=m.formataDataNormal(o.dataFim),c.programacao.situacao=o.situacao,o.listaTitulos&&0<o.listaTitulos.length&&angular.forEach(o.listaTitulos,function(o,a){var e={titulo:o,maturidade:o.maturidade,valorFinanceiro:o.valorFinanceiro};c.programacao.instrumentos.push(e)}),m.mantemModal("#modalGerirProgramacao",!0)},500)},c.excluirProgramacao=function(e){d.confirm(l.const.AVISO_EXCLUIR_PROGRAMACAO,null,null,function(o){if(o){var a=angular.copy(e);a.situacao="EXC",d.wait(),u.delete("/servicos/leilao/programacao/"+a.codigoProgramacao,a).then(function(o){d.closeWait(),200==o.data.retorno.codigo?d.aviso("success",l.const.TITLE_SUCESSO,l.const.PROGRAMACAO_EXCLUIDA_COM_SUCESSO,function(){s(function(){c.filtrarProgramacao(c.filtrarProgramacaoForm)},500)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}})},c.validaExcluirProgramacao=function(o){var e=!0;return angular.forEach(o.listaTitulos,function(o,a){o.listaResultados&&0<o.listaResultados.length&&(e=!1)}),e},c.alterarStatusProgramacao=function(e,t){if("PEN"==t&&0==e.listaTitulos.length)d.aviso("warning",l.const.TITLE_AVISO,l.const.NAO_FOI_POSSIVEL_SUBMETER_A_PROGRAMACAO,function(){return!1});else{var o=l.const.CONFIRMA_OPERACAO;"PEN"==t?o=l.const.TEM_CERTEZA_QUE_DESEJA_SUBMETER_ESTA_PROGRAMACAO:"APR"==t?o=l.const.TEM_CERTEZA_QUE_DESEJA_APROVAR_ESTA_PROGRAMACAO:"ABE"==t&&(o=l.const.TEM_CERTEZA_QUE_DESEJA_REPROVAR_ESTA_PROGRAMACAO),d.confirm(o,null,null,function(o){if(o){var a=e;a.situacao=t,d.wait(),u.post("/servicos/leilao/programacao",a).then(function(o){d.closeWait(),200==o.data.retorno.codigo?d.aviso("success",l.const.TITLE_SUCESSO,l.const.PROGRAMACAO_ALTERADA_COM_SUCESSO,function(){s(function(){c.filtrarProgramacao(c.filtrarProgramacaoForm)},500)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}})}},c.resultados=[],c.resultado={programacao:{codigoProgramacao:null,dataInicio:null,dataFim:null,listaTitulos:[],situacao:null,totalTitulos:null}},c.lancarResultados=function(o){c.resultado.programacao=angular.copy(o),m.mantemModal("#modalGerirResultados",!0)},c.novoResultado=function(){c.limparResultadoInstrumento(c.formManterResultado),m.mantemModal("#modalGerirResultados",!1),s(function(){m.mantemModal("#modalGerirResultado",!0)},600)},c.voltarParaResultados=function(){m.mantemModal("#modalGerirResultado",!1),s(function(){m.mantemModal("#modalGerirResultados",!0)},600)},c.lancarResultado=!1,c.instSelecionado=null,c.lancarResultadoInstrumento=function(o,a){c.lancarResultado=!0,c.instSelecionado=angular.copy(o),c.buscarResultadosInstrumento(o)},c.voltarResultado=function(){c.lancarResultado=!1,c.instSelecionado=null},c.resultadoInstrumento={cdResultadoLeilao:null,dtEmissao:null,dtVencimento:null,oferta:null,procura:null,montanteColocado:null,valorPago:null,precoUnitario:null,taxaJuros:null,stResultadoLeilao:null,percRacio:null},c.limparResultadoInstrumento=function(o){c.resultadoInstrumento.dtEmissao=null,c.resultadoInstrumento.oferta=null,c.resultadoInstrumento.procura=null,c.resultadoInstrumento.montanteColocado=null,c.resultadoInstrumento.valorPago=null,c.resultadoInstrumento.precoUnitario=null,c.resultadoInstrumento.taxaJuros=null,o.$setPristine()},c.editarResultado=function(o){var a="",e="";if(28<o.dtEmissao.length){var t=String(o.dtEmissao).split("."),i=String(t[0]).split("T");a=m.formataDataNormal(i[0])}if(28<o.dtVencimento.length){var n=String(o.dtVencimento).split("."),r=String(n[0]).split("T");e=m.formataDataNormal(r[0])}c.resultadoInstrumento.cdResultadoLeilao=o.cdResultadoLeilao,c.resultadoInstrumento.dtEmissao=a,c.resultadoInstrumento.dtVencimento=e,c.resultadoInstrumento.oferta=m.formatKuanza(o.vlMontante),c.resultadoInstrumento.procura=m.formatKuanza(o.vlProcura),c.resultadoInstrumento.montanteColocado=m.formatKuanza(o.vlMontanteColocado),c.resultadoInstrumento.valorPago=m.formatKuanza(o.vlPago),c.resultadoInstrumento.precoUnitario=m.formatKuanza(o.vlUnitario),c.resultadoInstrumento.taxaJuros=m.formatKuanza(o.txJuros),c.resultadoInstrumento.percRacio=m.formatKuanza(o.percRacio),c.resultadoInstrumento.stResultadoLeilao=o.stResultadoLeilao,m.mantemModal("#modalGerirResultados",!1),s(function(){m.mantemModal("#modalGerirResultado",!0)},600)},c.validarInstrumentos=function(o){var e=!1;return angular.forEach(o,function(o,a){"EXC"!=o.titulo.situacao&&(e=!0)}),e},c.manterResultado=function(a){if(a.$valid&&a.$submitted)if(c.resultadoInstrumento.cdResultadoLeilao){var o=m.formataData(c.resultadoInstrumento.dtEmissao)+"T"+moment().format("HH:mm:ss"),e=0;0<(r=String(c.instSelecionado.maturidade.descricao).split(" ")).length&&("dias"==r[1]||"dia"==r[1]?e=parseInt(r[0])-2:"anos"!=r[1]&&"ano"!=r[1]||(e=365*parseInt(r[0])-2));var t=moment(c.resultadoInstrumento.dtEmissao,"DD/MM/YYYY").add(parseInt(e),"days").format("YYYY-MM-DD")+"T"+moment().format("HH:mm:ss"),i=parseFloat(parseFloat(m.getFloatMoney(c.resultadoInstrumento.procura))/parseFloat(m.getFloatMoney(c.resultadoInstrumento.oferta))).toFixed(2),n={cdResultadoLeilao:c.resultadoInstrumento.cdResultadoLeilao,dtEmissao:o,dtVencimento:t,vlMontante:m.getFloatMoney(c.resultadoInstrumento.oferta),vlProcura:m.getFloatMoney(c.resultadoInstrumento.procura),vlMontanteColocado:m.getFloatMoney(c.resultadoInstrumento.montanteColocado),vlPago:m.getFloatMoney(c.resultadoInstrumento.valorPago),percRacio:i,txJuros:m.getFloatMoney(c.resultadoInstrumento.taxaJuros),vlUnitario:m.getFloatMoney(c.resultadoInstrumento.precoUnitario),stResultadoLeilao:c.resultadoInstrumento.stResultadoLeilao};d.wait(),u.putData("/servicos/leilao/resultado/alterarResultado",n).then(function(o){d.closeWait(),200==o.data.retorno.codigo?d.aviso("success",l.const.TITLE_SUCESSO,l.const.RESULTADO_ALTERADO_COM_SUCESSO,function(){s(function(){c.buscarResultadosInstrumento(c.instSelecionado),c.voltarParaResultados()},500)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}else{var r;o=m.formataData(c.resultadoInstrumento.dtEmissao)+"T"+moment().format("HH:mm:ss"),i=parseFloat(parseFloat(m.getFloatMoney(c.resultadoInstrumento.procura))/parseFloat(m.getFloatMoney(c.resultadoInstrumento.oferta))).toFixed(2),e=0;0<(r=String(c.instSelecionado.maturidade.descricao).split(" ")).length&&("dias"==r[1]||"dia"==r[1]?e=parseInt(r[0])-2:"anos"!=r[1]&&"ano"!=r[1]||(e=365*parseInt(r[0])-2));t=moment(c.resultadoInstrumento.dtEmissao,"DD/MM/YYYY").add(parseInt(e),"days").format("YYYY-MM-DD")+"T"+moment().format("HH:mm:ss"),n={cdTituloLeilao:c.instSelecionado.codigo,dtEmissao:o,vlMontante:m.getFloatMoney(c.resultadoInstrumento.oferta),dtVencimento:t,txJuros:m.getFloatMoney(c.resultadoInstrumento.taxaJuros),vlUnitario:m.getFloatMoney(c.resultadoInstrumento.precoUnitario),vlProcura:m.getFloatMoney(c.resultadoInstrumento.procura),percRacio:i,vlPago:m.getFloatMoney(c.resultadoInstrumento.valorPago),vlMontanteColocado:m.getFloatMoney(c.resultadoInstrumento.montanteColocado),stResultadoLeilao:"ABE"};d.wait(),u.post("/servicos/leilao/resultado/salvarLeilao",n).then(function(o){d.closeWait(),200==o.data.retorno.codigo?d.aviso("success",l.const.TITLE_SUCESSO,l.const.RESULTADO_REGISTADO_COM_SUCESSO,function(){s(function(){c.buscarResultadosInstrumento(c.instSelecionado),c.limparResultadoInstrumento(a),c.voltarParaResultados()},500)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}},c.excluirResultado=function(a,e){d.confirm(l.const.AVISO_EXCLUIR_REGISTO,null,null,function(o){o&&a.cdResultadoLeilao&&c.serviceExcluirResultadoLeilao(a.cdResultadoLeilao,e)})},c.serviceExcluirResultadoLeilao=function(o,a){if(o){var e={cdResultadoLeilao:o};d.wait(),u.delete("/servicos/leilao/resultado/removerResultadoLeilao",e).then(function(o){d.closeWait(),200==o.data.retorno.codigo?d.aviso("success",l.const.TITLE_SUCESSO,l.const.RESULTADO_EXCLUIDO_COM_SUCESSO,function(){s(function(){c.buscarResultadosInstrumento(a)},500)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}},c.alterarStatusResultado=function(e,t,i){var o=l.const.CONFIRMA_OPERACAO;"PEN"==i?o=l.const.TEM_CERTEZA_QUE_DESEJA_SUBMETER_O_RESULTADO:"APR"==i?o=l.const.TEM_CERTEZA_QUE_DESEJA_APROVAR_O_RESULTADO:"ABE"==i&&(o=l.const.TEM_CERTEZA_QUE_DESEJA_REPROVAR_O_RESULTADO),d.confirm(o,null,null,function(o){if(o){var a={cdResultadoLeilao:e.cdResultadoLeilao,dtEmissao:e.dtEmissao,dtVencimento:e.dtVencimento,vlMontante:e.vlMontante,vlProcura:e.vlProcura,vlMontanteColocado:e.vlMontanteColocado,vlPago:e.vlPago,percRacio:e.percRacio,txJuros:e.txJuros,vlUnitario:e.vlUnitario,stResultadoLeilao:i};d.wait(),u.putData("/servicos/leilao/resultado/alterarResultado",a).then(function(o){d.closeWait(),200==o.data.retorno.codigo?d.aviso("success",l.const.TITLE_SUCESSO,l.const.RESULTADO_ALTERADO_COM_SUCESSO,function(){s(function(){c.buscarResultadosInstrumento(t)},500)}):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})}})},c.buscarResultadosInstrumento=function(o){var a={cdTituloLeilao:o.codigo,dtEmissao:null,stResultadoLeilao:null};c.resultados=[],d.wait(),u.post("/servicos/leilao/resultado/listarResultados",a).then(function(o){d.closeWait(),200==o.data.retorno.codigo?o.data.data&&(c.resultados=o.data.data.resultadoLeilaoList):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})},c.buscarResultadosInstrumentoCount=function(o,a){var e={cdTituloLeilao:o.codigo,dtEmissao:null,stResultadoLeilao:null};c.resultados=[],u.post("/servicos/leilao/resultado/listarResultados",e).then(function(o){200==o.data.retorno.codigo?o.data.data&&(c.resultados=o.data.data.resultadoLeilaoList,0<o.data.data.resultadoLeilaoList.length?a(parseInt(o.data.data.resultadoLeilaoList.length)):a(0)):d.statusRetornoErro(o.data.retorno.mensagem)},function(o){d.networkError()})},c.init=function(){c.obterTipoTitulos(),c.obterAnos(),c.setComponents()}}]),app.controller("programacaoGerirController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,a,e,t,i,n,r){}]),app.controller("resultadosController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService","$ws","Alertas","Utils",function(o,e,a,t,i,n,r,s,l,c,u){e.utilizador=s.get("utilizadorLogado"),e.administrador=!1,e.gestor=!1,e.publicador=!1,e.redator=!1,e.revisor=!1,e.editor=!1,e.utilizador&&(e.administrador=u.validaPermissao("administrador",e.utilizador.grupos),e.gestor=u.validaPermissao("gestor",e.utilizador.grupos),e.publicador=u.validaPermissao("publicador",e.utilizador.grupos),e.redator=u.validaPermissao("redator",e.utilizador.grupos),e.revisor=u.validaPermissao("revisor",e.utilizador.grupos),e.editor=u.validaPermissao("editor",e.utilizador.grupos)),o.$on("broadcastUtilizadorReceiver",function(o,a){e.utilizador=s.get("utilizadorLogado"),e.utilizador&&(e.administrador=u.validaPermissao("administrador",e.utilizador.grupos),e.gestor=u.validaPermissao("gestor",e.utilizador.grupos),e.publicador=u.validaPermissao("publicador",e.utilizador.grupos),e.redator=u.validaPermissao("redator",e.utilizador.grupos),e.revisor=u.validaPermissao("revisor",e.utilizador.grupos),e.editor=u.validaPermissao("editor",e.utilizador.grupos))}),e.setComponents=function(){$(".moedamask").mask("00.000.000,00",{reverse:!0})},e.dataEmissao=moment().format("DD/MM/YYYY H:mm:ss"),e.resultados=[],e.filter={dtEmissao:null},e.reset=function(o){o&&(o.$setPristine(),o.$setUntouched()),e.resetFilterValues()},e.resetFilterValues=function(){e.filter.dtEmissao=null,e.resultados=[]},e.imprimir=function(){e.dataEmissao=moment().format("DD/MM/YYYY H:mm:ss"),window.print()},e.filtrarResultados=function(o){if(o.$valid&&o.$submitted){var a={cdTituloLeilao:null,dtEmissao:u.formataData(e.filter.dtEmissao),stResultadoLeilao:"APR"};c.wait(),l.post("/servicos/leilao/resultado/listarResultados",a).then(function(o){c.closeWait(),200==o.data.retorno.codigo?e.resultados=o.data.data.resultadoLeilaoList:c.statusRetornoErro(o.data.retorno.mensagem)},function(o){c.networkError()})}},e.imprimirProgramacao=function(o){window.print()},e.init=function(){e.setComponents()}}]),app.controller("mapaDoSiteController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","LinkService",function(a,e,o,t,i,n,r,s){e.menuFooter=[],e.init=function(){angular.forEach(a.menu,function(o,a){e.menuFooter.push(o)})},e.checkUrl=function(o){return s.target(o.url)?o.url:a.getLinkState(o.state)}}]),app.controller("quemEquemController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService",function(o,e,t,a,i,n,r,s){e.utilizador=s.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,a){"sobre.quem-e-quem"==t.current.name&&i(function(){e.init()},1e3),"sobre.quem-e-quem.cdQuemEQuem"==t.current.name&&i(function(){e.initVisualizarDetalhes()},1e3)}),e.pagina={},e.menuAtual=t.current,e.init=function(){e.menuAtual.cdMenu&&n.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(e.pagina=o.data):r.erroRede()}),n.request("GET","/quemEQuem/listar/"+n.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(e.quemEQuemList=o.data):r.erroRede()})},e.initVisualizarDetalhes=function(){n.request("GET","/quemEQuem/buscar/"+a.cdQuemEQuem,null,!1,function(o){o?200==o.retorno.codigo&&(e.detalhe=o.data):r.erroRede()})}}]),app.controller("publicacoesController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","ngMeta",function(o,e,t,a,i,n,r,s){o.$on("broadcastHomeReceiver",function(o,a){"institucional.noticias"!=t.current.name&&"institucional.artigos"!=t.current.name||i(function(){e.init()},1e3),"institucional.noticias.cdPublicacao"!=t.current.name&&"institucional.artigos.cdPublicacao"!=t.current.name||i(function(){e.noticiaCdPublicacao()},1e3)}),this.$onInit=function(){e.pagina={},e.menuAtual=t.current;var o=new RegExp(/[.]/g);e.statePaths=o.test(e.menuAtual.name)},e.init=function(){e.pagina.anexoPortalList=[],e.paginaAtual=1,e.paginacaoQtdRegistros=9,e.paginarRegistos(),e.menuAtual.cdMenu&&n.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(e.pagina=o.data)):r.erroRede()})},e.noticiaCdPublicacao=function(){if(e.paginaAtual=1,e.paginacaoQtdRegistros=9,a.cdPublicacao){n.request("GET","/publicacao/buscar/"+a.cdPublicacao,null,!1,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),e.noticia=o.data,t.current.ncyBreadcrumb.label=e.noticia.titulo,s.setTag("author",o.data.titulo),s.setTag("image",o.data.anexoPortalList[0].anexoPortalItemList[0].url),s.setTag("description",o.data.sumario),s.setTag("url","https://www.recredit.ao/PortalRecredit/#!/")):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()});var o={portal:n.portalConfig.portalAPI,flDestaque:null,tipo:{sigla:"PUB",dominio:t.current.publicacao.template.dominio},status:"PUB",titulo:null,todos:!0,paginaAtual:e.paginaAtual,qtdPaginas:e.paginacaoQtdRegistros};n.request("POST","/publicacao/listarPublico",o,!1,function(o){o?200==o.retorno.codigo?(e.itensPaginados=o.data,e.listarPublicacoes(e.itensPaginados),r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}},e.paginarRegistos=function(o){o=!!o;var a={portal:n.portalConfig.portalAPI,flDestaque:null,tipo:{sigla:"PUB",dominio:t.current.publicacao.template.dominio},status:"PUB",titulo:null,todos:!0,paginaAtual:e.paginaAtual,qtdPaginas:e.paginacaoQtdRegistros};n.request("POST","/publicacao/listarPublico",a,!1,function(o){o?200==o.retorno.codigo?(e.itensPaginados=o,r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},e.listarPublicacoes=function(o){e.novosDados=o.map(function(o){return{titulo:o.titulo,cdPublicacao:o.cdPublicacao,imagem:o.anexoPortalList[0].anexoPortalItemList[0].url,sumario:o.sumario,dtInicio:o.dtInicio,flDestaque:o.flDestaque}}),e.dadosFiltrados=e.novosDados.filter(function(o){return filtro="N"==o.flDestaque})}}]),app.controller("estatisticasController",["$scope","$state","StorageService","checkSession","$location",function(o,a,e,t,i){t?o.init=function(){o.utilizador=e.get("utilizadorLogado"),o.utilizador||a.go("home")}:i.url("/")}]),app.controller("glossarioController",["$rootScope","$scope","$state","$stateParams","$location","$anchorScroll","$timeout","RequestService","AlertaService",function(o,e,a,t,i,n,r,s,l){o.$on("broadcastHomeReceiver",function(o,a){r(function(){e.init()},1e3)}),e.pagina={},e.init=function(){e.menuAtual=a.current,console.log(a.current.url),"/estaticas"==a.current.url&&(e.dados=a.current.subPaginas,console.log(e.dados)),console.log(a.current.url),s.request("GET","/glossario/listar/"+s.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo?e.glossarios=o.data:923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()}),e.menuAtual.cdMenu&&s.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(e.pagina=o.data):l.erroRede()})}}]),app.controller("recreditController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService",function(o,e,t,a,i,n,r,s){e.utilizador=s.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,a){"sobre.quem-e-quem"==t.current.name&&i(function(){e.init()},1e3),"sobre.quem-e-quem.cdQuemEQuem"==t.current.name&&i(function(){e.initVisualizarDetalhes()},1e3)}),e.pagina={},e.menuAtual=t.current,e.init=function(){e.menuAtual.cdMenu&&n.request("GET","/menu/buscarConteudoHtml/"+e.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(e.pagina=o.data):r.erroRede()}),n.request("GET","/quemEQuem/listar/"+n.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(e.quemEQuemList=o.data):r.erroRede()})},e.initVisualizarDetalhes=function(){n.request("GET","/quemEQuem/buscar/"+a.cdQuemEQuem,null,!1,function(o){o?200==o.retorno.codigo&&(e.detalhe=o.data):r.erroRede()})}}]),app.config(["cfpLoadingBarProvider","$httpProvider",function(o,a){o.includeSpinner=!1}]).service("RequestService",["$rootScope","$sce","$http","$timeout","$urlRouter","$q","$translateLocalStorage","AlertaService","StorageService",function(l,n,c,u,o,d,a,m,g){var r,e,t=a.get("NG_TRANSLATE_LANG_KEY"),i="PRECREDIT"+("PT"!=t&&t&&""!=t?"-"+t:""),p=(e=0<=window.location.hostname.indexOf("localhost")||window.location.hostname.match("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$")?(r="dev.recredit.ao","https:"):"hml.recredit.ao"==window.location.hostname?(r="hml.recredit.ao","https:"):(r=window.location.hostname,window.location.protocol))+"//"+r+"/Componentes/api",s={portalAPI:i,protocol:e,location:r,port:window.location.port,context:"PortalRecredit",portalDefault:i};return l.$on("$routeChangeStart",function(o,a,e){c.pendingRequests.forEach(function(o){o.cancel&&o.cancel.resolve()})}),{request:function(o,a,e,t,i){var n=p+a,r=d.defer();t&&m.showProgressAlert("A Carregar...");var s={method:o,data:e,url:n,timeout:r.promise,cancel:r,cache:!1,withCredentials:!0,headers:{"Content-Type":"application/json"}};c(s).then(function(o){var a;923==o.data.retorno.codigo?(g.clear(),l.$broadcast("broadcastUtilizadorReceiver"),m.showMensagemRetorno(o.data.retorno.codigo,"Faça Login Novamente para continuar a acção",function(){u(function(){angular.element("#exibirPopOverLogin").trigger("click")},500),i&&i(o.data)})):(i&&i(o.data),angular.isDefined(o.data.token)&&o.data.token&&(a=o.data.token,UtilizadorService.updateToken(a)))},function(o){i&&i()}).finally(function(o){})},requestApiImoveis:function(o,a,e){var t=d.defer(),i={method:o,url:a,timeout:t.promise,cancel:t,cache:!1,withCredentials:!1,headers:{"Content-Type":"application/json"}};c(i).then(function(o){200==o.status&&e&&e(o)},function(o){e&&e(o)}).finally(function(o){})},download:function(o,a,e,t){e&&m.showProgressAlert("A Carregar...");var i=n.trustAsResourceUrl(o+"?callback=JSON_CALLBACK");c({method:"GET",url:i,cache:!1,responseType:"blob"}).then(function(o){t&&t(o)},function(o){t&&t(o)}).finally(function(o){})},local:function(o,a,e,t,i){c.get("app/services/offline/"+a).then(function(o){i(o.data)})},portalAPI:i,versao:function(o,a){var e=window.location.protocol+"//"+r+"/"+o,t=d.defer(),i={method:"GET",url:e,timeout:t.promise,cancel:t,cache:!1,withCredentials:!0,headers:{"Content-Type":"application/json"}};c(i).then(function(o){a&&a(o)},function(o){a&&a()}).finally(function(o){})},portalConfig:s}}]),app.service("AlertaService",["$timeout",function(a){swal.setDefaults({allowOutsideClick:!1,allowEscapeKey:!0,allowEnterKey:!0,confirmButtonColor:"#1f3264",onClose:function(){},onOpen:function(){}});return{showMensagemRetorno:function(o,a,e){var t;switch(o){case 200:t="success";break;case 923:default:t="warning"}swal("",a,t).then(function(o){e&&e()})},confirmar:function(o,a){o=o||"Confirmar a acção ?",swal({text:o,cancelButtonText:"Cancelar",confirmButtonText:"Sim",type:"question",showCancelButton:!0}).then(function(){a(!0)},function(o){"cancel"===o&&a(!1)})},showProgressAlert:function(o){swal.showLoading()},closeProgressAlert:function(o){a(function(){swal.close(function(){o&&o()})},500)},erroRede:function(){swal("","Verifique a sua conexão com a Internet","warning")}}}]),angular.module("storage.service",["LocalStorageModule"]).config(["localStorageServiceProvider",function(o){o.setPrefix("PSETIC").setNotify(!0,!0)}]).factory("StorageService",["localStorageService",function(e){return{set:function(o,a){return e.set(o,a)},get:function(o){return e.get(o)},remove:function(o){return e.remove(o)},clear:function(){return e.clearAll()}}}]),angular.module("utilizador.service",[]).factory("UtilizadorService",["$rootScope","$q","StorageService","RequestService","Utils",function(e,t,n,i,r){return{login:function(o,a,e){i.request("POST","/acesso/loginToken",a,!0,function(o){e&&e(o)})},logout:function(a){i.request("GET","/acesso/logout",null,!0,function(o){n.clear(),e.$broadcast("broadcastUtilizadorReceiver"),a&&a(o)})},limparCookies:function(o){n.clear(),e.$broadcast("broadcastUtilizadorReceiver"),o&&o()},setCookies:function(o){var i={grupos:[]},a=o.data.grupos?o.data.grupos:[];angular.forEach(a,function(o,a){var e=String(o).split(","),t=String(e[0]).replace("cn=","");i.grupos.push(t)}),o.data.grupos=i.grupos,e.utilizador=o.data,e.utilizador.token=o.token,e.utilizador.gestor=r.validaPermissao("administrador",i.grupos)||r.validaPermissao("gestor",i.grupos)||r.validaPermissao("publicador",i.grupos)||r.validaPermissao("redator",i.grupos)||r.validaPermissao("revisor",i.grupos)||r.validaPermissao("editor",i.grupos),e.utilizador.admin=r.validaPermissao("administrador",i.grupos)||r.validaPermissao("gestor",i.grupos),n.set("utilizadorLogado",e.utilizador),e.$broadcast("broadcastUtilizadorReceiver")},checarPermissao:function(o){var a=n.get("utilizadorLogado"),e=t.defer();return a?angular.forEach(a.grupos,function(a){angular.forEach(o,function(o){a.toString().toUpperCase()==o.toString().toUpperCase()&&e.resolve(!0)})}):e.resolve(!1),e.promise}}}]),String.prototype.extenso=function(o){for(var a,e,t,i,n,r=[["zero","um","dois","três","quatro","cinco","seis","sete","oito","nove","dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"],["dez","vinte","trinta","quarenta","cinqüenta","sessenta","setenta","oitenta","noventa"],["cem","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"],["mil","milhão","bilhão","trilhão","quadrilhão","quintilhão","sextilhão","setilhão","octilhão","nonilhão","decilhão","undecilhão","dodecilhão","tredecilhão","quatrodecilhão","quindecilhão","sedecilhão","septendecilhão","octencilhão","nonencilhão"]],s=" e ",l="centavo",c=(i=this.replace(o?/[^,\d]/g:/\D/g,"").split(",")).length-1,u=-1,d=[],m=[],g="";++u<=c;m=[])if(u&&(i[u]=(1*("."+i[u])).toFixed(2).slice(2)),(a=(e=i[u]).slice((n=e.length)%3).match(/\d{3}/g),e=n%3?[e.slice(0,n%3)]:[],e=a?e.concat(a):e).length){for(a=-1,n=e.length;++a<n;g="")(t=1*e[a])&&(t%100<20&&(g+=r[0][t%100])||t%100+1&&(g+=r[1][(t%100/10>>0)-1]+(t%10?s+r[0][t%10]:"")),m.push((t<100?g:t%100?r[2][t/100>>0]+s+g:r[2][100==t?0:t/100>>0])+(-1<(g=n-a-2)?" "+(1<t&&0<g?r[3][g].replace("ão","ões"):r[3][g]):"")));(a=1<m.length?(a=m.pop(),m.join(" ")+s+a):m.join("")||(!u&&0<1*i[u+1]||d.length?"":r[0][0]))&&d.push(a+(o?" "+(1<1*e.join("")?u?l+"s":(/0{6,}$/.test(i[0])?"de ":"")+"real".replace("l","is"):u?l:"real"):""))}return d.join(s)},app.service("Utils",["$http",function(o){this.retornaValorExtenso=function(o){for(var a,e,t,i,n,r=[["zero","um","dois","três","quatro","cinco","seis","sete","oito","nove","dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"],["dez","vinte","trinta","quarenta","cinqüenta","sessenta","setenta","oitenta","noventa"],["cem","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"],["mil","milhão","bilhão","trilhão","quadrilhão","quintilhão","sextilhão","setilhão","octilhão","nonilhão","decilhão","undecilhão","dodecilhão","tredecilhão","quatrodecilhão","quindecilhão","sedecilhão","septendecilhão","octencilhão","nonencilhão"]],s=" e ",l="centavo",c=(i=this.replace(o?/[^,\d]/g:/\D/g,"").split(",")).length-1,u=-1,d=[],m=[],g="";++u<=c;m=[])if(u&&(i[u]=(1*("."+i[u])).toFixed(2).slice(2)),(a=(e=i[u]).slice((n=e.length)%3).match(/\d{3}/g),e=n%3?[e.slice(0,n%3)]:[],e=a?e.concat(a):e).length){for(a=-1,n=e.length;++a<n;g="")(t=1*e[a])&&(t%100<20&&(g+=r[0][t%100])||t%100+1&&(g+=r[1][(t%100/10>>0)-1]+(t%10?s+r[0][t%10]:"")),m.push((t<100?g:t%100?r[2][t/100>>0]+s+g:r[2][100==t?0:t/100>>0])+(-1<(g=n-a-2)?" "+(1<t&&0<g?r[3][g].replace("ão","ões"):r[3][g]):"")));(a=1<m.length?(a=m.pop(),m.join(" ")+s+a):m.join("")||(!u&&0<1*i[u+1]||d.length?"":r[0][0]))&&d.push(a+(o?" "+(1<1*e.join("")?u?l+"s":(/0{6,}$/.test(i[0])?"de ":"")+"real".replace("l","is"):u?l:"real"):""))}return d.join(s)};var a=function(o){var a=String(o).toUpperCase().replace(/[^A-Z0-9]/g,""),e=a.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/);return!(!e||a.length!=={AD:24,AE:23,AT:20,AZ:28,BA:20,BE:16,BG:22,BH:22,BR:29,CH:21,CR:21,CY:28,CZ:24,DE:22,DK:18,DO:28,EE:20,ES:24,FI:18,FO:18,FR:27,GB:22,GI:23,GL:18,GR:27,GT:28,HR:21,HU:28,IE:22,IL:23,IS:26,IT:27,JO:30,KW:30,KZ:20,LB:28,LI:21,LT:20,LU:20,LV:21,MC:27,MD:24,ME:22,MK:19,MR:27,MT:31,MU:30,NL:18,NO:15,PK:24,PL:28,PS:29,PT:25,QA:29,RO:24,RS:22,SA:24,SE:24,SI:19,SK:24,SM:27,TN:24,TR:26,AO:25}[e[1]])&&function(o){for(var a,e=o.slice(0,2),t=2;t<o.length;t+=7)a=String(e)+o.substring(t,t+7),e=parseInt(a,10)%97;return e}((e[3]+e[1]+e[2]).replace(/[A-Z]/g,function(o){return o.charCodeAt(0)-55}))};this.validarIBAN=function(o){return a("ao06 "+o)},this.scrollTopPage=function(){$("html body").scrollTop(0),$(".topoPINV").show(),$(".esconderPINV").hide(),$(".content.bg-color-2.left-sidebar").addClass("bg_ContentInvestidor"),$(".bgPINV").attr("style","background: #0a3640;")},this.scrollTopPageAt=function(o){$("html body").animate({scrollTop:o},500)},this.mantemModal=function(o,a){a?angular.element(o).modal("show"):angular.element(o).modal("hide")},this.initTooltip=function(){$timeout(function(){$('[data-toggle="tooltip"]').tooltip()},300)},this.getFloatMoney=function(o){var a=0,e=""+o;if(""!=e&&null!=e){var t=e.split(","),i=t[0].split("."),n="";$.each(i,function(o,a){n+=a}),a=n+"."+t[1]}else a=0;return parseFloat(a).toFixed(2)},this.formatKuanza=function(o){var a=o+"";if(1<=parseInt(a.indexOf("."))){var e=a.split("."),t=e[0],i=e[1].substr(0,2);parseInt(i)<10&&(e[1].length<2?i+="0":i=i),a="00"==i?t:t+"."+i}var n=a+"",r=!1;return n-Math.round(o)==0&&(n+="00"),n.indexOf(".")&&(n=n.replace(".","")),0==n.indexOf("-")&&(r=!0,n=n.replace("-","")),1==n.length&&(n="0"+n),6<(n=n.replace(/([0-9]{2})$/g,",$1")).length&&(n=n.replace(/([0-9]{3}),([0-9]{2}$)/g,".$1,$2")),9<n.length&&(n=n.replace(/([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2,$3")),12<n.length&&(n=n.replace(/([0-9]{3}).([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2.$3,$4")),15<n.length&&(n=n.replace(/([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2.$3.$4.$5,$6")),18<n.length&&(n=n.replace(/([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2.$3.$4.$5.$6,$7")),0==n.indexOf(".")&&(n=n.replace(".","")),0==n.indexOf(",")&&(n=n.replace(",","0,")),r?"-"+n:n},this.occurrences=function(o,a,e){if(o+="",(a+="").length<=0)return o.length+1;for(var t=0,i=0,n=e?1:a.length;0<=(i=o.indexOf(a,i));)++t,i+=n;return t},this.formataData=function(o){return""==o?"":o.split("/").reverse().join("-")},this.leapYear=function(o){return o%4==0&&o%100!=0||o%400==0},this.formataDataNormal=function(o){return""==o?"":o.split("-").reverse().join("/")},this.validaPermissao=function(o,a){var e=!1;return a&&0<a.length&&-1!=a.indexOf(o)&&(e=!0),e},this.validaData=function(o){var a=jQuery("#"+o).val();if(""!=a)if(a.length<10)swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)});else{var e=a.split("/");31<e[0]?swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)}):2==e[1]&&28<e[0]?swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)}):12<e[1]&&swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)})}},this.validarPeriodo=function(o,a){var e=$("#"+o),t=$("#"+a),i=!0;if(""!=e.val()&&""!=t.val()){var n=new Date(this.formataData(e.val()));new Date(this.formataData(t.val()))<n&&(i=!1)}else""==e.val()&&""!=t.val()&&(i=!1);return i},this.validaDataReturnBoolean=function(o){var a=jQuery("#"+o).val(),e=!0;if(""!=a)if(a.length<10)e=!1;else{var t=a.split("/");31<t[0]?e=!1:2==t[1]&&28<t[0]?e=!1:12<t[1]&&(e=!1)}return e},this.validateEmail=function(o){var a=jQuery("#"+o).val();if(""!=a){if(/^[a-zA-Z0-9][a-zA-Z0-9\._-]+@([a-zA-Z0-9\._-]+\.)[a-zA-Z-0-9]{2}/.exec(a))return!1;swal({title:"Aviso",text:"E-mail inválido!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok",closeOnConfirm:!0,allowOutsideClick:!1},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},300)})}},this.validEmailReg=function(o){var a=!1;return/^[a-zA-Z0-9][a-zA-Z0-9\._-]+@([a-zA-Z0-9\._-]+\.)[a-zA-Z-0-9]{2}/.exec(o)&&(a=!0),a}}]),app.service("Alertas",["$rootScope",function(o){this.wait=function(o){o=o||"A processar...",swal({html:'<div class="loading"> </div><br/><p>'+o+"</p>",showConfirmButton:!1,allowOutsideClick:!1}).done()},this.closeWait=function(){swal.close()},this.confirm=function(o,a,e,t){o=o||"Confirmar a acção ?",a=a||"Sim",e=e||"Cancelar",swal({text:o,cancelButtonText:e,confirmButtonText:a,type:"warning",showCancelButton:!0,confirmButtonColor:"#5cb85c",allowOutsideClick:!1}).then(function(){t(!0)},function(o){"cancel"===o&&t(!1)}).done()},this.networkError=function(){swal({title:o.const.TITLE_LAMENTAMOS,text:o.const.ERRO_COMPLETAR_OPERACAO,type:"warning",showConfirmButton:!1,showCloseButton:!0,showCancelButton:!0,cancelButtonText:"OK"}).then(function(){callback(!0)},function(o){if("cancel"===o)return!1}).done()},this.statusRetorno=function(o,a){a=a||!1,timer=!a&&2e3,swal({text:o,type:"success",showConfirmButton:!1,showCloseButton:!0,timer:timer,showCancelButton:a,cancelButtonText:"Fechar",allowOutsideClick:!1}).done()},this.statusRetornoErro=function(o){swal({text:o,type:"warning",showConfirmButton:!1,showCloseButton:!0,showCancelButton:!0,cancelButtonText:"OK",allowOutsideClick:!1}).then(function(){return!1},function(o){if("cancel"===o)return!1}).done()},this.statusRetornoErroCallback=function(o,a){swal({text:o,type:"warning",showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"OK",showCancelButton:!0,allowOutsideClick:!1}).then(function(){a(!0)},function(o){"cancel"===o&&a(!1)}).done()},this.aviso=function(o,a,e,t){swal({title:a,text:e,type:o,showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"OK",showCancelButton:!0,allowOutsideClick:!1}).then(function(){t(!0)},function(o){t(!0)}).done()},this.msgError=function(o,a){swal({title:o,text:a,type:"warning",showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"OK",showCancelButton:!0}).done()}}]),angular.module("link.service",[]).factory("LinkService",function(){return{target:function(o){var a=RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi);return o.match(a)}}}),angular.module("upload.service",[]).factory("UploadService",function(){return{preUpload:function(o){var a=new FileReader;return o.target.files&&a.readAsDataURL(o.target.files[0]),a},validarFicheiro:function(){},adicionarAnexos:function(o){o.push({ivNoFicheiro:null,ivNoUsuario:null,ivTokenId:null,ivUrl:null,inCdTpAnexoSigfe:null,excluir:!1})},removerAnexos:function(a,e){a[e].ivUrl||a[e].base64?AlertaService.confirmar("Deseja excluir anexo?",function(o){o&&(a[e].excluir=!0,a[e].base64&&$timeout(function(){a.splice(e,1)},100))}):$timeout(function(){a.splice(e,1)},100)},preUploadMenu:function(a,e,t,o,i){if(angular.isDefined(o)&&o.target.files.length){var n=o.target.files[0];if(n.extensao=n.name.split("."),0<n.size){var r=new FileReader;r.readAsDataURL(n),r.onload=function(){var o={permitir:!0,tamanho:!0};e.indexOf(n.extensao[n.extensao.length-1].toLowerCase())<0&&(r.onloadend=!1,o.permitir=!1,AlertaService.showMensagemRetorno(400,"Tipo do ficheiro inválido")),n.size>1048576*t&&(r.onloadend=!1,o.tamanho=!1,AlertaService.showMensagemRetorno(400,"Tamanho do ficheiro invalido.")),o.permitir&&o.tamanho&&(a.nome=n.name,a.base64Anexo=r.result.substr(r.result.indexOf(",")+1).replace(/ /g,""),a.extensao=n.extensao.slice(-1)[0],a.mimeType=n.type)},r.onloadstart=function(){AlertaService.showProgressAlert()},r.onloadend=function(){AlertaService.closeProgressAlert(),i&&i()},r.onabort=function(){AlertaService.closeProgressAlert(),i&&i()}}}},extensoesPermitidasMap:function(o){return o.map(function(o){return"."+o}).join(",")},upload:function(o,a,e){RequestService.servicoComum("POST","/privado/content/add",o,a,function(o){if(o){var a=o.data.map(function(o){return{ivNoFicheiro:null,ivNoUsuario:"null",ivTokenId:o,ivUrl:null,inCdTpAnexoSigfe:null}});o.parse=a,e(o)}})},getListaAnexos:function(o,a){var e=[];o.map(function(o){e.push(o.ivTokenId)}),RequestService.servicoComum("POST","/privado/content/dados",e,!1,function(o){200==o.retorno.codigo&&(o.data.map(function(o){o.excluir=!1}),a(o.data))})}}}),app.directive("popover",["$compile","$window",function(t,o){return{restrict:"A",link:function(a,e){$(e).popover({html:!0,content:function(){var o=$(e).attr("data-popover-content");return t($(o).children(".popover-body").html())(a)},title:function(){var o=$(e).attr("data-popover-content");return $(o).children(".popover-heading").html()}})}}}]),app.directive("zoomIn",["$compile","$window",function(o,a){return{restrict:"A",link:function(o,a){a.on("mouseenter",function(){a.removeClass("zoomOut").addClass("zoomIn")}),a.on("mouseleave",function(){a.removeClass("zoomIn").addClass("zoomOut")})}}}]),app.directive("validFile",function(){return{require:"ngModel",link:function(o,a,e,t){t.$render=function(){t.$setViewValue(a.val())},a.bind("change",function(){o.$apply(function(){t.$render()})})}}}),app.directive("datePicker",function(){return{restrict:"A",scope:{ngModel:"="},link:function(o,a,e){var t={format:e.dateFormat,language:"pt",autoclose:!0,todayHighlight:!0,clearBtn:!0};a.datepicker(t)}}}),app.directive("dateTimePicker",["$parse","$timeout",function(n,r){return{restrict:"A",require:"ngModel",link:function(a,e,t){var i={locale:"pt",format:t.dateFormat};e.datetimepicker(i),e.next().find("button").bind("click",function(){e.focus()}),e.on("blur",function(o){a.$apply(function(){n(t.ngModel).assign(a,e[0].value)})}),e.on("hide",function(o){}),e.on("click",function(o){e.datetimepicker(i),r(function(){if(t.datamax){var o=moment(moment(t.datamax,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").maxDate(o)}if(t.datamin){var a=moment(moment(t.datamin,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").minDate(a)}},100)}),e.on("dp.change",function(o){if(t.datamin){var a=moment(moment(t.datamin,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").minDate(a)}if(t.datamax){var e=moment(moment(t.datamax,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").maxDate(e)}if(moment(o.date).isValid())try{r(function(){t.minDate&&angular.element(t.minDate).data("DateTimePicker").minDate(o.date),t.maxDate&&angular.element(t.maxDate).data("DateTimePicker").maxDate(o.date)},100)}catch(o){}})}}}]),app.directive("backImg",function(){return function(o,a,e){var t=e.backImg;a.css({"background-image":"url("+t+")"}).addClass("image-background")}}),app.directive("ngUploadChange",function(){return{scope:{ngUploadChange:"&"},link:function(a,o,e){o.on("change",function(o){a.ngUploadChange({$event:o})})}}}),app.directive("iconFile",["$compile","$window",function(o,a){return{restrict:"A",link:function(o,a,e){var t,i=e.ngHref.split(".");switch(i[i.length-1].toLowerCase()){case"doc":case"docx":t="fa-file-word-o";break;case"xls":case"xlsx":t="fa-file-excel-o";break;case"pdf":t="fa-file-pdf-o";break;case"txt":t="fa-file-text-o";break;case"html":t="fa-globe";break;case"jpg":case"jpeg":case"gif":case"png":case"bmp":t="fa-image";break;default:t="fa-download"}a.prepend('<i class="fa '+t+'" aria-hidden="true"></i>&nbsp;')}}}]),app.directive("inputFileMask",["$compile","$window",function(o,a){return{restrict:"A",link:function(o,a,e){a.prepend('<i class="fa fa-download" aria-hidden="true"></i>&nbsp;')}}}]),app.directive("calendario",function(){return{restrict:"EA",replace:!1,templateUrl:"app/partials/calendario.html",scope:{eventos:"=",eventosDoDia:"=",dtInicial:"=",carregarEventos:"=",mesSelecionado:"="},link:function(t,o,a,e){t.mesSelecionado=null,t.onTimeSelected=function(o,a){t.mesSelecionado=null,t.eventosDoDia=[],t.eventos=[],t.dataSelecionada=o,angular.isDefined(a)&&(t.eventosDoDia=a)},t.rangeChanged=function(o,a){t.eventosDoDia=[],t.eventos=[];var e=moment().range(o,a);t.mesSelecionado=moment(o).add(parseInt(e.diff("d")/2),"days"),t.carregarEventos(o,a,function(o){t.parseEventos=[],t.eventos=o,angular.forEach(o,function(o,a){var e={title:o.imposto,startTime:new Date(moment(o.dtFim,"DD-MM-YYYY").format("YYYY-MM-DD")),endTime:new Date(moment(o.dtFim,"DD-MM-YYYY").format("YYYY-MM-DD")),source:o,allDay:!1};t.parseEventos.push(e)})})}}}}),app.directive("cropImg",function(){return{templateUrl:"app/partials/crop-img.html",restrict:"E",scope:{obj:"=",anexoIndice:"<",extensoesPermitidas:"<",tamanhoFicheiro:"<",obrigatorio:"="},controller:["$rootScope","$scope","$timeout","AlertaService","RequestService","Cropper",function(o,l,t,c,a,i){this.$onInit=function(){l.uniqueId=(new Date).getTime()},o.$on("broadcastHomeReceiver",function(o,a){l.editarImagemDestaque=!1}),l.exibirCropper=!1,l.dataUrl=null,l.file=null,l.data=null,l.onFile=function(o){if(angular.isUndefined(o.isTrigger)){var a=o.target.files[0];if(angular.isDefined(a)){a.extensao=a.name.split(".");var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={permitir:!0,tamanho:!0};l.extensoesPermitidas.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,c.showMensagemRetorno(400,"Tipo do ficheiro inválido")),a.size>1048576*l.tamanhoFicheiro&&(e.onloadend=!1,o.tamanho=!1,c.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&l.atualizarFicheiro(a,!0)},e.onloadstart=function(){c.showProgressAlert()},e.onloadend=function(){c.closeProgressAlert()},e.onabort=function(){c.closeProgressAlert()}}}},l.atualizarFicheiro=function(o,a){l.ficheiroSelecionado=o,l.editarImagemDestaque=!0,l.ficheiroLocalorigem=a;var e=new FileReader;e.readAsDataURL(o),e.onload=function(){i.encode(l.file=o).then(function(o){if(l.dataUrl=o,l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].base64Anexo=o.substr(o.indexOf(",")+1).replace(/ /g,""),l.ficheiroLocalorigem)l.ficheiroSelecionado.extensao=l.ficheiroSelecionado.name.split("."),l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].nome="_CAPA_"+l.ficheiroSelecionado.name,l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].extensao=l.ficheiroSelecionado.extensao[l.ficheiroSelecionado.extensao.length-1],l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].mimeType=l.ficheiroSelecionado.type,l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].url=null,l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].ficheiroUrl=null,l.ficheiroSelecionado=null;else{var a=l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].nome.split(".");l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].extensao=a[a.length-1],l.excluirAnexo()}t(function(){l.toogleCropper()},300)})}},l.excluirAnexo=function(){l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].contentUrlARemover=l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].url,l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].url=null},l.atualizarImagemDestaque=function(){var o={portal:a.portalConfig.portalAPI,data:{anexos:[{url:l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].url}]}};a.request("POST","/anexo/bytes",o,!0,function(o){if(o)if(200==o.retorno.codigo){c.closeProgressAlert();var a,e=l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].url.split("/"),t=atob(o.data[0].bytesFicheiro),i=t.length,n=new ArrayBuffer(i),r=new Uint8Array(n);for(a=0;a<i;a++)r[a]=t.charCodeAt(a);var s=new File([r],e[e.length-1],{type:"image/jpg"});l.atualizarFicheiro(s)}else 923!=o.retorno.codigo&&c.showMensagemRetorno(400,"Erro ao aceder ficheiro");else c.erroRede()})},l.cropper={},l.cropperProxy="cropper.first",l.preview=function(){l.file&&l.data&&i.crop(l.file,l.data).then(i.encode).then(function(o){l.dataUrl=o,l.obj.data.anexoPortalList[0].anexoPortalItemList[l.anexoIndice].base64Anexo=o.substr(o.indexOf(",")+1).replace(/ /g,"")}).then(function(){l.toogleCropper()})},l.clear=function(o){l.cropper.first&&l.cropper.first("clear")},l.scale=function(a){i.crop(l.file,l.data).then(function(o){return i.scale(o,{width:a})}).then(i.encode).then(function(o){(l.preview||(l.preview={})).dataUrl=o})},l.options={maximize:!0,aspectRatio:4/3,crop:function(o){l.data=o}},l.showEvent="show",l.hideEvent="hide",l.toggleCropperstatus=!1,l.toogleCropper=function(){l.toggleCropperstatus?l.$broadcast(l.hideEvent):l.$broadcast(l.showEvent),l.toggleCropperstatus=!l.toggleCropperstatus}}]}}),app.directive("form",function(){return{restrict:"E",link:function(o,a){a.on("submit",function(){var o=a[0].querySelector(".ng-invalid");o&&o.focus()})}}}),app.directive("checkHref",["LinkService",function(i){return function(o,a,e){if(e.checkHref){var t=e.checkHref;i.target(t)?a.attr("href",t).attr("target","_blank"):t?(-1==t.indexOf("#!")&&(t="#!"+t),a.attr("href",t)):a.removeAttr("href")}}}]),app.directive("numeros",function(){return{require:"ngModel",link:function(o,a,e,t){t.$parsers.push(function(o){if(o){var a=o.replace(/[^0-9]/g,"");return a!==o&&(t.$setViewValue(a),t.$render()),a}})}}}),app.directive("removeCaracteres",function(){return{require:"ngModel",restrict:"A",link:function(o,a,e,t){t.$parsers.push(function(o){if(null==o)return"";var a=o.replace(/[^\w\s\/\d]/gi,"");return a!=o&&(t.$setViewValue(a),t.$render()),a})}}}),app.directive("mask",function(){return{restrict:"A",link:function(o,a,e){a.mask(e.mask)}}}),app.directive("validaValorMonetario",["Utils","Alertas","$timeout","$rootScope",function(t,i,n,r){return{restrict:"A",link:function(o,a,e){$(a).blur(function(){var o=$(this).val(),a=$(this);""!=o&&(0!=parseFloat(t.getFloatMoney(o))&&0!=parseFloat(t.getFloatMoney(o))||i.aviso("warning",r.const.TITLE_AVISO,r.const.O_VALOR_NAO_PODE_SER_ZERO,function(){n(function(){a.val("")},300)}))})}}}]),app.filter("to_trusted",["$sce",function(a){return function(o){return a.trustAsHtml(o)}}]).filter("startFrom",function(){return function(o,a){try{return a=+a,o.slice(a)}catch(o){}}}).filter("texto",function(){return function(o){var a="--";return o&&(a=o),a}}).filter("htmlToPlaintext",function(){return function(o){return o?String(o).replace(/<[^>]+>/gm,""):""}}).filter("capitalize",function(){return function(o){return o?o.charAt(0).toUpperCase()+o.substr(1).toLowerCase():""}}).filter("valor",["Utils",function(e){return function(o){var a="0,00";return o&&(a=e.formatKuanza(o)),a}}]).filter("valorCambio",["Utils",function(o){return function(o){var a="0,000";if(o){var e=String(o).split(".");a=e[0]+","+e[1].substr(0,3)}return a}}]),angular.module("dynamic-states",[]).provider("dynamicStates",["$stateProvider","$urlRouterProvider",function(e,o){o.deferIntercept();var i=function(o,a){try{e.state(o,a)}catch(o){console.log(o)}},l=function(o,a){var e=!!o.subPaginas,t={abstract:e,url:!!o.url&&o.url,cdMenu:o.cdMenu,dsMenu:o.dsMenu,flAtivo:o.flAtivo,displayName:o.displayName,contentId:o.contentID,flBotaoServico:o.flBotaoServico,siglaServico:o.siglaServico,cache:!1,ncyBreadcrumb:{label:o.displayName},subPaginas:o.subPaginas};e||(t.views={"@":{templateUrl:"app/pages/default-interna.html",controller:"defaultInternaController"}}),i(o.state,t),a&&a()};this.addRoute=i,this.addRoutes=l,this.$get=["$q","$state","$http","$urlRouter","$rootScope",function(o,i,a,e,n){var r=o.defer(),s=function(t){return angular.forEach(t,function(o,a){var e=i.get(o.state);e?(e.ncyBreadcrumb={label:o.displayName},e.cdMenu=o.cdMenu,e.dsMenu=o.dsMenu,e.contentID=o.contentID,e.nuOrdem=o.nuOrdem,e.flAtivo=o.flAtivo,e.subPaginas=o.subPaginas,e.flBotaoServico=o.flBotaoServico,e.siglaServico=o.siglaServico,o.subPaginas&&s(o.subPaginas)):l(o,function(){o.subPaginas&&s(o.subPaginas),a==t.length-1&&r.resolve()})}),r.promise.then(function(){n.$evalAsync(function(){e.sync(),e.listen()})}),t};return{fetchRoutes:s}}]}]);